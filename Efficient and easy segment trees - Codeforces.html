<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<!-- saved from url=(0039)https://codeforces.com/blog/entry/18051 -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <script type="text/javascript" async="" src="./Efficient and easy segment trees - Codeforces_files/analytics.js.download"></script><script type="text/javascript" async="" src="./Efficient and easy segment trees - Codeforces_files/js"></script><script async="" src="./Efficient and easy segment trees - Codeforces_files/js(1)"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-743380-5');
        </script>

    
    <meta name="X-Csrf-Token" content="d8fb8d4ba7a52d3204c987c69587f6fc">
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01">

    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/jquery-1.8.3.js.download"></script>
    <script type="application/javascript">
        window.locale = "en";
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }

        /* Protection against trailing dot in domain. */
        let hostLength = window.location.host.length;
        if (hostLength > 1 && window.location.host[hostLength - 1] === '.') {
            window.location = window.location.protocol + "//" + window.location.host.substring(0, hostLength - 1);
        }
    </script>

    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="h2">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90">
    <meta property="fb:admins" content="100001352546622">
    <meta property="og:image" content="//codeforces.org/s/68729/images/codeforces-sponsored-by-ton.png">
    <link rel="image_src" href="./Efficient and easy segment trees - Codeforces_files/codeforces-sponsored-by-ton.png">
    <meta property="og:title" content="Efficient and easy segment trees - Codeforces">
    <meta property="og:description" content="">
    
    <meta property="og:site_name" content="Codeforces">
    <meta name="uc" content="4bdbad945d2e5c0c3663e42b1bcabd932bddc17b">
    <meta name="usmc" content="2ebfcedceba7fa72aeef1fb0999aef903eed73b4">
    
    
    
    
    <meta name="utc_offset" content="+03:00">
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2">
    <title>Efficient and easy segment trees - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community">
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup">
    <meta name="robots" content="index, follow">

    <link rel="stylesheet" href="./Efficient and easy segment trees - Codeforces_files/font-awesome.min.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Efficient and easy segment trees - Codeforces_files/line-awesome.min.css" type="text/css" charset="utf-8">

        <link href="./Efficient and easy segment trees - Codeforces_files/css" rel="stylesheet" type="text/css">
        <link href="./Efficient and easy segment trees - Codeforces_files/css(1)" rel="stylesheet" type="text/css">


    <link rel="apple-touch-icon" sizes="57x57" href="https://codeforces.org/s/68729/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="https://codeforces.org/s/68729/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="https://codeforces.org/s/68729/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="https://codeforces.org/s/68729/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="https://codeforces.org/s/68729/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="https://codeforces.org/s/68729/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="https://codeforces.org/s/68729/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="https://codeforces.org/s/68729/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://codeforces.org/s/68729/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="https://codeforces.org/s/68729/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://codeforces.org/s/68729/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="https://codeforces.org/s/68729/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://codeforces.org/s/68729/favicon-16x16.png">
    <link rel="manifest" href="https://codeforces.com/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="//codeforces.org/s/68729/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="./Efficient and easy segment trees - Codeforces_files/prettify.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Efficient and easy segment trees - Codeforces_files/clear.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Efficient and easy segment trees - Codeforces_files/style.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Efficient and easy segment trees - Codeforces_files/ttypography.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Efficient and easy segment trees - Codeforces_files/problem-statement.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Efficient and easy segment trees - Codeforces_files/second-level-menu.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Efficient and easy segment trees - Codeforces_files/roundbox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Efficient and easy segment trees - Codeforces_files/datatable.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Efficient and easy segment trees - Codeforces_files/table-form.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Efficient and easy segment trees - Codeforces_files/topic.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Efficient and easy segment trees - Codeforces_files/jquery.jgrowl.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Efficient and easy segment trees - Codeforces_files/facebox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Efficient and easy segment trees - Codeforces_files/jquery.wysiwyg.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Efficient and easy segment trees - Codeforces_files/jquery.autocomplete.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Efficient and easy segment trees - Codeforces_files/codeforces.datepick.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Efficient and easy segment trees - Codeforces_files/colorbox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Efficient and easy segment trees - Codeforces_files/jquery.drafts.css" type="text/css" charset="utf-8">
        <link rel="stylesheet" href="./Efficient and easy segment trees - Codeforces_files/community.css" type="text/css" charset="utf-8">

    <!-- MathJax -->
    <script type="text/x-mathjax-config;executed=true">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    MathJax.Hub.Register.StartupHook("End", function () {
        Codeforces.runMathJaxListeners();
    });
    </script>
    <script type="text/javascript" async="" src="./Efficient and easy segment trees - Codeforces_files/MathJax.js.download">
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/prettify.js.download"></script><style type="text/css" id="operaUserStyle"></style><style id="HighlightThisStyles">.ht2c6359f1-08f1-46e9-8bf9-006e10684e73 {
background-color: #FFFF66 !important;
-webkit-print-color-adjust:exact !important;
font-style: inherit;
}
</style>
    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/moment-with-locales.min.js.download"></script>
    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/pushstream.js.download"></script>
    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/jquery.easing.min.js.download"></script>
    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/jquery.lavalamp.min.js.download"></script>
    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/jquery.jgrowl.js.download"></script>
    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/jquery.swipe.js.download"></script>
    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/jquery.hotkeys.js.download"></script>
    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/facebox.js.download"></script>
    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/jquery.wysiwyg.js.download"></script>
    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/wysiwyg.colorpicker.js.download"></script>
    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/wysiwyg.table.js.download"></script>
    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/wysiwyg.image.js.download"></script>
    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/wysiwyg.link.js.download"></script>
    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/jquery.autocomplete.js.download"></script>
    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/jquery.datepick.js.download"></script>
    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/jquery.ie6blocker.js.download"></script>
    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/jquery.colorbox-min.js.download"></script>
    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/jquery.ba-bbq.js.download"></script>
    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/jquery.drafts.js.download"></script>
    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/clipboard.min.js.download"></script>
    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/autosize.min.js.download"></script>
    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/sjcl.js.download"></script>
    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/codeforces-options.js.download"></script>
    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/codeforces.js.download"></script>
    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/EventCatcher.js.download"></script>
    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/preparedVerdictFormats-en.js.download"></script>
    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/confetti.min.js.download"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="./Efficient and easy segment trees - Codeforces_files/style(1).css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Efficient and easy segment trees - Codeforces_files/style(2).css" type="text/css" charset="utf-8">


    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/jquery.markitup.js.download"></script>
    <script type="text/javascript" src="./Efficient and easy segment trees - Codeforces_files/set.js.download"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->




<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888; display: contents}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover, .MJXp-munder {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > *, .MJXp-munder > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none; box-sizing: content-box}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_test {font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow: hidden; height: 1px}
.MathJax_test.mjx-test-display {display: table!important}
.MathJax_test.mjx-test-inline {display: inline!important; margin-right: -1px}
.MathJax_test.mjx-test-default {display: block!important; clear: both}
.MathJax_ex_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60ex}
.MathJax_em_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60em}
.mjx-test-inline .MathJax_left_box {display: inline-block; width: 0; float: left}
.mjx-test-inline .MathJax_right_box {display: inline-block; width: 0; float: right}
.mjx-test-display .MathJax_right_box {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
<body class=" ">
<link href="./Efficient and easy segment trees - Codeforces_files/css(2)" rel="stylesheet">
<script>
function visionhover() {
alert('szkrrr');
}
</script>
<!-- Popup eleje -->
<div class="visiontranslate-popup" style="cursor: grab; z-index: 2147483647 !important; border-radius: 10px 10px 6.5px 6.5px !important; box-shadow: rgba(0, 0, 0, 0.09) 0px 0px 15.36px !important; width: 230.4px !important; font-family: Heebo, sans-serif !important; position: fixed; top: 284px; left: 285px; animation: 0.4s ease 0s 1 normal none running popup !important; height: auto !important; background-color: white !important; background-image: none !important; border: none !important; display: none !important; box-sizing: content-box !important; transform: none !important; outline: rgb(0, 216, 216) !important;">
	<img id="vt-pin" src="chrome-extension://aemapjnikiphnefgmocicmlmbdhodkea/pin.svg" style="transform: rotate(-45deg) scale(1.1); position: absolute; top: calc(50% - 5.76px); left: -40px; opacity: 1; width: 13.52px !important; height: auto !important; padding: 5.68px !important; border-radius: 38.4px !important; margin: 0.384px !important; cursor: pointer !important; background-color: rgb(115, 245, 115); transition: all 0.2s ease 0s !important; border: none !important; box-sizing: content-box !important; z-index: 999999 !important;">
<div class="img-cont" onmouseenter="document.getElementsByClassName(&#39;visiontranslate-icons&#39;)[0].classList.add(&#39;visi-on&#39;); document.getElementsByClassName(&#39;visiontranslate-credit&#39;)[0].classList.add(&#39;visi-ble&#39;);" onmouseleave="document.getElementsByClassName(&#39;visiontranslate-icons&#39;)[0].classList.remove(&#39;visi-on&#39;); document.getElementsByClassName(&#39;visiontranslate-credit&#39;)[0].classList.remove(&#39;visi-ble&#39;);" style="width: auto !important; height: auto !important; vertical-align: bottom; border-top-left-radius: 6.5px !important; border-top-right-radius: 6.5px !important; overflow: hidden !important;">
<div style="position: absolute; top:0; width: 100%; height: 40px; overflow: hidden;">
<div class="visiontranslate-icons" style="
	float: right !important;
	position: absolute !important;
	top:-64px;
	right: 6.4px !important;
	z-index: 99 !important;
	transition: 0.3s !important;
	width: auto !important;
	height:auto !important;
	background-color: transparent !important;
	background-image: none !important;
	border:none !important;
	display: block !important;
	box-sizing: content-box !important;">
<img id="prev" src="chrome-extension://aemapjnikiphnefgmocicmlmbdhodkea/right-chevron.svg" style="
display: inline !important;
width: 11.52px !important;
height: auto !important;
padding: 7.68px !important;
border-radius: 38.4px !important;
margin:0.384px !important;
cursor: pointer !important;
transform: rotate(180deg);
background-color: rgb(115,245,115) !important;
transition: 0.1s !important;
border:none !important;
box-sizing: content-box !important;
opacity: 0.5;
pointer-events: none;
">
<img id="next" src="chrome-extension://aemapjnikiphnefgmocicmlmbdhodkea/right-chevron.svg" style="
display: inline !important;
width: 11.52px !important;
height: auto !important;
padding: 7.68px !important;
border-radius: 38.4px !important;
margin:0.384px !important;
cursor: pointer !important;
background-color: rgb(115,245,115) !important;
transition: 0.1s !important;
border:none !important;
box-sizing: content-box !important;
">
<img id="close" src="chrome-extension://aemapjnikiphnefgmocicmlmbdhodkea/close.svg" style="
display: inline !important;
width: 11.52px !important;
height: auto !important;
padding: 7.68px !important;
border-radius: 38.4px !important;
margin:0.384px !important;
cursor: pointer;
background-color: rgb(245,115,115) !important;
transition: 0.1s !important;
border:none !important;
box-sizing: content-box !important;">
</div>
</div>
<img id="img" src="./Efficient and easy segment trees - Codeforces_files/Untitled.png" style="
height: 143px;
opacity: 0;
width: 100% !important;
transition: 0.3s !important;
border-top-left-radius: 6.5px !important;
border-top-right-radius: 6.5px !important;
border:none !important;
box-sizing: content-box !important;
">

<p class="visiontranslate-credit" style="
font-size: 12.8px;
position: absolute;
top:50px;
right:6.4px;
z-index: 99;
color:rgb(255,255,255) !important;
font-weight: normal !important;
text-decoration: none !important;
font-family:  &#39;Heebo&#39;, sans-serif !important;
background-color: rgb(30,30,30) !important;
padding-left: 6px !important;
padding-right: 6px !important;
border-radius: 100px !important;
opacity: 0;
margin-top: -28px !important;
transition: 0.3s !important;
text-shadow: none !important;
line-height: normal !important;
">Images are from <a href="https://pixabay.com/" style="color:rgb(0,216,216) !important; padding:0 !important; background-image: none !important;">Pixabay</a>.</p>
</div>
<div class="oneword" style="
width: calc(100% - 7.68px) !important;
height: auto !important;
background-color: transparent !important;
border-radius: 0 !important;
border: none !important;
background-color: transparent !important;
margin:3.84px !important; 
text-align: left !important;">
<h3 style="
margin:0 !important;
color:rgb(30,30,30) !important;
font-weight: normal !important;
margin-top: 11.52px !important;
font-size: 15px !important;
line-height: 0 !important;
box-sizing: content-box !important;
text-shadow: none !important;
border:none !important;
background-color: none !important;
overflow: visible !important;
"><span style="
margin:0 !important;
color:rgb(30,30,30) !important;
font-weight: normal !important;
margin-top: 11.52px !important;
font-size: 15px !important;
line-height: 0 !important;
box-sizing: content-box !important;
font-family:  &#39;Heebo&#39;, sans-serif !important;
text-align: left !important;
text-shadow: none !important;
" id="visiontranslate-source">
</span> -</h3>
<h1 id="visiontranslate-translation" style="
margin:0 !important;
color:rgb(30,30,30) !important;
font-weight: normal !important;
font-size: 27px !important;
text-decoration: none !important;
font-family:  &#39;Heebo&#39;, sans-serif !important;
padding: 0 !important;
background-color: transparent !important;
line-height: 27px !important;
margin-bottom:10px !important;
margin-top: 4px !important;
text-align: left !important;
text-shadow: none !important;
border:none !important;
"> </h1>
<a class="vt-link" href="https://translate.google.com/#view=home&amp;op=translate&amp;sl=auto&amp;tl=vi&amp;text=" target="_blank" style="
font-size: 13.75px !important;
position: relative !important;
top:-10px;
text-decoration: none;
font-family:  &#39;Heebo&#39;, sans-serif !important;
padding: 0 !important;
background-color: transparent !important;
margin: 0 !important;
color: rgb(0,216,216) !important;
font-weight: normal !important;
text-align: left !important;
background-image: none !important;
text-shadow: none !important;
line-height: normal !important;
border:none !important;
">Look for other translations...</a>
<p class="vt-context" style="
font-size: 13.75px !important;
margin:0 !important;
color:rgb(30,30,30) !important;
font-weight: normal !important;
text-decoration: none !important;
font-family:  &#39;Heebo&#39;, sans-serif !important;
padding: 0 !important;
background-color: transparent !important;
text-align: left !important;
margin-top: -7px !important;
text-shadow: none !important;
line-height: normal !important;
border:none !important;
"></p>
</div>
</div>
<!-- Popup vége -->
<style type="text/css">
	#img:hover{
		filter: brightness(70%) !important;
		z-index: 1 !important;
	}
	#next:hover, #close:hover{
		transform: scale(1.1) !important;
		transition: 0.1s !important;
	}
	#prev:hover{
		transform: rotate(180deg) scale(1.1) !important;
		transition: 0.1s !important;
	}
	.visiontranslate-popup:active{
		cursor: grabbing !important;
	}
	.visi-on{
	position: absolute !important;
	top: 6.4px !important;
	}
	@keyframes popup{
		0% {transform: scale(0);}
		80% {transform: scale(1.1);}
		100% {transform: scale(1);}
	}
	.visiontranslate-popup a:hover{
		text-decoration: underline !important;
	}
	.visi-ble{
		opacity: 1 !important;
	}
	#vt-pin:hover{
		transform: rotate(-45deg) scale(1.1) !important;
	}
	.visiontranslate-popup ::selection {
  background: rgb(0,216,216) !important;
}
</style>
<link href="./Efficient and easy segment trees - Codeforces_files/css(2)" rel="stylesheet">
<script>
function visionhover() {
alert('szkrrr');
}
</script>
<!-- Popup eleje -->

<!-- Popup vége -->
<style type="text/css">
	#img:hover{
		filter: brightness(70%) !important;
		z-index: 1 !important;
	}
	#next:hover, #close:hover{
		transform: scale(1.1) !important;
		transition: 0.1s !important;
	}
	#prev:hover{
		transform: rotate(180deg) scale(1.1) !important;
		transition: 0.1s !important;
	}
	.visiontranslate-popup:active{
		cursor: grabbing !important;
	}
	.visi-on{
	position: absolute !important;
	top: 6.4px !important;
	}
	@keyframes popup{
		0% {transform: scale(0);}
		80% {transform: scale(1.1);}
		100% {transform: scale(1);}
	}
	.visiontranslate-popup a:hover{
		text-decoration: underline !important;
	}
	.visi-ble{
		opacity: 1 !important;
	}
	#vt-pin:hover{
		transform: rotate(-45deg) scale(1.1) !important;
	}
	.visiontranslate-popup ::selection {
  background: rgb(0,216,216) !important;
}
</style>
<link href="./Efficient and easy segment trees - Codeforces_files/css(2)" rel="stylesheet">
<script>
function visionhover() {
alert('szkrrr');
}
</script>
<!-- Popup eleje -->

<!-- Popup vége -->
<style type="text/css">
	#img:hover{
		filter: brightness(70%) !important;
		z-index: 1 !important;
	}
	#next:hover, #close:hover{
		transform: scale(1.1) !important;
		transition: 0.1s !important;
	}
	#prev:hover{
		transform: rotate(180deg) scale(1.1) !important;
		transition: 0.1s !important;
	}
	.visiontranslate-popup:active{
		cursor: grabbing !important;
	}
	.visi-on{
	position: absolute !important;
	top: 6.4px !important;
	}
	@keyframes popup{
		0% {transform: scale(0);}
		80% {transform: scale(1.1);}
		100% {transform: scale(1);}
	}
	.visiontranslate-popup a:hover{
		text-decoration: underline !important;
	}
	.visi-ble{
		opacity: 1 !important;
	}
	#vt-pin:hover{
		transform: rotate(-45deg) scale(1.1) !important;
	}
	.visiontranslate-popup ::selection {
  background: rgb(0,216,216) !important;
}
</style>
<link href="./Efficient and easy segment trees - Codeforces_files/css(2)" rel="stylesheet">
<script>
function visionhover() {
alert('szkrrr');
}
</script>
<!-- Popup eleje -->

<!-- Popup vége -->
<style type="text/css">
	#img:hover{
		filter: brightness(70%) !important;
		z-index: 1 !important;
	}
	#next:hover, #close:hover{
		transform: scale(1.1) !important;
		transition: 0.1s !important;
	}
	#prev:hover{
		transform: rotate(180deg) scale(1.1) !important;
		transition: 0.1s !important;
	}
	.visiontranslate-popup:active{
		cursor: grabbing !important;
	}
	.visi-on{
	position: absolute !important;
	top: 6.4px !important;
	}
	@keyframes popup{
		0% {transform: scale(0);}
		80% {transform: scale(1.1);}
		100% {transform: scale(1);}
	}
	.visiontranslate-popup a:hover{
		text-decoration: underline !important;
	}
	.visi-ble{
		opacity: 1 !important;
	}
	#vt-pin:hover{
		transform: rotate(-45deg) scale(1.1) !important;
	}
	.visiontranslate-popup ::selection {
  background: rgb(0,216,216) !important;
}
</style>
<link href="./Efficient and easy segment trees - Codeforces_files/css(2)" rel="stylesheet">
<script>
function visionhover() {
alert('szkrrr');
}
</script>
<!-- Popup eleje -->

<!-- Popup vége -->
<style type="text/css">
	#img:hover{
		filter: brightness(70%) !important;
		z-index: 1 !important;
	}
	#next:hover, #close:hover{
		transform: scale(1.1) !important;
		transition: 0.1s !important;
	}
	#prev:hover{
		transform: rotate(180deg) scale(1.1) !important;
		transition: 0.1s !important;
	}
	.visiontranslate-popup:active{
		cursor: grabbing !important;
	}
	.visi-on{
	position: absolute !important;
	top: 6.4px !important;
	}
	@keyframes popup{
		0% {transform: scale(0);}
		80% {transform: scale(1.1);}
		100% {transform: scale(1);}
	}
	.visiontranslate-popup a:hover{
		text-decoration: underline !important;
	}
	.visi-ble{
		opacity: 1 !important;
	}
	#vt-pin:hover{
		transform: rotate(-45deg) scale(1.1) !important;
	}
	.visiontranslate-popup ::selection {
  background: rgb(0,216,216) !important;
}
</style>
<link href="./Efficient and easy segment trees - Codeforces_files/css(2)" rel="stylesheet">
<script>
function visionhover() {
alert('szkrrr');
}
</script>
<!-- Popup eleje -->

<!-- Popup vége -->
<style type="text/css">
	#img:hover{
		filter: brightness(70%) !important;
		z-index: 1 !important;
	}
	#next:hover, #close:hover{
		transform: scale(1.1) !important;
		transition: 0.1s !important;
	}
	#prev:hover{
		transform: rotate(180deg) scale(1.1) !important;
		transition: 0.1s !important;
	}
	.visiontranslate-popup:active{
		cursor: grabbing !important;
	}
	.visi-on{
	position: absolute !important;
	top: 6.4px !important;
	}
	@keyframes popup{
		0% {transform: scale(0);}
		80% {transform: scale(1.1);}
		100% {transform: scale(1);}
	}
	.visiontranslate-popup a:hover{
		text-decoration: underline !important;
	}
	.visi-ble{
		opacity: 1 !important;
	}
	#vt-pin:hover{
		transform: rotate(-45deg) scale(1.1) !important;
	}
	.visiontranslate-popup ::selection {
  background: rgb(0,216,216) !important;
}
</style>
<link href="./Efficient and easy segment trees - Codeforces_files/css(2)" rel="stylesheet">
<script>
function visionhover() {
alert('szkrrr');
}
</script>
<!-- Popup eleje -->

<!-- Popup vége -->
<style type="text/css">
	#img:hover{
		filter: brightness(70%) !important;
		z-index: 1 !important;
	}
	#next:hover, #close:hover{
		transform: scale(1.1) !important;
		transition: 0.1s !important;
	}
	#prev:hover{
		transform: rotate(180deg) scale(1.1) !important;
		transition: 0.1s !important;
	}
	.visiontranslate-popup:active{
		cursor: grabbing !important;
	}
	.visi-on{
	position: absolute !important;
	top: 6.4px !important;
	}
	@keyframes popup{
		0% {transform: scale(0);}
		80% {transform: scale(1.1);}
		100% {transform: scale(1);}
	}
	.visiontranslate-popup a:hover{
		text-decoration: underline !important;
	}
	.visi-ble{
		opacity: 1 !important;
	}
	#vt-pin:hover{
		transform: rotate(-45deg) scale(1.1) !important;
	}
	.visiontranslate-popup ::selection {
  background: rgb(0,216,216) !important;
}
</style>
<link href="./Efficient and easy segment trees - Codeforces_files/css(2)" rel="stylesheet">
<script>
function visionhover() {
alert('szkrrr');
}
</script>
<!-- Popup eleje -->

<!-- Popup vége -->
<style type="text/css">
	#img:hover{
		filter: brightness(70%) !important;
		z-index: 1 !important;
	}
	#next:hover, #close:hover{
		transform: scale(1.1) !important;
		transition: 0.1s !important;
	}
	#prev:hover{
		transform: rotate(180deg) scale(1.1) !important;
		transition: 0.1s !important;
	}
	.visiontranslate-popup:active{
		cursor: grabbing !important;
	}
	.visi-on{
	position: absolute !important;
	top: 6.4px !important;
	}
	@keyframes popup{
		0% {transform: scale(0);}
		80% {transform: scale(1.1);}
		100% {transform: scale(1);}
	}
	.visiontranslate-popup a:hover{
		text-decoration: underline !important;
	}
	.visi-ble{
		opacity: 1 !important;
	}
	#vt-pin:hover{
		transform: rotate(-45deg) scale(1.1) !important;
	}
	.visiontranslate-popup ::selection {
  background: rgb(0,216,216) !important;
}
</style>
<link href="./Efficient and easy segment trees - Codeforces_files/css(2)" rel="stylesheet">
<script>
function visionhover() {
alert('szkrrr');
}
</script>
<!-- Popup eleje -->

<!-- Popup vége -->
<style type="text/css">
	#img:hover{
		filter: brightness(70%) !important;
		z-index: 1 !important;
	}
	#next:hover, #close:hover{
		transform: scale(1.1) !important;
		transition: 0.1s !important;
	}
	#prev:hover{
		transform: rotate(180deg) scale(1.1) !important;
		transition: 0.1s !important;
	}
	.visiontranslate-popup:active{
		cursor: grabbing !important;
	}
	.visi-on{
	position: absolute !important;
	top: 6.4px !important;
	}
	@keyframes popup{
		0% {transform: scale(0);}
		80% {transform: scale(1.1);}
		100% {transform: scale(1);}
	}
	.visiontranslate-popup a:hover{
		text-decoration: underline !important;
	}
	.visi-ble{
		opacity: 1 !important;
	}
	#vt-pin:hover{
		transform: rotate(-45deg) scale(1.1) !important;
	}
	.visiontranslate-popup ::selection {
  background: rgb(0,216,216) !important;
}
</style>
<link href="./Efficient and easy segment trees - Codeforces_files/css(2)" rel="stylesheet">
<script>
function visionhover() {
alert('szkrrr');
}
</script>
<!-- Popup eleje -->

<!-- Popup vége -->
<style type="text/css">
	#img:hover{
		filter: brightness(70%) !important;
		z-index: 1 !important;
	}
	#next:hover, #close:hover{
		transform: scale(1.1) !important;
		transition: 0.1s !important;
	}
	#prev:hover{
		transform: rotate(180deg) scale(1.1) !important;
		transition: 0.1s !important;
	}
	.visiontranslate-popup:active{
		cursor: grabbing !important;
	}
	.visi-on{
	position: absolute !important;
	top: 6.4px !important;
	}
	@keyframes popup{
		0% {transform: scale(0);}
		80% {transform: scale(1.1);}
		100% {transform: scale(1);}
	}
	.visiontranslate-popup a:hover{
		text-decoration: underline !important;
	}
	.visi-ble{
		opacity: 1 !important;
	}
	#vt-pin:hover{
		transform: rotate(-45deg) scale(1.1) !important;
	}
	.visiontranslate-popup ::selection {
  background: rgb(0,216,216) !important;
}
</style>
<link href="./Efficient and easy segment trees - Codeforces_files/css(2)" rel="stylesheet">
<script>
function visionhover() {
alert('szkrrr');
}
</script>
<!-- Popup eleje -->

<!-- Popup vége -->
<style type="text/css">
	#img:hover{
		filter: brightness(70%) !important;
		z-index: 1 !important;
	}
	#next:hover, #close:hover{
		transform: scale(1.1) !important;
		transition: 0.1s !important;
	}
	#prev:hover{
		transform: rotate(180deg) scale(1.1) !important;
		transition: 0.1s !important;
	}
	.visiontranslate-popup:active{
		cursor: grabbing !important;
	}
	.visi-on{
	position: absolute !important;
	top: 6.4px !important;
	}
	@keyframes popup{
		0% {transform: scale(0);}
		80% {transform: scale(1.1);}
		100% {transform: scale(1);}
	}
	.visiontranslate-popup a:hover{
		text-decoration: underline !important;
	}
	.visi-ble{
		opacity: 1 !important;
	}
	#vt-pin:hover{
		transform: rotate(-45deg) scale(1.1) !important;
	}
	.visiontranslate-popup ::selection {
  background: rgb(0,216,216) !important;
}
</style>
<link href="./Efficient and easy segment trees - Codeforces_files/css(2)" rel="stylesheet">
<script>
function visionhover() {
alert('szkrrr');
}
</script>
<!-- Popup eleje -->

<!-- Popup vége -->
<style type="text/css">
	#img:hover{
		filter: brightness(70%) !important;
		z-index: 1 !important;
	}
	#next:hover, #close:hover{
		transform: scale(1.1) !important;
		transition: 0.1s !important;
	}
	#prev:hover{
		transform: rotate(180deg) scale(1.1) !important;
		transition: 0.1s !important;
	}
	.visiontranslate-popup:active{
		cursor: grabbing !important;
	}
	.visi-on{
	position: absolute !important;
	top: 6.4px !important;
	}
	@keyframes popup{
		0% {transform: scale(0);}
		80% {transform: scale(1.1);}
		100% {transform: scale(1);}
	}
	.visiontranslate-popup a:hover{
		text-decoration: underline !important;
	}
	.visi-ble{
		opacity: 1 !important;
	}
	#vt-pin:hover{
		transform: rotate(-45deg) scale(1.1) !important;
	}
	.visiontranslate-popup ::selection {
  background: rgb(0,216,216) !important;
}
</style>
<link href="./Efficient and easy segment trees - Codeforces_files/css(2)" rel="stylesheet">
<script>
function visionhover() {
alert('szkrrr');
}
</script>
<!-- Popup eleje -->

<!-- Popup vége -->
<style type="text/css">
	#img:hover{
		filter: brightness(70%) !important;
		z-index: 1 !important;
	}
	#next:hover, #close:hover{
		transform: scale(1.1) !important;
		transition: 0.1s !important;
	}
	#prev:hover{
		transform: rotate(180deg) scale(1.1) !important;
		transition: 0.1s !important;
	}
	.visiontranslate-popup:active{
		cursor: grabbing !important;
	}
	.visi-on{
	position: absolute !important;
	top: 6.4px !important;
	}
	@keyframes popup{
		0% {transform: scale(0);}
		80% {transform: scale(1.1);}
		100% {transform: scale(1);}
	}
	.visiontranslate-popup a:hover{
		text-decoration: underline !important;
	}
	.visi-ble{
		opacity: 1 !important;
	}
	#vt-pin:hover{
		transform: rotate(-45deg) scale(1.1) !important;
	}
	.visiontranslate-popup ::selection {
  background: rgb(0,216,216) !important;
}
</style>
<link href="./Efficient and easy segment trees - Codeforces_files/css(2)" rel="stylesheet">
<script>
function visionhover() {
alert('szkrrr');
}
</script>
<!-- Popup eleje -->

<!-- Popup vége -->
<style type="text/css">
	#img:hover{
		filter: brightness(70%) !important;
		z-index: 1 !important;
	}
	#next:hover, #close:hover{
		transform: scale(1.1) !important;
		transition: 0.1s !important;
	}
	#prev:hover{
		transform: rotate(180deg) scale(1.1) !important;
		transition: 0.1s !important;
	}
	.visiontranslate-popup:active{
		cursor: grabbing !important;
	}
	.visi-on{
	position: absolute !important;
	top: 6.4px !important;
	}
	@keyframes popup{
		0% {transform: scale(0);}
		80% {transform: scale(1.1);}
		100% {transform: scale(1);}
	}
	.visiontranslate-popup a:hover{
		text-decoration: underline !important;
	}
	.visi-ble{
		opacity: 1 !important;
	}
	#vt-pin:hover{
		transform: rotate(-45deg) scale(1.1) !important;
	}
	.visiontranslate-popup ::selection {
  background: rgb(0,216,216) !important;
}
</style>
<link href="./Efficient and easy segment trees - Codeforces_files/css(2)" rel="stylesheet">
<script>
function visionhover() {
alert('szkrrr');
}
</script>
<!-- Popup eleje -->

<!-- Popup vége -->
<style type="text/css">
	#img:hover{
		filter: brightness(70%) !important;
		z-index: 1 !important;
	}
	#next:hover, #close:hover{
		transform: scale(1.1) !important;
		transition: 0.1s !important;
	}
	#prev:hover{
		transform: rotate(180deg) scale(1.1) !important;
		transition: 0.1s !important;
	}
	.visiontranslate-popup:active{
		cursor: grabbing !important;
	}
	.visi-on{
	position: absolute !important;
	top: 6.4px !important;
	}
	@keyframes popup{
		0% {transform: scale(0);}
		80% {transform: scale(1.1);}
		100% {transform: scale(1);}
	}
	.visiontranslate-popup a:hover{
		text-decoration: underline !important;
	}
	.visi-ble{
		opacity: 1 !important;
	}
	#vt-pin:hover{
		transform: rotate(-45deg) scale(1.1) !important;
	}
	.visiontranslate-popup ::selection {
  background: rgb(0,216,216) !important;
}
</style>
<link href="./Efficient and easy segment trees - Codeforces_files/css(2)" rel="stylesheet">
<script>
function visionhover() {
alert('szkrrr');
}
</script>
<!-- Popup eleje -->

<!-- Popup vége -->
<style type="text/css">
	#img:hover{
		filter: brightness(70%) !important;
		z-index: 1 !important;
	}
	#next:hover, #close:hover{
		transform: scale(1.1) !important;
		transition: 0.1s !important;
	}
	#prev:hover{
		transform: rotate(180deg) scale(1.1) !important;
		transition: 0.1s !important;
	}
	.visiontranslate-popup:active{
		cursor: grabbing !important;
	}
	.visi-on{
	position: absolute !important;
	top: 6.4px !important;
	}
	@keyframes popup{
		0% {transform: scale(0);}
		80% {transform: scale(1.1);}
		100% {transform: scale(1);}
	}
	.visiontranslate-popup a:hover{
		text-decoration: underline !important;
	}
	.visi-ble{
		opacity: 1 !important;
	}
	#vt-pin:hover{
		transform: rotate(-45deg) scale(1.1) !important;
	}
	.visiontranslate-popup ::selection {
  background: rgb(0,216,216) !important;
}
</style><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div><style>::selection {background-color:rgb(0,216,216) !important; color:white !important;}</style><span style="display:none;" class="csrf-token" data-csrf="d8fb8d4ba7a52d3204c987c69587f6fc">&nbsp;</span>

<!-- .notificationTextCleaner used in Codeforces.showAnnouncements() -->
<div class="notificationTextCleaner" style="font-size: 0"></div>
<div class="button-up" style="opacity: 0.7; width: 30px; height: 100%; position: fixed; left: 0px; top: 0px; cursor: pointer; text-align: center; line-height: 30px; color: rgb(211, 219, 228); font-weight: bold; font-size: 20px; display: block; background: none;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    String.prototype.hashCode = function() {
        var hash = 0, i, chr;
        if (this.length === 0) return hash;
        for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };

    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile === "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>





    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 700
        });
    }, 100);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();

        var count = 0;

        function getDelay() {
            var delay = 0;
            var last = Codeforces.getFromStorage("LastOnlineTimeUpdaterMillis", 0);
            if (last && last != null) {
                var period = count < 20 ? 360 * 1000 : 600 * 1000;
                delay = period - (new Date().getTime() - last);
                if (delay < 0)
                    delay = 0;
            }
            return delay;
        }

        window.setInterval(function () {
            if (getDelay() <= 0 && count < 120) {
                ++count;
                Codeforces.ping("/data/update-online");
            }
        }, 5000);

        var handle = "epiccodingmomento";
        $("a.rated-user:contains(" + handle + "), span.participant:contains(" + handle + ")").each(function () {
            if ($(this).text() == handle) {
                var td = $(this).parent();
                var tr = $(this).parent().parent();
                if (td.is("td") && tr.is("tr") && !tr.hasClass("disable-highlight-self")) {
                    info(handle);
                    tr.addClass("highlighted-row");
                }
            }
        });

    function showAnnouncements(json) {
        //info("j=" + JSON.stringify(json));

        if (json.t != "a") {
            return;
        }

        setTimeout(function() {
            Codeforces.showAnnouncements(json.d, "en");
        }, Math.random() * 500);
    }

    function showEventCatcherUserMessage(json) {
        if (json.t == "s") {
            var points = json.d[5];
            var passedTestCount = json.d[7];
            var judgedTestCount = json.d[8];
            var verdict = preparedVerdictFormats[json.d[12]];
            var verdictPrototypeDiv = $(".verdictPrototypeDiv");
            verdictPrototypeDiv.html(verdict);
            if (judgedTestCount != null && judgedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-judged").text(judgedTestCount);
            }
            if (passedTestCount != null && passedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-passed").text(passedTestCount);
            }
            if (points != null && points != undefined) {
                verdictPrototypeDiv.find(".verdict-format-points").text(points);
            }
            Codeforces.showMessage(verdictPrototypeDiv.text());
        }
    }

    $(".clickable-title").each(function() {
        var title = $(this).attr("data-title");
        if (title) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = title;
            $(this).attr("title", tmp.textContent || tmp.innerText || "");
        }
    });

    $(".clickable-title").click(function() {
        var title = $(this).attr("data-title");
        if (title) {
            Codeforces.alert(title);
        } else {
            Codeforces.alert($(this).attr("title"));
        }
    }).css("position", "relative").css("bottom", "3px");

        Codeforces.showDelayedMessage();

    Codeforces.reformatTimes();

    //Codeforces.initializePubSub();
    if (window.codeforcesOptions.subscribeServerUrl) {
        window.eventCatcher = new EventCatcher(
            window.codeforcesOptions.subscribeServerUrl,
            [
                Codeforces.getGlobalChannel(),
                Codeforces.getUserChannel(),
                Codeforces.getUserShowMessageChannel(),
                Codeforces.getContestChannel(),
                Codeforces.getParticipantChannel(),
                Codeforces.getTalkChannel()
            ]
        );

        if (Codeforces.getParticipantChannel()) {
            window.eventCatcher.subscribe(Codeforces.getParticipantChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getContestChannel()) {
            window.eventCatcher.subscribe(Codeforces.getContestChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getGlobalChannel()) {
            window.eventCatcher.subscribe(Codeforces.getGlobalChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserShowMessageChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserShowMessageChannel(), function(json) {
                showEventCatcherUserMessage(json);
            });
        }
    }

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>


<div id="body">
            <script type="application/javascript">
                window.setTimeout(function () {
                    var url = location.href;
                    var hashCode32 = Math.abs(url.hashCode()).toString();
                    var hashCode = "p" + hashCode32 + Math.abs((hashCode32 + url).hashCode());
                    var pvs = Codeforces.getFromStorage("pvs" + hashCode);
                    if (!pvs) {
                        $.post("/data/apv", {
                            ftaa: window._ftaa,
                            bfaa: window._bfaa,
                            url: url
                        }, function (json) {
                            if (json["success"] === "true") {
                                Codeforces.putToStorage("pvs" + hashCode, true);
                            }
                        }, "json");
                    }
                }, 5000);
            </script>
        

<div class="side-bell" style="visibility: hidden; opacity: 0.7; width: 30px; position: fixed; right: 0px; top: 0px; cursor: pointer; text-align: center; line-height: 30px; color: rgb(211, 219, 228); font-weight: bold; font-size: 10px; display: block;">
    <span class="icon-stack" style="width: 100%;">
        <i class="icon-circle icon-stack-base"></i>
        <i class="icon-bell-alt icon-light"></i>
    </span>
    <br>
    <span class="side-bell__count" style="position: relative; top: -10px;"></span>
</div>




<style>
    .header-bell {
        display: inline-block;
        position: relative;
        cursor: pointer;
    }

    .header-bell__img {
        opacity: 0.5;
        background-image: url("//codeforces.org/s/68729/images/icons/bell_inactive-20x20.png");
        position: relative;
        bottom: 1px;
        width: 20px;
        height: 20px;
    }

    .header-bell__img-active  {
        opacity: 1 !important;
        background-image: url("//codeforces.org/s/68729/images/icons/bell_active-20x20.png") !important;
    }

    .header-bell__count {
        position: absolute;
        top: 8px;
        left: 18px;
        font-weight: bold;
        font-size: 10px;
    }

    .bell-details {
        display: none;
        z-index: 5;
        border: 1px solid rgb(185, 185, 185);
        width: 40rem;
        max-height: 60rem;
        padding: 0;
        position: absolute;
        top: 20px;
        right: 0;
        background-color: white;
        overflow: scroll;
        overflow-x: hidden;
        overflow-y: auto;
    }
    .bell-details.sidebar-bell {
        position: fixed;
        right: 50px;
    }

    .bell-details__no-new {
        font-size: 1.3rem;
        display: block;
        text-align: center;
        color: #888 !important;
        padding: 1em;
    }

    .bell-details__recent-link {
        margin: 0;
        padding: 0.5em;
        text-align: center;
        border-top: 1px solid rgb(185, 185, 185);
    }

    .bell-details__recent-link a {
        font-size: 1.2rem;
    }

    .bell-details__proto-row-comment {
        display: none;
    }

    .bell-details__proto-row-blog-entry {
        display: none;
    }

    .bell-details__proto-row-comment-reply {
        display: none;
    }

    .bell-details__row {
        text-align: left;
        margin: 0.5em;
        padding: 0.25em 0.25em 0.75em 0.25em;
        clear: both;
    }

    .bell-details__row:hover {
        cursor: pointer;
        background-color: #def;
    }

    .bell-details__row-active {
        background-color: #def;
    }

    .bell-details__thumbnail-a {
        text-decoration: none;
    }

    .bell-details__row img {
        zoom: 50%;
        margin-right: 2em;
        float: left;
    }

    .bell-details__comment {
        padding-left: 45px;
        font-size: 1.3rem;
    }

    .bell-details__blog-entry {
        padding-left: 45px;
        font-size: 1.3rem;
    }

    .bell-details__comment-reply {
        padding-left: 45px;
        font-size: 1.3rem;
    }

    .bell-details__time {
        padding-left: 45px;
        margin-top: 0.2em;
        font-size: 1.1rem;
        color: #888 !important;
    }
</style>

<script>
    $(function () {
        if ($(window).width() < 1600) {
            $('.side-bell').css('width', '30px').css('line-height', '30px').css('font-size', '10px');
        }

        if ($(window).width() >= 1200) {
            $ (window).scroll (function () {
                if ($ (this).scrollTop () > 100) {
                    $(".bell-details").addClass("sidebar-bell");
                    $ ('.side-bell').fadeIn();
                } else {
                    $(".bell-details").removeClass("sidebar-bell");
                    $ ('.side-bell').fadeOut();
                }
            });

            $('.side-bell').hover(function () {
                $(this).animate({
                    'opacity':'1'
                }).css({'color':'#6a86a4'});
            }, function () {
                $(this).animate({
                    'opacity':'0.7'
                }).css({'color':'#d3dbe4'});
            });
        }

        $(".lang-chooser>div:first-child").prepend($("<span style='position: relative; bottom: 8px; padding: 0 0.5em;'>|</span>")).prepend($(".header-bell").show());
        function Bell() {
            var bell = this;
            var notifications = JSON.parse("[]");

            bell.notifications = {};

            for (var i in notifications) {
                if (notifications.hasOwnProperty(i)) {
                    bell.notifications[notifications[i].id] = notifications[i];
                }
            }

            function onClick(notification) {
                var notificationIds = [];
                var reason = notification.data.reasonType + "#" + notification.reasonId;
                for (id in bell.notifications) {
                    if (bell.notifications.hasOwnProperty(id)) {
                        var otherNotification = bell.notifications[id];
                        var otherReason = otherNotification.data.reasonType + "#" + otherNotification.reasonId;
                        if (otherReason == reason) {
                            notificationIds.push(otherNotification.id);
                        }
                    }
                }
                $.post("/data/notification", {action: "markAsRead", notificationIds: notificationIds.join(",")}, function(result) {
                    Codeforces.redirect(notification.data.url);
                }, "json");
            }

            var $bellDetails = $(".bell-details");
            bell.newCommentRow = function (notification) {
                var row = $(".bell-details__proto-row-comment").clone();
                row.addClass("bell-details__row").attr("data-notificationId", notification.id);
                row.find(".bell-details__thumbnail-a").attr("href", notification.data.reasonUserUrl);
                row.find("img").attr("src", notification.data.reasonUserThumbnailUrl);
                row.find(".bell-details__comment").html(
                        "ReasonUser mentioned you in a comment".replace("ReasonUser", notification.data.reasonUserHtml)
                );
                row.find(".bell-details__time").html(
                        "<span class='format-systemtimewithseconds'>"
                        + notification.creationTimeString
                        + "</span>"
                );
                row.removeClass("bell-details__proto-row-comment");
                row.click(function() {
                    onClick(notification);
                    return false;
                });
                return row;
            };
            bell.newFriendCommentRow = function (notification) {
                var row = $(".bell-details__proto-row-comment").clone();
                row.addClass("bell-details__row").attr("data-notificationId", notification.id);
                row.find(".bell-details__thumbnail-a").attr("href", notification.data.reasonUserUrl);
                row.find("img").attr("src", notification.data.reasonUserThumbnailUrl);
                row.find(".bell-details__comment").html(
                        "ReasonUser wrote a comment".replace("ReasonUser", notification.data.reasonUserHtml)
                );
                row.find(".bell-details__time").html(
                        "<span class='format-systemtimewithseconds'>"
                        + notification.creationTimeString
                        + "</span>"
                );
                row.removeClass("bell-details__proto-row-comment");
                row.click(function() {
                    onClick(notification);
                    return false;
                });
                return row;
            };
            bell.newCommentReplyRow = function (notification) {
                var row = $(".bell-details__proto-row-comment-reply").clone();
                row.addClass("bell-details__row").attr("data-notificationId", notification.id);
                row.find(".bell-details__thumbnail-a").attr("href", notification.data.reasonUserUrl);
                row.find("img").attr("src", notification.data.reasonUserThumbnailUrl);
                row.find(".bell-details__comment-reply").html(
                        "ReasonUser replied to your comment".replace("ReasonUser", notification.data.reasonUserHtml)
                );
                row.find(".bell-details__time").html(
                        "<span class='format-systemtimewithseconds'>"
                        + notification.creationTimeString
                        + "</span>"
                );
                row.removeClass("bell-details__proto-row-comment-reply");
                row.click(function() {
                    onClick(notification);
                    return false;
                });
                return row;
            };
            bell.newBlogEntryRow = function (notification) {
                var row = $(".bell-details__proto-row-blog-entry").clone();
                row.addClass("bell-details__row").attr("data-notificationId", notification.id);
                row.find(".bell-details__thumbnail-a").attr("href", notification.data.reasonUserUrl);
                row.find("img").attr("src", notification.data.reasonUserThumbnailUrl);
                row.find(".bell-details__blog-entry").html(
                        "ReasonUser mentioned you in a blog entry".replace("ReasonUser", notification.data.reasonUserHtml)
                );
                row.find(".bell-details__time").html(
                        "<span class='format-systemtimewithseconds'>"
                        + notification.creationTimeString
                        + "</span>"
                );
                row.removeClass("bell-details__proto-row-blog-entry");
                row.click(function() {
                    onClick(notification);
                    return false;
                });
                return row;
            };
            bell.newFriendBlogEntryRow = function (notification) {
                var row = $(".bell-details__proto-row-blog-entry").clone();
                row.addClass("bell-details__row").attr("data-notificationId", notification.id);
                row.find(".bell-details__thumbnail-a").attr("href", notification.data.reasonUserUrl);
                row.find("img").attr("src", notification.data.reasonUserThumbnailUrl);
                row.find(".bell-details__blog-entry").html(
                        "ReasonUser wrote a blog entry".replace("ReasonUser", notification.data.reasonUserHtml)
                );
                row.find(".bell-details__time").html(
                        "<span class='format-systemtimewithseconds'>"
                        + notification.creationTimeString
                        + "</span>"
                );
                row.removeClass("bell-details__proto-row-blog-entry");
                row.click(function() {
                    onClick(notification);
                    return false;
                });
                return row;
            };
            bell.newProposalCommentRow = function (notification) {
                var row = $(".bell-details__proto-row-comment-reply").clone();
                row.addClass("bell-details__row").attr("data-notificationId", notification.id);
                row.find(".bell-details__thumbnail-a").attr("href", notification.data.reasonUserUrl);
                row.find("img").attr("src", notification.data.reasonUserThumbnailUrl);
                row.find(".bell-details__comment-reply").html(
                        "ReasonUser commented on ProposalType Proposal".replace("ReasonUser", notification.data.reasonUserHtml)
                                .replace("ProposalType", "Contest" == notification.data.proposalType ? "contest proposal" : "problem proposal")
                                .replace("Proposal", $("<div/>").text(notification.data.proposalName).html())
                );
                row.find(".bell-details__time").html(
                        "<span class='format-systemtimewithseconds'>"
                        + notification.creationTimeString
                        + "</span>"
                );
                row.removeClass("bell-details__proto-row-comment-reply");
                row.click(function() {
                    onClick(notification);
                    return false;
                });
                return row;
            };

            bell.renderRow = function (notification) {
                var $row = $(".bell-details__row[data-notificationId='" + notification.id + "']");

                if ($bellDetails.css("display") != "block" && notification.read) {
                    $row.hide();
                    return;
                }

                notification.data = JSON.parse(notification.dataJson);

                var reason = notification.data.reasonType + "#" + notification.reasonId;

                var has = false;
                $row.each(function () {
                    has = true;
                });
                if ($(".bell-details__row[data-reason='" + reason + "']").length) {
                    has = true;
                }

                if (!has) {
                    $(".side-bell").css("visibility", "visible");
                    var newRow;
                    if (notification.type == "Comment") {
                        newRow = bell.newCommentRow(notification);
                    } else if (notification.type == "BlogEntry") {
                        newRow = bell.newBlogEntryRow(notification);
                    } else if (notification.type == "CommentReply") {
                        newRow = bell.newCommentReplyRow(notification);
                    } else if (notification.type == "FriendComment") {
                        newRow = bell.newFriendCommentRow(notification);
                    } else if (notification.type == "FriendBlogEntry") {
                        newRow = bell.newFriendBlogEntryRow(notification);
                    } else if (notification.type == "ProposalComment") {
                        newRow = bell.newProposalCommentRow(notification)
                    }
                    if (newRow) {
                        newRow.attr("data-reason", reason);
                        $(".bell-details").prepend(newRow);
                    }
                }
            };

            var $count = $(".header-bell__count, .side-bell__count");
            var $img = $(".header-bell__img");
            var $noNew = $(".bell-details__no-new");

            bell.renewCount = function () {
                Codeforces.reformatTimes();
                var count = 0;
                var counted = {};
                for (var id in bell.notifications)
                    if (bell.notifications.hasOwnProperty(id)) {
                        var notification = bell.notifications[id];
                        if (notification) {
                            var reason = notification.data.reasonType + "#" + notification.reasonId;
                            if (!notification.read && !counted[reason]) {
                                count++;
                                counted[reason] = true;
                            }
                        }
                    }
                if (count > 0) {
                    $count.text(count);
                    $img.addClass("header-bell__img-active");
                    $noNew.hide();
                } else {
                    $count.text("");
                    $img.removeClass("header-bell__img-active");
                    if ($bellDetails.css("display") != "block") {
                        $noNew.show();
                    }
                }
            };

            for (var id in bell.notifications)
                if (bell.notifications.hasOwnProperty(id))
                    bell.renderRow(bell.notifications[id]);

            if (window.eventCatcher) {
                window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                    if (json.t === "n") {
                        for (var i in json.d)
                            if (json.d.hasOwnProperty(i)) {
                                var notification = json.d[i];
                                notification.data = JSON.parse(notification.dataJson);
                                bell.notifications[notification.id] = notification;
                                bell.renderRow(notification);
                                bell.renewCount();
                            }
                    }
                });
            }


            $(".header-bell, .side-bell").click(function() {
                if ($bellDetails.css("display") == "none") {
                    for (var id in bell.notifications)
                        if (bell.notifications.hasOwnProperty(id))
                            if (bell.notifications[id].read)
                                bell.renderRow(bell.notifications[id]);
                    bell.renewCount();

                    $bellDetails.css("display", "block");

                    var notificationIds = [];
                    for (id in bell.notifications)
                        if (bell.notifications.hasOwnProperty(id))
                            notificationIds.push(id);

                    setTimeout(function() {
                        if ($bellDetails.css("display") == "block") {
                            $.post("/data/notification", {action: "markAsRead", notificationIds: notificationIds.join(",")}, function(result) {
                                // No operations.
                            }, "json");

                            for (var i in notificationIds) {
                                if (notificationIds.hasOwnProperty(i)) {
                                    bell.notifications[notificationIds[i]].read = true;
                                }
                            }
                            bell.renewCount();
                        }
                    }, 2000);
                } else {
                    var has = false;
                    for (var id in bell.notifications) {
                        if (bell.notifications.hasOwnProperty(id) && !bell.notifications[id].read) {
                            has = true;
                        }
                    }
                    if (!has) {
                        $(".side-bell").css("visibility", "hidden");
                    }
                    $bellDetails.css("display", "none");
                    bell.renewCount();
                }
            });
        }

        bell = new Bell();
        bell.renewCount();
    })
</script>

<div id="header" style="position: relative;">
    <div style="float:left; max-height: 60px;">
                    <a href="https://codeforces.com/"><img height="65" style="height: 65px;" alt="Codeforces" title="Codeforces" src="./Efficient and easy segment trees - Codeforces_files/codeforces-sponsored-by-ton.png"></a>
    </div>
    <div class="lang-chooser">
        <div style="text-align: right;"><div class="header-bell" style="">
    <div class="header-bell__img"><span class="header-bell__count"></span></div>

    <div class="bell-details sidebar-bell">
        <div class="bell-details__proto-row-comment">
            <a class="bell-details__thumbnail-a" href="https://codeforces.com/blog/entry/18051#"><img src="https://codeforces.com/blog/entry/18051"></a>
            <div class="bell-details__comment"></div>
            <div class="bell-details__time"></div>
        </div>
        <div class="bell-details__proto-row-blog-entry">
            <a class="bell-details__thumbnail-a" href="https://codeforces.com/blog/entry/18051#"><img src="https://codeforces.com/blog/entry/18051"></a>
            <div class="bell-details__blog-entry"></div>
            <div class="bell-details__time"></div>
        </div>
        <div class="bell-details__proto-row-comment-reply">
            <a class="bell-details__thumbnail-a" href="https://codeforces.com/blog/entry/18051#"><img src="https://codeforces.com/blog/entry/18051"></a>
            <div class="bell-details__comment-reply"></div>
        </div>

        <div class="bell-details__no-new">
            There are no new notifications
        </div>

        <div class="bell-details__recent-link">
            <a href="https://codeforces.com/notifications">History (at most 100 notifications)</a>
        </div>
    </div>
</div><span style="position: relative; bottom: 8px; padding: 0 0.5em;">|</span>
            <a href="https://codeforces.com/blog/entry/18051?locale=en"><img src="./Efficient and easy segment trees - Codeforces_files/gb.png" title="In English" alt="In English"></a>
            <a href="https://codeforces.com/blog/entry/18051?locale=ru"><img src="./Efficient and easy segment trees - Codeforces_files/ru.png" title="По-русски" alt="По-русски"></a>
        </div>

        <div>
                        <a href="https://codeforces.com/profile/epiccodingmomento">epiccodingmomento</a>
                     | 
                        <a href="https://codeforces.com/950b7b25b30e88e092489374e5572587/logout">Logout</a>
                    
        </div>



    </div>
    <br style="clear: both;">
</div>
        


    <div class="roundbox menu-box borderTopRound borderBottomRound" style="">
    <div class="menu-list-container">
    <ul class="menu-list main-menu-list">
                <li class=""><a href="https://codeforces.com/">Home</a></li>
                <li class=""><a href="https://codeforces.com/top">Top</a></li>
                <li class=""><a href="https://codeforces.com/catalog">Catalog</a></li>
                <li class=""><a href="https://codeforces.com/contests">Contests</a></li>
                <li class=""><a href="https://codeforces.com/gyms">Gym</a></li>
                <li class=""><a href="https://codeforces.com/problemset">Problemset</a></li>
                <li class=""><a href="https://codeforces.com/groups/my">Groups</a></li>
                <li class=""><a href="https://codeforces.com/ratings">Rating</a></li>
                <li class=""><a href="https://codeforces.com/edu/courses"><span class="edu-menu-item">Edu</span></a></li>
                <li class=""><a href="https://codeforces.com/apiHelp">API</a></li>
                <li class=""><a href="https://codeforces.com/calendar">Calendar</a></li>
                <li class=""><a href="https://codeforces.com/help">Help</a></li>
    </ul>
        <form method="post" action="https://codeforces.com/search"><input type="hidden" name="csrf_token" value="d8fb8d4ba7a52d3204c987c69587f6fc">
            <input class="search" name="query" data-isplaceholder="true" value="">
        <input type="hidden" name="_tta" value="12"></form>
    <br style="clear: both;">
</div>

    </div>

    <script type="text/javascript">
        $(document).ready(function () {
            $("input.search").focus(function () {
                if ($(this).attr("data-isPlaceholder") === "true") {
                    $(this).val("");
                    $(this).removeAttr("data-isPlaceholder");
                }
            });
        });
    </script>
            <br style="height: 3em; clear: both;">

        <div style="position: relative;">
                        <div id="sidebar">

    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ Pay attention
            <div class="top-links">
            </div>
        </div>
<div style="padding: 0.5em;">
        <div style="text-align:center;">
            <span class="contest-state-phase">Before contest</span><br><a href="https://codeforces.com/contests/1957">Codeforces Round 940 (Div. 2) and CodeCraft-23</a><br><span class="countdown" home="//codeforces.org/s/68729" noredirection="true" textbeforeredirect="" cdid="i1">27:21:36</span><br><a href="https://codeforces.com/contestRegistration/1957">Register now »</a><div class="smaller notice">*has extra registration<i class="icon-question-sign clickable-title" title="If you are late to register in 5 minutes before the start, you can register later during the extra registration. Extra registration opens 10 minutes after the contest starts and lasts 20 minutes." style="position: relative; bottom: 3px;"></i></div>
        </div>
</div>
    </div>

<style data-nocturne="true" type="text/css">
._StreamsSidebarFrame_frame {
  padding: 0.5em 0.5em 0 0.5em;
}
._StreamsSidebarFrame_frame ._StreamsSidebarFrame_stream {
  text-align: center;
  border-bottom: 1px solid #b9b9b9;
  margin: 0 -0.5em 0.5em -0.5em;
  padding: 0 1em 0.5em 1em;
}
._StreamsSidebarFrame_frame ._StreamsSidebarFrame_stream ._StreamsSidebarFrame_user {
  margin: 0 0 0.5em 0;
  font-size: 0.8em;
}
._StreamsSidebarFrame_frame ._StreamsSidebarFrame_stream ._StreamsSidebarFrame_timeMark {
  color: #777;
  font-size: 0.9em;
}
._StreamsSidebarFrame_frame ._StreamsSidebarFrame_stream:last-of-type {
  border-bottom: unset;
  margin: unset;
  padding: 0 0.5em 0.5em 1em;
}
._StreamsSidebarFrame_frame ._viewAll {
  text-align: right;
}
.moreRunningStreamsSidebarNote {
  color: #777 !important;
  text-decoration: none;
}
</style>


<script data-nocturne="true"> $(function () {

}); </script>


    <style>
        .personal-sidebar {
            margin: 1em;
        }

        .personal-sidebar .for-avatar {
            float: right;
        }

        .personal-sidebar li {
            font-size: 0.8em;
        }

        .personal-sidebar .nav-links {
            margin-top: 0.5em;
        }

        .personal-sidebar .nav-links li {
            list-style: disc;
            list-style-position: inside;
        }

        .personal-sidebar .propertyLinks li img {
            margin-right: 0.5em;
        }
    </style>


    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ epiccodingmomento
            <div class="top-links">
            </div>
        </div>
    <div class="personal-sidebar">
<div class="for-avatar"><div class="avatar"><a href="https://codeforces.com/profile/epiccodingmomento" style="position: relative;"><img src="./Efficient and easy segment trees - Codeforces_files/c8a417d4a6134f2d.jpg"></a><div><a href="https://codeforces.com/profile/epiccodingmomento" title="Newbie epiccodingmomento" class="rated-user user-gray">epiccodingmomento</a></div></div></div><div><ul class="propertyLinks"><li><img style="vertical-align:middle;position:relative;top:-2px" src="./Efficient and easy segment trees - Codeforces_files/rating-16x16.png" alt="User&#39;&#39;s contest rating in Codeforces community" title="User&#39;&#39;s contest rating in Codeforces community">Rating:&nbsp;<span style="font-weight:bold;" class="user-gray">954</span></li><li><img style="vertical-align:middle;position:relative;top:-2px" src="./Efficient and easy segment trees - Codeforces_files/star_blue_16.png" alt="User&#39;&#39;s contribution into Codeforces community" title="User&#39;&#39;s contribution into Codeforces community">Contribution:&nbsp;<span style="color:gray;font-weight:bold;">0</span></li></ul><ul class="nav-links"><li><a href="https://codeforces.com/settings/general">Settings</a></li><li><a href="https://codeforces.com/blog/epiccodingmomento">Blog</a></li><li><a href="https://codeforces.com/teams">Teams</a></li><li><a href="https://codeforces.com/submissions/epiccodingmomento">Submissions</a></li><li><a href="https://codeforces.com/favourite/contests">Favourites</a></li><li><a href="https://codeforces.com/contests/writer/epiccodingmomento">Problemsetting</a></li><li><a href="https://codeforces.com/groups/with/epiccodingmomento">Groups</a></li><li><a href="https://codeforces.com/usertalk">Talks</a></li><li><a href="https://codeforces.com/contests/with/epiccodingmomento">Contests</a></li></ul></div><br style="clear:both;">    </div>
    </div>

<div class="roundbox sidebox top-contributed borderTopRound " style="">
<div class="caption titled">→ Top rated
<div class="top-links">
</div>
</div>
<table class="rtable ">
<tbody>
<tr>
<th class="left" style="width:2.25em;">#</th>
<th class="">User</th>
<th class="" style="width:5em;">Rating</th>
</tr>
<tr>
<td class="left dark">1</td>
<td class=" dark"><a href="https://codeforces.com/profile/ecnerwala" title="Legendary Grandmaster ecnerwala" class="rated-user user-legendary"><span class="legendary-user-first-letter">e</span>cnerwala</a></td>
<td class=" dark">3648</td>
</tr>
<tr>
<td class="left ">2</td>
<td class=""><a href="https://codeforces.com/profile/Benq" title="Legendary Grandmaster Benq" class="rated-user user-legendary"><span class="legendary-user-first-letter">B</span>enq</a></td>
<td class="">3580</td>
</tr>
<tr>
<td class="left dark">3</td>
<td class=" dark"><a href="https://codeforces.com/profile/orzdevinwang" title="Legendary Grandmaster orzdevinwang" class="rated-user user-legendary"><span class="legendary-user-first-letter">o</span>rzdevinwang</a></td>
<td class=" dark">3570</td>
</tr>
<tr>
<td class="left ">4</td>
<td class=""><a href="https://codeforces.com/profile/cnnfls_csy" title="Legendary Grandmaster cnnfls_csy" class="rated-user user-legendary"><span class="legendary-user-first-letter">c</span>nnfls_csy</a></td>
<td class="">3569</td>
</tr>
<tr>
<td class="left dark">5</td>
<td class=" dark"><a href="https://codeforces.com/profile/Geothermal" title="Legendary Grandmaster Geothermal" class="rated-user user-legendary"><span class="legendary-user-first-letter">G</span>eothermal</a></td>
<td class=" dark">3568</td>
</tr>
<tr>
<td class="left ">6</td>
<td class=""><a href="https://codeforces.com/profile/tourist" title="Legendary Grandmaster tourist" class="rated-user user-legendary"><span class="legendary-user-first-letter">t</span>ourist</a></td>
<td class="">3565</td>
</tr>
<tr>
<td class="left dark">7</td>
<td class=" dark"><a href="https://codeforces.com/profile/maroonrk" title="Legendary Grandmaster maroonrk" class="rated-user user-legendary"><span class="legendary-user-first-letter">m</span>aroonrk</a></td>
<td class=" dark">3530</td>
</tr>
<tr>
<td class="left ">8</td>
<td class=""><a href="https://codeforces.com/profile/Radewoosh" title="Legendary Grandmaster Radewoosh" class="rated-user user-legendary"><span class="legendary-user-first-letter">R</span>adewoosh</a></td>
<td class="">3520</td>
</tr>
<tr>
<td class="left dark">9</td>
<td class=" dark"><a href="https://codeforces.com/profile/Um_nik" title="Legendary Grandmaster Um_nik" class="rated-user user-legendary"><span class="legendary-user-first-letter">U</span>m_nik</a></td>
<td class=" dark">3481</td>
</tr>
<tr>
<td class="left bottom">10</td>
<td class="bottom"><a href="https://codeforces.com/profile/jiangly" title="Legendary Grandmaster jiangly" class="rated-user user-legendary"><span class="legendary-user-first-letter">j</span>iangly</a></td>
<td class="bottom">3467</td>
</tr>
</tbody>
</table>
<div class="bottom-links">
<table style="width:100%;">
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://codeforces.com/ratings/countries">Countries</a> |
<a href="https://codeforces.com/ratings/cities">Cities</a> |
<a href="https://codeforces.com/ratings/organizations">Organizations</a>
</td>
<td style="text-align:right;">
<a href="https://codeforces.com/ratings">View all →</a>
</td>
</tr>
</tbody>
</table>
</div>
</div>


    <div class="roundbox sidebox top-contributed borderTopRound " style="">
        <div class="caption titled">→ Top contributors
            <div class="top-links">
            </div>
        </div>
        <table class="rtable ">
            <tbody>
                <tr>
                            <th class="left" style="width:2.25em;">#</th>
                            <th class="">User</th>
                            <th class="" style="width:5em;">Contrib.</th>
                </tr>
                    <tr>
                                <td class="left  dark">1</td>
                                <td class=" dark"><a href="https://codeforces.com/profile/maomao90" title="Grandmaster maomao90" class="rated-user user-red">maomao90</a></td>
                                <td class=" dark">174</td>
                    </tr>
                    <tr>
                                <td class="left ">2</td>
                                <td class=""><a href="https://codeforces.com/profile/awoo" title="Master awoo" class="rated-user user-orange">awoo</a></td>
                                <td class="">164</td>
                    </tr>
                    <tr>
                                <td class="left  dark">3</td>
                                <td class=" dark"><a href="https://codeforces.com/profile/adamant" title="Grandmaster adamant" class="rated-user user-red">adamant</a></td>
                                <td class=" dark">163</td>
                    </tr>
                    <tr>
                                <td class="left ">4</td>
                                <td class=""><a href="https://codeforces.com/profile/TheScrasse" title="Grandmaster TheScrasse" class="rated-user user-red">TheScrasse</a></td>
                                <td class="">159</td>
                    </tr>
                    <tr>
                                <td class="left  dark">4</td>
                                <td class=" dark"><a href="https://codeforces.com/profile/nor" title="Master nor" class="rated-user user-orange">nor</a></td>
                                <td class=" dark">159</td>
                    </tr>
                    <tr>
                                <td class="left ">6</td>
                                <td class=""><a href="https://codeforces.com/profile/maroonrk" title="Legendary Grandmaster maroonrk" class="rated-user user-legendary"><span class="legendary-user-first-letter">m</span>aroonrk</a></td>
                                <td class="">156</td>
                    </tr>
                    <tr>
                                <td class="left  dark">7</td>
                                <td class=" dark"><a href="https://codeforces.com/profile/-is-this-fft-" title="Grandmaster -is-this-fft-" class="rated-user user-red">-is-this-fft-</a></td>
                                <td class=" dark">150</td>
                    </tr>
                    <tr>
                                <td class="left ">8</td>
                                <td class=""><a href="https://codeforces.com/profile/SecondThread" title="International Master SecondThread" class="rated-user user-orange">SecondThread</a></td>
                                <td class="">147</td>
                    </tr>
                    <tr>
                                <td class="left  dark">9</td>
                                <td class=" dark"><a href="https://codeforces.com/profile/orz" title="International Grandmaster orz" class="rated-user user-red">orz</a></td>
                                <td class=" dark">146</td>
                    </tr>
                    <tr>
                                <td class="left bottom">10</td>
                                <td class="bottom"><a href="https://codeforces.com/profile/pajenegod" title="Grandmaster pajenegod" class="rated-user user-red">pajenegod</a></td>
                                <td class="bottom">145</td>
                    </tr>
            </tbody>
        </table>
            <div class="bottom-links">
                <table style="width:100%;">
                    <tbody>
                        <tr>
                            <td style="text-align:left;">
                            </td>
                            <td style="text-align:right;">
                                    <a href="https://codeforces.com/top-contributed">View all →</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </div>

    <script type="text/javascript">
        $(document).ready(function () {
        });
    </script>






    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ Favourite groups
            <div class="top-links">
            </div>
        </div>
        <table class="rtable ">
            <tbody>
                <tr>
                            <th class="left" style="width:2.25em;">#</th>
                            <th class="">Name</th>
                </tr>
                    <tr>
                                <td class="left  dark">1</td>
                                <td class=" dark">    <a href="https://codeforces.com/group/pe3C7me934" class="groupName">Ecec C2-C3-VOI-ICPC ez 39k</a>
</td>
                    </tr>
                    <tr>
                                <td class="left bottom">2</td>
                                <td class="bottom">    <a href="https://codeforces.com/group/7J22vqLbEo" class="groupName">Cp train</a>
</td>
                    </tr>
            </tbody>
        </table>
            <div class="bottom-links">
                <table style="width:100%;">
                    <tbody>
                        <tr>
                            <td style="text-align:left;">
                            </td>
                            <td style="text-align:right;">
                                    <a href="https://codeforces.com/groups/with/epiccodingmomento">View all →</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </div>


    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ Find user
            <div class="top-links">
            </div>
        </div>
        <form class="handleForm" method="post" autocomplete="off"><input type="hidden" name="csrf_token" value="d8fb8d4ba7a52d3204c987c69587f6fc">
            <div style="padding:1em;text-align:right;">
                <label style="padding-right:1em;">Handle:
                    <input style="width:12em;" type="text" class="handleBox ac_input" autocomplete="off">
                </label>
            </div>
            <div style="padding: 0 1em 1em 1em;text-align:right;">
                <input style="height:1.65em;padding:0 0.75em;" type="submit" value="Find">
            </div>
        <input type="hidden" name="_tta" value="12"></form>
    </div>
    <script type="text/javascript">
        $(document).ready(function () {
    $(".handleBox").autocomplete("/data/handles", {
        delay: 200,
        width: 200,
        selectFirst: false,
        matchContains: true,
        minChars: 3
    });
    $(".handleForm").attr("autocomplete", "off").submit(function () {
        var link = "/profile/userHandle".replace(
            "userHandle", $(this).find(".handleBox").val()
        );
        window.location = link;
        return false;
    });
        });
    </script>





    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ Recent actions
            <div class="top-links">
            </div>
        </div>
        <div class="recent-actions">
            <ul>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/ooaa" title="Master ooaa" class="rated-user user-orange">ooaa</a>        →
        <a href="https://codeforces.com/blog/entry/125300">Codeforces Round #922 (Div. 2) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./Efficient and easy segment trees - Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/quandlm" title="Specialist quandlm" class="rated-user user-cyan">quandlm</a>        →
        <a href="https://codeforces.com/blog/entry/110880">Basic Problem</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./Efficient and easy segment trees - Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
        <img alt="Necropost" title="Necropost" src="./Efficient and easy segment trees - Codeforces_files/hourglass.png" style="vertical-align:middle; position: relative; top: 1px;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/0x4F5F6F" title="Candidate Master 0x4F5F6F" class="rated-user user-violet">0x4F5F6F</a>        →
        <a href="https://codeforces.com/blog/entry/128604">Invitation to Gym Contest — Alpha VI (by Algorave)</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./Efficient and easy segment trees - Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/Tutis" title="International Master Tutis" class="rated-user user-orange">Tutis</a>        →
        <a href="https://codeforces.com/blog/entry/128662">Golang version</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="./Efficient and easy segment trees - Codeforces_files/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/fangahawk" title="Master fangahawk" class="rated-user user-orange">fangahawk</a>        →
        <a href="https://codeforces.com/blog/entry/128597">Codeforces Round #940 and CodeCraft-23 (Div. 2)</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="./Efficient and easy segment trees - Codeforces_files/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/atcoder_official" title="Unrated, atcoder_official" class="rated-user user-black">atcoder_official</a>        →
        <a href="https://codeforces.com/blog/entry/128633">AtCoder Beginner Contest 350 Announcement</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./Efficient and easy segment trees - Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/Shisuko" title="Candidate Master Shisuko" class="rated-user user-violet">Shisuko</a>        →
        <a href="https://codeforces.com/blog/entry/128228">Invitation to join the UP ACM Algolympics 2024 Final Round Mirror at the Codeforces Gym</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./Efficient and easy segment trees - Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/dario2994" title="International Grandmaster dario2994" class="rated-user user-red">dario2994</a>        →
        <a href="https://codeforces.com/blog/entry/127320">European Championship 2024 (EUC)</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./Efficient and easy segment trees - Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/flamestorm" title="Master flamestorm" class="rated-user user-orange">flamestorm</a>        →
        <a href="https://codeforces.com/blog/entry/127664">Codeforces Round 937 (Div. 4) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./Efficient and easy segment trees - Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/MohamedSaady" title="Newbie MohamedSaady" class="rated-user user-gray">MohamedSaady</a>        →
        <a href="https://codeforces.com/blog/entry/128619">The Indomie Trade — صفقة الإندومي | Short Cinematic Scene | ICPC WF Luxor 2024</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./Efficient and easy segment trees - Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/tofael1104" title="Newbie tofael1104" class="rated-user user-gray">tofael1104</a>        →
        <a href="https://codeforces.com/blog/entry/128658">The Best Part Is the Friends We Make Along the Way</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="./Efficient and easy segment trees - Codeforces_files/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/Whitewiz" title="Newbie Whitewiz" class="rated-user user-gray">Whitewiz</a>        →
        <a href="https://codeforces.com/blog/entry/128656">help needed in this problem --&gt;  STPAR - Street Parade (SPOJ)</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="./Efficient and easy segment trees - Codeforces_files/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/Kevin114514" title="Legendary Grandmaster Kevin114514" class="rated-user user-legendary"><span class="legendary-user-first-letter">K</span>evin114514</a>        →
        <a href="https://codeforces.com/blog/entry/128590">[World Finals] Who will win?</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./Efficient and easy segment trees - Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/ICPCNews" title="Unrated, ICPCNews" class="rated-user user-black">ICPCNews</a>        →
        <a href="https://codeforces.com/blog/entry/128559">The 2023 ICPC World Finals Luxor</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./Efficient and easy segment trees - Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/exhausted" title="Master exhausted" class="rated-user user-orange">exhausted</a>        →
        <a href="https://codeforces.com/blog/entry/127439">Codeforces Round #936 (Div. 2) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./Efficient and easy segment trees - Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/mainyutin" title="Expert mainyutin" class="rated-user user-blue">mainyutin</a>        →
        <a href="https://codeforces.com/blog/entry/128243">Codeforces Round 938 (Div. 3) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./Efficient and easy segment trees - Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/jim" title="Pupil jim" class="rated-user user-green">jim</a>        →
        <a href="https://codeforces.com/blog/entry/128352">Invitation to Rutgers University Open Programming Contest</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./Efficient and easy segment trees - Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/tribute_to_Ukraine_2022" title="International Grandmaster tribute_to_Ukraine_2022" class="rated-user user-red">tribute_to_Ukraine_2022</a>        →
        <a href="https://codeforces.com/blog/entry/128649">Individual tutoring</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./Efficient and easy segment trees - Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/ShivanshJ" title="Master ShivanshJ" class="rated-user user-orange">ShivanshJ</a>        →
        <a href="https://codeforces.com/blog/entry/111729">Codeforces Round #845 (Div. 2) and ByteRace 2023 Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./Efficient and easy segment trees - Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
        <img alt="Necropost" title="Necropost" src="./Efficient and easy segment trees - Codeforces_files/hourglass.png" style="vertical-align:middle; position: relative; top: 1px;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/jre" title="Newbie jre" class="rated-user user-gray">jre</a>        →
        <a href="https://codeforces.com/blog/entry/128648">Which university do you recommend?</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./Efficient and easy segment trees - Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/Flvx" title="Specialist Flvx" class="rated-user user-cyan">Flvx</a>        →
        <a href="https://codeforces.com/blog/entry/128639">Doubt in 1889B (Codeforces Round 906 Div 1.)</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./Efficient and easy segment trees - Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/-is-this-fft-" title="Grandmaster -is-this-fft-" class="rated-user user-red">-is-this-fft-</a>        →
        <a href="https://codeforces.com/blog/entry/111371">[Tutorial] FFT</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./Efficient and easy segment trees - Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
        <img alt="Necropost" title="Necropost" src="./Efficient and easy segment trees - Codeforces_files/hourglass.png" style="vertical-align:middle; position: relative; top: 1px;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/Nooor" title="Candidate Master Nooor" class="rated-user user-violet">Nooor</a>        →
        <a href="https://codeforces.com/blog/entry/64623">FFT on Array Whose Size is not a Power of Two</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="./Efficient and easy segment trees - Codeforces_files/x-update-12x12.png" style="vertical-align:middle;">
        <img alt="Necropost" title="Necropost" src="./Efficient and easy segment trees - Codeforces_files/hourglass.png" style="vertical-align:middle; position: relative; top: 1px;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/BucketPotato" title="Grandmaster BucketPotato" class="rated-user user-red">BucketPotato</a>        →
        <a href="https://codeforces.com/blog/entry/128583">California Informatics Competition (CALICO) Spring '24</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./Efficient and easy segment trees - Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/NothingFU" title="Newbie NothingFU" class="rated-user user-gray">NothingFU</a>        →
        <a href="https://codeforces.com/blog/entry/119777">CSES - Removal Game</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./Efficient and easy segment trees - Codeforces_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
            </ul>
        </div>
            <div class="bottom-links">
                <table style="width:100%;">
                    <tbody>
                        <tr>
                            <td style="text-align:left;">
                            </td>
                            <td style="text-align:right;">
                                    <a href="https://codeforces.com/recent-actions">Detailed →</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </div>
</div>
                        <div id="pageContent" class="content-with-sidebar">
                    <div class="second-level-menu">
<ul class="second-level-menu-list"><li class="backLava" style="position: absolute; display: block; margin: 0px; padding: 0px; left: 52.3594px; top: 0px; width: 39px; height: 20px; overflow: hidden;"><div class="leftLava"></div><div class="bottomLava"></div><div class="cornerLava"></div></li>
        <li><a href="https://codeforces.com/profile/Al.Cash">Al.Cash</a></li>
        <li class="current selectedLava"><a href="https://codeforces.com/blog/Al.Cash">Blog</a></li>
        <li><a href="https://codeforces.com/teams/with/Al.Cash">Teams</a></li>
        <li><a href="https://codeforces.com/submissions/Al.Cash">Submissions</a></li>
        <li><a href="https://codeforces.com/groups/with/Al.Cash">Groups</a></li>
        <li><a href="https://codeforces.com/contests/with/Al.Cash">Contests</a></li>
        <li><a href="https://codeforces.com/contests/writer/Al.Cash">Problemsetting</a></li>
</ul>
</div>
    <div style="margin-top:0;">
    <div>
        <h3><a href="https://codeforces.com/blog/Al.Cash" style="text-decoration:none;color:black !important;">Al.Cash's blog</a></h3>
    </div>
        <div style="margin-top:2em;">


<div class="has-topic-id topic" topicid="18113">
    <div class="title">
            <a href="https://codeforces.com/blog/entry/18051">            <p>Efficient and easy segment trees</p>
</a>
    </div>

    <div class="info" style="position:relative;">
            By&nbsp;<a href="https://codeforces.com/profile/Al.Cash" title="Grandmaster Al.Cash" class="rated-user user-red">Al.Cash</a>,
                <span class="format-humantime" title="May/23/2015 21:51 UTC+7">9 years ago</span>,
            
            <img style="position: relative;top: 5px;" src="./Efficient and easy segment trees - Codeforces_files/gb.png" alt="In English" title="In English">



        <span style="position:absolute;right:0;top:0.05em;margin-right:1em;display:inline;font-size:0.75em;">
            <div style="margin-top:0.25em;">
            </div>
        </span>
    </div>

    <div class="content">
        <div class="ttypography"><p>This is my first attempt at writing something useful, so your suggestions are welcome.</p><p>Most participants of programming contests are familiar with segment trees to some degree, especially having read this articles <a href="https://codeforces.com/blog/entry/15890">http://codeforces.com/blog/entry/15890</a>, <a href="http://e-maxx.ru/algo/segment_tree">http://e-maxx.ru/algo/segment_tree</a> (Russian only). If you're not — don't go there yet. I advise to read them after this article for the sake of examples, and to compare implementations and choose the one you like more (will be kinda obvious).</p><h1>Segment tree with single element modifications</h1><p>Let's start with a brief explanation of segment trees. They are used when we have an array, perform some changes and queries on continuous segments. In the first example we'll consider 2 operations:</p> <ol>   <li>modify one element in the array;</li>   <li>find the sum of elements on some segment. .</li> </ol><h3>Perfect binary tree</h3><p>I like to visualize a segment tree in the following way: <a href="http://i.imgur.com/GGBmcEP.png">image link</a></p><p><img alt=" " src="./Efficient and easy segment trees - Codeforces_files/0f52998b96c8a0f55d379fd5c990e5d2d66d1ab2.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p>Notation is <em>node_index: corresponding segment</em> (left border included, right excluded). At the bottom row we have our array (0-indexed), the leaves of the tree. For now suppose it's length is a power of 2 (16 in the example), so we get perfect binary tree. When going up the tree we take pairs of nodes with indices <span class="tex-span">(2 * <i>i</i>, 2 * <i>i</i> + 1)</span> and combine their values in their parent with index <span class="tex-span"><i>i</i></span>. This way when we're asked to find a sum on interval <span class="tex-span">[3, 11)</span>, we need to sum up only values in the nodes 19, 5, 12 and 26 (marked with bold), not all 8 values inside the interval. Let's jump directly to implementation (in C++) to see how it works:</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e5</span><span class="pun">;</span><span class="pln">  </span><span class="com">// limit for array size</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">  </span><span class="com">// array size</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">[</span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> N</span><span class="pun">];</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> build</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  </span><span class="com">// build the tree</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> </span><span class="pun">--</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">|</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> modify</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  </span><span class="com">// set value at position p</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="pln">p </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">;</span><span class="pln"> p </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> p </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">&gt;&gt;</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">^</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> query</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  </span><span class="com">// sum on interval [l, r)</span><span class="pln">
  </span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&lt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> res </span><span class="pun">+=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">l</span><span class="pun">++];</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> res </span><span class="pun">+=</span><span class="pln"> t</span><span class="pun">[--</span><span class="pln">r</span><span class="pun">];</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> t </span><span class="pun">+</span><span class="pln"> n </span><span class="pun">+</span><span class="pln"> i</span><span class="pun">);</span><span class="pln">
  build</span><span class="pun">();</span><span class="pln">
  modify</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
  printf</span><span class="pun">(</span><span class="str">"%d\n"</span><span class="pun">,</span><span class="pln"> query</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">11</span><span class="pun">));</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>That's it! Fully operational example. Forget about those cumbersome recursive functions with 5 arguments!</p><p>Now let's see why this works, and works very efficient.</p> <ol>   <li><p>As you could notice from the picture, leaves are stored in continuous nodes with indices starting with <span class="tex-span"><i>n</i></span>, element with index <span class="tex-span"><i>i</i></span> corresponds to a node with index <span class="tex-span"><i>i</i> + <i>n</i></span>. So we can read initial values directly into the tree where they belong.</p></li>   <li><p>Before doing any queries we need to build the tree, which is quite straightforward and takes <span class="tex-span"><i>O</i>(<i>n</i>)</span> time. Since parent always has index less than its children, we just process all the internal nodes in decreasing order. In case you're confused by bit operations, the code in <em>build()</em> is equivalent to <code class="tt">t[i] = t[2*i] + t[2*i+1]</code>.</p></li>   <li><p>Modifying an element is also quite straightforward and takes time proportional to the height of the tree, which is <span class="tex-span"><i>O</i>(<i>log</i>(<i>n</i>))</span>. We only need to update values in the parents of given node. So we just go up the tree knowing that parent of node <span class="tex-span"><i>p</i></span> is <span class="tex-span"><i>p</i> / 2</span> or <code class="tt">p&gt;&gt;1</code>, which means the same. <code class="tt">p^1</code> turns <span class="tex-span">2 * <i>i</i></span> into <span class="tex-span">2 * <i>i</i> + 1</span> and vice versa, so it represents the second child of <span class="tex-span"><i>p</i></span>'s parent.</p></li>   <li><p>Finding the sum also works in <span class="tex-span"><i>O</i>(<i>log</i>(<i>n</i>))</span> time. To better understand it's logic you can go through example with interval <span class="tex-span">[3, 11)</span> and verify that result is composed exactly of values in nodes 19, 26, 12 and 5 (in that order).</p></li> </ol><p>General idea is the following. If <span class="tex-span"><i>l</i></span>, the left interval border, is odd (which is equivalent to <code class="tt">l&amp;1</code>) then <span class="tex-span"><i>l</i></span> is the right child of its parent. Then our interval includes node <span class="tex-span"><i>l</i></span> but doesn't include it's parent. So we add <code class="tt">t[l]</code> and move to the right of <span class="tex-span"><i>l</i></span>'s parent by setting <span class="tex-span"><i>l</i> = (<i>l</i> + 1) / 2</span>. If <span class="tex-span"><i>l</i></span> is even, it is the left child, and the interval includes its parent as well (unless the right border interferes), so we just move to it by setting <span class="tex-span"><i>l</i> = <i>l</i> / 2</span>. Similar argumentation is applied to the right border. We stop once borders meet.</p><p>No recursion and no additional computations like finding the middle of the interval are involved, we just go through all the nodes we need, so this is very efficient.</p><h3>Arbitrary sized array</h3><p>For now we talked only about an array with size equal to some power of 2, so the binary tree was perfect. The next fact may be stunning, so prepare yourself.</p><p><strong>The code above works for any size <span class="tex-span"><i>n</i></span>.</strong></p><p>Explanation is much more complex than before, so let's focus first on the advantages it gives us.</p> <ol>   <li>Segment tree uses exactly <span class="tex-span">2 * <i>n</i></span> memory, not <span class="tex-span">4 * <i>n</i></span> like some other implementations offer.</li>   <li>Array elements are stored in continuous manner starting with index <span class="tex-span"><i>n</i></span>.</li>   <li>All operations are very efficient and easy to write.</li> </ol><p>You can skip the next section and just test the code to check that it's correct. But for those interested in some kind of explanation, here's how the tree for <span class="tex-span"><i>n</i> = 13</span> looks like: <a href="http://i.imgur.com/cwKpYH1.png">image link</a></p><p><img alt=" " src="./Efficient and easy segment trees - Codeforces_files/523e873ebb079a80c9538c4205c8c243c66058ed.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p>It's not actually a single tree any more, but a set of perfect binary trees: with root <span class="tex-span">2</span> and height 4, root <span class="tex-span">7</span> and height 2, root <span class="tex-span">12</span> and height 2, root <span class="tex-span">13</span> and height 1. Nodes denoted by dashes aren't ever used in <em>query</em> operations, so it doesn't matter what's stored there. Leaves seem to appear on different heights, but that can be fixed by cutting the tree before the node <span class="tex-span">13</span> and moving its right part to the left. I believe the resulting structure can be shown to be isomorphic to a part of larger perfect binary tree with respect to operations we perform, and this is why we get correct results.</p><p>I won't bother with formal proof here, let's just go through the example with interval [0, 7). We have <span class="tex-span"><i>l</i> = 13, <i>r</i> = 20</span>, <code class="tt">l&amp;1 =&gt; add t[13]</code> and borders change to <span class="tex-span"><i>l</i> = 7, <i>r</i> = 10</span>. Again <code class="tt">l&amp;1 =&gt; add t[7]</code>, borders change to <span class="tex-span"><i>l</i> = 4, <i>r</i> = 5</span>, and suddenly nodes are at the same height. Now we have <code class="tt">r&amp;1 =&gt; add t[4 = --r]</code>, borders change to <span class="tex-span"><i>l</i> = 2, <i>r</i> = 2</span>, so we're finished.</p><h2>Modification on interval, single element access</h2><p>Some people begin to struggle and invent something too complex when the operations are inverted, for example:</p> <ol>   <li>add a value to all elements in some interval;</li>   <li>compute an element at some position.</li> </ol><p>But all we need to do in this case is to switch the code in methods <em>modify</em> and <em>query</em> as follows:</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">void</span><span class="pln"> modify</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&lt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">l</span><span class="pun">++]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> t</span><span class="pun">[--</span><span class="pln">r</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> query</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> p </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> p </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> res </span><span class="pun">+=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>If at some point after modifications we need to inspect all the elements in the array, we can push all the modifications to the leaves using the following code. After that we can just traverse elements starting with index <span class="tex-span"><i>n</i></span>. This way we reduce the complexity from <span class="tex-span"><i>O</i>(<i>nlog</i>(<i>n</i>))</span> to <span class="tex-span"><i>O</i>(<i>n</i>)</span> similarly to using <em>build</em> instead of n modifications.</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">void</span><span class="pln"> push</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">|</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>Note, however, that code above works only in case the order of modifications on a single element doesn't affect the result. Assignment, for example, doesn't satisfy this condition. Refer to section about lazy propagation for more information.</p><h2>Non-commutative combiner functions</h2><p>For now we considered only the simplest combiner function — addition. It is commutative, which means the order of operands doesn't matter, we have <span class="tex-span"><i>a</i> + <i>b</i> = <i>b</i> + <i>a</i></span>. The same applies to <span class="tex-span"><i>min</i></span> and <span class="tex-span"><i>max</i></span>, so we can just change all occurrences of <code class="tt">+</code> to one of those functions and be fine. But don't forget to initialize query result to infinity instead of 0.</p><p>However, there are cases when the combiner isn't commutative, for example, in the problem <a href="https://codeforces.com/contest/380/problem/C" title="Codeforces Round 223 (Div. 1)">380C - Sereja and Brackets</a>, tutorial available here <a href="https://codeforces.com/blog/entry/10363">http://codeforces.com/blog/entry/10363</a>. Fortunately, our implementation can easily support that. We define structure <code class="tt">S</code> and <em>combine</em> function for it. In method <em>build</em> we just change <code class="tt">+</code> to this function. In <em>modify</em> we need to ensure the correct ordering of children, knowing that left child has even index. When answering the query, we note that nodes corresponding to the left border are processed from left to right, while the right border moves from right to left. We can express it in the code in the following way:</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">void</span><span class="pln"> modify</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> S</span><span class="pun">&amp;</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="pln">p </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">;</span><span class="pln"> p </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> combine</span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">|</span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

S query</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  S resl</span><span class="pun">,</span><span class="pln"> resr</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&lt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> resl </span><span class="pun">=</span><span class="pln"> combine</span><span class="pun">(</span><span class="pln">resl</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">l</span><span class="pun">++]);</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> resr </span><span class="pun">=</span><span class="pln"> combine</span><span class="pun">(</span><span class="pln">t</span><span class="pun">[--</span><span class="pln">r</span><span class="pun">],</span><span class="pln"> resr</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> combine</span><span class="pun">(</span><span class="pln">resl</span><span class="pun">,</span><span class="pln"> resr</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span></code></pre><h1>Lazy propagation</h1><p>Next we'll describe a technique to perform both range queries and range modifications, which is called lazy propagation. First, we need more variables:</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">int</span><span class="pln"> h </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">sizeof</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">8</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> __builtin_clz</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">  </span></code></pre><p><span class="tex-span"><i>h</i></span> is a height of the tree, the highest significant bit in <span class="tex-span"><i>n</i></span>. <code class="tt">d[i]</code> is a delayed operation to be propagated to the children of node <span class="tex-span"><i>i</i></span> when necessary (this should become clearer from the examples). Array size if only <code class="tt">N</code> because we don't have to store this information for leaves — they don't have any children. This leads us to a total of <span class="tex-span">3 * <i>n</i></span> memory use.</p><p>Previously we could say that <code class="tt">t[i]</code> is a value corresponding to it's segment. Now it's not entirely true — first we need to apply all the delayed operations on the route from node <span class="tex-span"><i>i</i></span> to the root of the tree (parents of node <span class="tex-span"><i>i</i></span>). We assume that <code class="tt">t[i]</code> already includes <code class="tt">d[i]</code>, so that route starts not with <span class="tex-span"><i>i</i></span> but with its direct parent.</p><p>Let's get back to our first example with interval <span class="tex-span">[3, 11)</span>, but now we want to modify all the elements inside this interval. In order to do that we modify <code class="tt">t[i]</code> and <code class="tt">d[i]</code> at the nodes 19, 5, 12 and 26. Later if we're asked for a value for example in node 22, we need to propagate modification from node 5 down the tree. Note that our modifications could affect <code class="tt">t[i]</code> values up the tree as well: node 19 affects nodes 9, 4, 2 and 1, node 5 affects 2 and 1. Next fact is critical for the complexity of our operations:</p><p><strong>Modification on interval <span class="tex-span">[<i>l</i>, <i>r</i>)</span> affects <code class="tt">t[i]</code> values only in the parents of border leaves: <code class="tt">l+n</code> and <code class="tt">r+n-1</code> (except the values that compose the interval itself — the ones accessed in <em>for</em> loop).</strong></p><p>The proof is simple. When processing the left border, the node we modify in our loop is always the right child of its parent. Then all the previous modifications were made in the subtree of the left child of the same parent. Otherwise we would process the parent instead of both its children. This means current direct parent is also a parent of leaf <code class="tt">l+n</code>. Similar arguments apply to the right border.</p><p>OK, enough words for now, I think it's time to look at concrete examples.</p><h3>Increment modifications, queries for maximum</h3><p>This is probably the simplest case. The code below is far from universal and not the most efficient, but it's a good place to start.</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">void</span><span class="pln"> apply</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> build</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> p </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">|</span><span class="lit">1</span><span class="pun">])</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> push</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> s </span><span class="pun">=</span><span class="pln"> h</span><span class="pun">;</span><span class="pln"> s </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> </span><span class="pun">--</span><span class="pln">s</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> p </span><span class="pun">&gt;&gt;</span><span class="pln"> s</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      apply</span><span class="pun">(</span><span class="pln">i</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
      apply</span><span class="pun">(</span><span class="pln">i</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">|</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
      d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> inc</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  l </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">int</span><span class="pln"> l0 </span><span class="pun">=</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> r0 </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(;</span><span class="pln"> l </span><span class="pun">&lt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> apply</span><span class="pun">(</span><span class="pln">l</span><span class="pun">++,</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> apply</span><span class="pun">(--</span><span class="pln">r</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  build</span><span class="pun">(</span><span class="pln">l0</span><span class="pun">);</span><span class="pln">
  build</span><span class="pun">(</span><span class="pln">r0 </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> query</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  l </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
  push</span><span class="pun">(</span><span class="pln">l</span><span class="pun">);</span><span class="pln">
  push</span><span class="pun">(</span><span class="pln">r </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
  </span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">2e9</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(;</span><span class="pln"> l </span><span class="pun">&lt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">res</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">l</span><span class="pun">++]);</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">t</span><span class="pun">[--</span><span class="pln">r</span><span class="pun">],</span><span class="pln"> res</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>Let's analyze it one method at a time. The first three are just helper methods user doesn't really need to know about.</p> <ol>   <li><p>Now that we have 2 variables for every internal node, it's useful to write a method to <em>apply</em> changes to both of them. <span class="tex-span"><i>p</i> &lt; <i>n</i></span> checks if <span class="tex-span"><i>p</i></span> is not a leaf. Important property of our operations is that if we increase all the elements in some interval by one value, maximum will increase by the same value.</p></li>   <li><p><em>build</em> is designed to update all the parents of a given node.</p></li>   <li><p><em>push</em> propagates changes from all the parents of a given node down the tree starting from the root. This parents are exactly the prefixes of <span class="tex-span"><i>p</i></span> in binary notation, that's why we use binary shifts to calculate them.</p></li> </ol><p>Now we're ready to look at main methods.</p> <ol>   <li><p>As explained above, we process increment request using our familiar loop and then updating everything else we need by calling <em>build</em>.</p></li>   <li><p>To answer the query, we use the same loop as earlier, but before that we need to push all the changes to the nodes we'll be using. Similarly to <em>build</em>, it's enough to push changes from the parents of border leaves.</p></li> </ol><p>It's easy to see that all operations above take <span class="tex-span"><i>O</i>(<i>log</i>(<i>n</i>))</span> time.</p><p>Again, this is the simplest case because of two reasons:</p> <ol>   <li>order of modifications doesn't affect the result;</li>   <li>when updating a node, we don't need to know the length of interval it represents.</li> </ol><p>We'll show how to take that into account in the next example.</p><h3>Assignment modifications, sum queries</h3><p>This example is inspired by problem <a href="http://acm.timus.ru/problem.aspx?space=1&amp;num=2042">Timus 2042</a></p><p>Again, we'll start with helper functions. Now we have more of them:</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">void</span><span class="pln"> calc</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">d</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">|</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
  </span><span class="kwd">else</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> apply</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">value</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>These are just simple <span class="tex-span"><i>O</i>(1)</span> functions to calculate value at node <span class="tex-span"><i>p</i></span> and to apply a change to the node. But there are two thing to explain:</p> <ol>   <li><p>We suppose there's a value we never use for modification, in our case it's <span class="tex-span">0</span>. In case there's no such value — we would create additional boolean array and refer to it instead of checking <code class="tt">d[p] == 0</code>.</p></li>   <li><p>Now we have additional parameter <span class="tex-span"><i>k</i></span>, which stands for the lenght of the interval corresponding to node <span class="tex-span"><i>p</i></span>. We will use this name consistently in the code to preserve this meaning. Obviously, it's impossible to calculate the sum without this parameter. We can avoid passing this parameter if we precalculate this value for every node in a separate array or calculate it from the node index on the fly, but I'll show you a way to avoid using extra memory or calculations.</p></li> </ol><p>Next we need to update <em>build</em> and <em>push</em> methods. Note that we have two versions of them: one we introduces earlier that processes the whole tree in <span class="tex-span"><i>O</i>(<i>n</i>)</span>, and one from the last example that processes just the parents of one leaf in <span class="tex-span"><i>O</i>(<i>log</i>(<i>n</i>))</span>. We can easily combine that functionality into one method and get even more.</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">void</span><span class="pln"> build</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">int</span><span class="pln"> k </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> k </span><span class="pun">&lt;&lt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    l </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&gt;=</span><span class="pln"> l</span><span class="pun">;</span><span class="pln"> </span><span class="pun">--</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> calc</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> push</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">int</span><span class="pln"> s </span><span class="pun">=</span><span class="pln"> h</span><span class="pun">,</span><span class="pln"> k </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">h</span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> s </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> </span><span class="pun">--</span><span class="pln">s</span><span class="pun">,</span><span class="pln"> k </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> l </span><span class="pun">&gt;&gt;</span><span class="pln"> s</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> r </span><span class="pun">&gt;&gt;</span><span class="pln"> s</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      apply</span><span class="pun">(</span><span class="pln">i</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> k</span><span class="pun">);</span><span class="pln">
      apply</span><span class="pun">(</span><span class="pln">i</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">|</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> k</span><span class="pun">);</span><span class="pln">
      d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>Both this methods work on any interval in <span class="tex-span"><i>O</i>(<i>log</i>(<i>n</i>) + |<i>r</i> - <i>l</i>|)</span> time. If we want to transform some interval in the tree, we can write code like this:</p> <pre><code class="prettyprint prettyprinted" style=""><span class="pln">push</span><span class="pun">(</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">);</span><span class="pln">
</span><span class="pun">...</span><span class="pln">  </span><span class="com">// do anything we want with elements in interval [l, r)</span><span class="pln">
build</span><span class="pun">(</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">);</span></code></pre><p>Let's explain how they work. First, note that we change our interval to closed by doing <code class="tt">r += n-1</code> in order to calculate parents properly. Since we process our tree level by level, is't easy to maintain current interval level, which is always a power of 2. <em>build</em> goes bottom to top, so we initialize <span class="tex-span"><i>k</i></span> to 2 (not to 1, because we don't calculate anything for the leaves but start with their direct parents) and double it on each level. <em>push</em> goes top to bottom, so <span class="tex-span"><i>k</i></span>'s initial value depends here on the height of the tree and is divided by 2 on each level.</p><p>Main methods don't change much from the last example, but <em>modify</em> has 2 things to notice:</p> <ol>   <li>Because the order of modifications is important, we need to make sure there are no old changes on the paths from the root to all the nodes we're going to update. This is done by calling <em>push</em> first as we did in <em>query</em>.</li>   <li>We need to maintain the value of <span class="tex-span"><i>k</i></span>.</li> </ol> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">void</span><span class="pln"> modify</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">value</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
  push</span><span class="pun">(</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> l </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
  push</span><span class="pun">(</span><span class="pln">r </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">);</span><span class="pln">
  </span><span class="kwd">int</span><span class="pln"> l0 </span><span class="pun">=</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> r0 </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> k </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&lt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> k </span><span class="pun">&lt;&lt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> apply</span><span class="pun">(</span><span class="pln">l</span><span class="pun">++,</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> apply</span><span class="pun">(--</span><span class="pln">r</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  build</span><span class="pun">(</span><span class="pln">l0</span><span class="pun">,</span><span class="pln"> l0 </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
  build</span><span class="pun">(</span><span class="pln">r0 </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r0</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> query</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  push</span><span class="pun">(</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> l </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
  push</span><span class="pun">(</span><span class="pln">r </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">);</span><span class="pln">
  </span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&lt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> res </span><span class="pun">+=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">l</span><span class="pun">++];</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> res </span><span class="pun">+=</span><span class="pln"> t</span><span class="pun">[--</span><span class="pln">r</span><span class="pun">];</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>One could notice that we do 3 passed in <em>modify</em> over almost the same nodes: 1 down the tree in <em>push</em>, then 2 up the tree. We can eliminate the last pass and calculate new values only where it's necessary, but the code gets more complicated:</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">void</span><span class="pln"> modify</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">value</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
  push</span><span class="pun">(</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> l </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
  push</span><span class="pun">(</span><span class="pln">r </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">);</span><span class="pln">
  </span><span class="kwd">bool</span><span class="pln"> cl </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">,</span><span class="pln"> cr </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">int</span><span class="pln"> k </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&lt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> k </span><span class="pun">&lt;&lt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cl</span><span class="pun">)</span><span class="pln"> calc</span><span class="pun">(</span><span class="pln">l </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cr</span><span class="pun">)</span><span class="pln"> calc</span><span class="pun">(</span><span class="pln">r</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> apply</span><span class="pun">(</span><span class="pln">l</span><span class="pun">++,</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">),</span><span class="pln"> cl </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> apply</span><span class="pun">(--</span><span class="pln">r</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">),</span><span class="pln"> cr </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(--</span><span class="pln">l</span><span class="pun">;</span><span class="pln"> r </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> k </span><span class="pun">&lt;&lt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cl</span><span class="pun">)</span><span class="pln"> calc</span><span class="pun">(</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cr </span><span class="pun">&amp;&amp;</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">cl </span><span class="pun">||</span><span class="pln"> l </span><span class="pun">!=</span><span class="pln"> r</span><span class="pun">))</span><span class="pln"> calc</span><span class="pun">(</span><span class="pln">r</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>Boolean flags denote if we already performed any changes to the left and to the right. Let's look at an example: <a href="http://i.imgur.com/CG6aftV.png">image link</a></p><p><img alt=" " src="./Efficient and easy segment trees - Codeforces_files/e3d2b2814d185dcb1f3f170414933e8b4c79df27.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p>We call <em>modify</em> on interval <span class="tex-span">[4, 13)</span>:</p> <ol>   <li><span class="tex-span"><i>l</i> = 20, <i>r</i> = 29</span>, we call <em>apply(28)</em>;</li>   <li><span class="tex-span"><i>l</i> = 10, <i>r</i> = 14</span>, we call <em>calc(14)</em> — first node to the right of current interval is exactly the parent of last modified node;</li>   <li><span class="tex-span"><i>l</i> = 5, <i>r</i> = 7</span>, we call <em>calc(7)</em> and then <em>apply(5)</em> and <em>apply(6)</em>;</li>   <li><span class="tex-span"><i>l</i> = 3, <i>r</i> = 3</span>, so the first loop finishes.</li> </ol><p>Now you should see the point of doing <code class="tt">--l</code>, because we still need to calculate new values in nodes 2, 3 and then 1. End condition is <code class="tt">r &gt; 0</code> because it's possible to get <span class="tex-span"><i>l</i> = 1, <i>r</i> = 1</span> after the first loop, so we need to update the root, but <code class="tt">--l</code> results in <span class="tex-span"><i>l</i> = 0</span>.</p><p>Compared to previous implementation, we avoid unnecessary calls <em>calc(10)</em>, <em>calc(5)</em> and duplicate call to <em>calc(1)</em>.</p></div>

    </div>


        
            <script type="text/javascript">
    $(document).ready(function () {
        $(".delete-resource-link-3827-18113").click(function() {
            var that = this;
            Codeforces.confirm("Are you sure you want to detach a contest?", function () {
                $.post("/data/blogAndContest", {
                    action: "detachBlogFromContest",
                    blogId: "3827",
                    blogEntryId: "18051",
                    contestId: $(that).attr("data-contestId"),
                    resourceIds: $(that).attr("data-resourceIds")
                }, function(json) {        
                    Codeforces.reloadAndShowMessageOrShowError(json, "Contest detached");
                });
            }, function () {}, "Yes", "No");
        });
    });
</script>
        

        <div style="font-size: 1.1rem;line-height: 11px;">
            <img style="vertical-align: middle;" src="./Efficient and easy segment trees - Codeforces_files/tags.png" title="Tags" alt="Tags">
                <span style="padding: 0 0.35em;">
    <a href="https://codeforces.com/search?query=efficiency" class="tag notice" style="text-decoration: none;">efficiency</a>,
                </span>
                <span style="padding: 0 0.35em;">
    <a href="https://codeforces.com/search?query=segment+trees" class="tag notice" style="text-decoration: none;">segment trees</a>
                </span>
        </div>


    <div class="roundbox meta borderTopRound borderBottomRound" style="">
        <div class="left-meta">
            <ul>
                    <li style="line-height: 1.6em;">        <a href="https://codeforces.com/blog/entry/18051#" class="topic-vote-up-18113"><img style="vertical-align:middle;position:relative;top:-0.2em" src="./Efficient and easy segment trees - Codeforces_files/voteup.png" alt="Vote: I like it" title="Vote: I like it"></a>


</li>
                    <li style="line-height: 1.6em;">

        
        <span title="Topic rating" style="font-size:larger;position:relative;bottom:1px;font-weight:bold;color:green">+354</span>
        
</li>
                    <li style="line-height: 1.6em;">        <a href="https://codeforces.com/blog/entry/18051#" class="topic-vote-down-18113"><img style="vertical-align:middle;position:relative;top:-0.2em" src="./Efficient and easy segment trees - Codeforces_files/votedown.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>


</li>
            </ul>
        </div>


            <span style="position: relative; line-height: 1.65em; top: 0.75rem; left: 0.8em;">

    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="BLOG_ENTRY" data-entityid="18051" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

            </span>

        <div class="right-meta">
            <ul>
                    <li>        <a href="https://codeforces.com/profile/Al.Cash"><img style="vertical-align:middle;position:relative;top:-1px" src="./Efficient and easy segment trees - Codeforces_files/user_16x16.png" alt="Author" title="Author"></a>


        <a href="https://codeforces.com/profile/Al.Cash">
        Al.Cash
        </a>
</li>
                    <li>        <img style="vertical-align:middle;position:relative;top:-1px" src="./Efficient and easy segment trees - Codeforces_files/date_16x16.png" alt="Publication date" title="Publication date">


        
        <span class="format-humantime" title="May/23/2015 21:51 UTC+7">9 years ago</span>
        
</li>
                    <li>        <a href="https://codeforces.com/blog/entry/18051#comments"><img style="vertical-align:middle;position:relative;top:-1px" src="./Efficient and easy segment trees - Codeforces_files/comments_16x16.png" alt="Comments" title="Comments"></a>


        <a href="https://codeforces.com/blog/entry/18051#comments">
        293
        </a>
</li>
            </ul>
        </div>

        <br style="clear:both;">
    </div>


<style type="text/css">
    .comments .title {
        float: left;
    }

    .comments .comments-actions-div {
        float: right;
        margin-top: 3rem;
        margin-right: 0.5em;
    }

    .comments .comments-actions-div .separator {
        margin: 0 1rem;
    }

    .comments label.show-archived {
    }

    .comments label.show-archived, .comments label.show-archived * {
        font-size: 1.4rem !important;
        color: black !important;
        /*position: relative !important;*/
        /*bottom: 0.4rem !important;*/
    }

    .comments label.show-archived input {
        height: 1.4rem !important;
        width: 1.4rem !important;
        position: relative;
        top: 0.25rem;
    }

    .new-root-comment {
        font-size: 1.4rem !important;
    }
</style>

    <div class="comments" commentableid="18130">
        <div style="display: flow-root">
            <div class="title">
                <img src="./Efficient and easy segment trees - Codeforces_files/comments-48x48.png" alt="Comments" title="Comments" style="position:relative;top:0.6em;">
                <a name="comments">Comments (293)</a>

            </div>
            <div class="comments-actions-div">
                    <label class="show-archived">
                        <input type="checkbox" class="show-archived-checkbox" checked="checked">
                        Show archived
                    </label>
                    <span class="separator">|</span>
                <a href="https://codeforces.com/blog/entry/18051#" class="new-root-comment">Write comment?</a>
            </div>
        </div>

<div class="comment">
    <table class="comment-table" commentid="229839" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Alex7" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/b28354ec6095bcac.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Alex7" title="Master Alex7" class="rated-user user-orange">Alex7</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/26/2015 09:25 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-229839" href="https://codeforces.com/blog/entry/18051?#comment-229839" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="229839" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="229839" class="CommentVoteFrame" data-commentrating="4" data-commentuserid="83114" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+4</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-229839">
                    <div class="moveup">
                    <div class="ttypography"><p>Is lazy propagation possible this way?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-229839 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-229839 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-229839">
            <li>
<div class="comment">
    <table class="comment-table" commentid="229841" commentparentid="229839">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Al.Cash" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/dcbc95e9f176e573.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Al.Cash" title="Grandmaster Al.Cash" class="rated-user user-red">Al.Cash</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/26/2015 09:59 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-229841" href="https://codeforces.com/blog/entry/18051?#comment-229841" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-229839" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="229841" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

    <script type="text/javascript">
        $(document).ready(function () {
            $("img.toggle-favourite").click(function () {
                var size = $(this).attr("data-size");
                var img = $(this);

                var isFavourite = !img.hasClass("remove-favourite");
                var type = img.attr("data-type");
                var entityId = img.attr("data-entityId");

                $.post("/data/favourite",
                        { entityId: entityId, type: type, isFavourite: isFavourite },
                        function(response) {
                            if (response["success"] != "true") {
                                alert(response["message"]);
                            } else {
                                if (img.hasClass("remove-favourite")) {
                                    img.attr("src", "//codeforces.org/s/68729/images/icons/star_gray_" + size + ".png");
                                    img.removeClass("remove-favourite");
                                    img.addClass("add-favourite");
                                } else {
                                    img.attr("src", "//codeforces.org/s/68729/images/icons/star_yellow_" + size + ".png");
                                    img.removeClass("add-favourite");
                                    img.addClass("remove-favourite");
                                }
                            }
                        }, "json"
                );

                return false;
            });
        });
    </script>
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="229841" class="CommentVoteFrame" data-commentrating="8" data-commentuserid="14750" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+8</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-229841">
                    <div class="moveup">
                    <div class="ttypography"><p>Of course. Modification is more complex of course, but almost all principles are already described.</p><p>I just want to polish the implementation before posting.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-229841 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-229841 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-229841">
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="229984" commentparentid="229839">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/raihatneloy" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/4ce8b389d1644b5f.jpg">        </a>
        <div><a href="https://codeforces.com/profile/raihatneloy" title="Candidate Master raihatneloy" class="rated-user user-violet">raihatneloy</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/27/2015 03:29 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-229984" href="https://codeforces.com/blog/entry/18051?#comment-229984" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-229839" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="229984" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="229984" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="50275" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-229984">
                    <div class="moveup">
                    <div class="ttypography"><p>i most of the time use this method of segment tree &amp; i also coded lazy propagation! :)</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-229984 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-229984 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-229984">
            <li>
<div class="comment">
    <table class="comment-table" commentid="295582" commentparentid="229984">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/punetharomil" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/1059fb9058bdf184.jpg">        </a>
        <div><a href="https://codeforces.com/profile/punetharomil" title="Pupil punetharomil" class="rated-user user-green">punetharomil</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/25/2016 06:17 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-295582" href="https://codeforces.com/blog/entry/18051?#comment-295582" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-229984" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="295582" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="295582" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="364408" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-295582">
                    <div class="moveup">
                    <div class="ttypography"><p>I tried lazy propagation for long but couldn't code the iterative version of it. Can you share your code for iterative lazy propagation?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-295582 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-295582 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-295582">
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="624136" commentparentid="229984">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/abhaypatil2000" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/a5f31c02e9970455.jpg">        </a>
        <div><a href="https://codeforces.com/profile/abhaypatil2000" title="Specialist abhaypatil2000" class="rated-user user-cyan">abhaypatil2000</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/17/2020 09:26 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-624136" href="https://codeforces.com/blog/entry/18051?#comment-624136" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-229984" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="624136" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="624136" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1358486" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-624136">
                    <div class="moveup">
                    <div class="ttypography"><p>Can You share your implementation</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-624136 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-624136 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-624136">
            <li>
<div class="comment">
    <table class="comment-table" commentid="946667" commentparentid="624136">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/moghit_ad" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/71bdcd6cd44d1ce3.jpg">        </a>
        <div><a href="https://codeforces.com/profile/moghit_ad" title="Pupil moghit_ad" class="rated-user user-green">moghit_ad</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/25/2022 04:50 UTC+7">20 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-946667" href="https://codeforces.com/blog/entry/18051?#comment-946667" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-624136" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="946667" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="946667" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1989727" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-946667">
                    <div class="moveup">
                    <div class="ttypography"><p>can you share your code about the range update? </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-946667 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-946667 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-946667">
            <li>
<div class="comment">
    <table class="comment-table" commentid="946705" commentparentid="946667">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/lrvideckis" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/c86da62cb9e8fe4c.jpg">        </a>
        <div><a href="https://codeforces.com/profile/lrvideckis" title="Master lrvideckis" class="rated-user user-orange">lrvideckis</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/25/2022 15:27 UTC+7">20 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-946705" href="https://codeforces.com/blog/entry/18051?#comment-946705" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-946667" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="946705" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="946705" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="522387" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-946705">
                    <div class="moveup">
                    <div class="ttypography"><p><a href="https://github.com/atcoder/ac-library/blob/master/atcoder/lazysegtree.hpp">atcoder's impl</a> is nice</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-946705 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-946705 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-946705">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="229840" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/cmd" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/8764f5c091d4152d.jpg"><img title="Badge of honor for supporting Codeforces on its 10th anniversary" src="./Efficient and easy segment trees - Codeforces_files/if_medal-bronze-blue_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/cmd" title="Master cmd" class="rated-user user-orange">cmd</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/26/2015 09:46 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-229840" href="https://codeforces.com/blog/entry/18051?#comment-229840" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="229840" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="229840" class="CommentVoteFrame" data-commentrating="23" data-commentuserid="195" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+23</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-229840">
                    <div class="moveup">
                    <div class="ttypography"><p>Also for reference: <a class="rated-user user-blue" href="https://codeforces.com/profile/Urbanowicz" title="Expert Urbanowicz">Urbanowicz</a>'s post about non-recursive segment tree implementation: <a href="https://codeforces.com/blog/entry/1256">https://codeforces.com/blog/entry/1256</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-229840 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-229840 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-229840">
            <li>
<div class="comment">
    <table class="comment-table" commentid="229899" commentparentid="229840">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/rajon_aust" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/704696dbd015d57d.jpg">        </a>
        <div><a href="https://codeforces.com/profile/rajon_aust" title="Pupil rajon_aust" class="rated-user user-green">rajon_aust</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/26/2015 21:00 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-229899" href="https://codeforces.com/blog/entry/18051?#comment-229899" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-229840" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="229899" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="229899" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="95185" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-229899">
                    <div class="moveup">
                    <div class="ttypography"><p>Thanks ! First time I know something new that segment tree with no-recursive .</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-229899 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-229899 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-229899">
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="229903" commentparentid="229840">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Al.Cash" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/dcbc95e9f176e573.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Al.Cash" title="Grandmaster Al.Cash" class="rated-user user-red">Al.Cash</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/26/2015 21:54 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-229903" href="https://codeforces.com/blog/entry/18051?#comment-229903" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-229840" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="229903" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="229903" class="CommentVoteFrame" data-commentrating="12" data-commentuserid="14750" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+12</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-229903">
                    <div class="moveup">
                    <div class="ttypography"><p>True, my implementation is basically a refinement of the one in that post and in <a class="rated-user user-violet" href="https://codeforces.com/profile/goo.gl_SsAhv" title="Candidate Master goo.gl_SsAhv">goo.gl_SsAhv</a>'s comment to that post. But for some reason it's still not well known and not really searchable, and I wasn't aware of that post. Also I hope to provide more knowledge, especially after I add the section about lazy propagation.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-229903 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-229903 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-229903">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="229994" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/rng_58" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/12337379adfa9a4c.jpg">        </a>
        <div><a href="https://codeforces.com/profile/rng_58" title="Legendary Grandmaster rng_58" class="rated-user user-legendary"><span class="legendary-user-first-letter">r</span>ng_58</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/27/2015 04:00 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-229994" href="https://codeforces.com/blog/entry/18051?#comment-229994" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="229994" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="229994" class="CommentVoteFrame" data-commentrating="41" data-commentuserid="733" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+41</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-229994">
                    <div class="moveup">
                    <div class="ttypography"><p>Just wondering, how did you write codes like this?</p><p>for (t[p += n] = value; p &gt; 1; p &gt;&gt;= 1) t[p&gt;&gt;1] = t[p] + t[p^1];</p><p>Did you write it in the first attempt or you wrote something else and compressed that?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-229994 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-229994 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-229994">
            <li>
<div class="comment">
    <table class="comment-table" commentid="230071" commentparentid="229994">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Al.Cash" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/dcbc95e9f176e573.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Al.Cash" title="Grandmaster Al.Cash" class="rated-user user-red">Al.Cash</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/27/2015 05:58 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-230071" href="https://codeforces.com/blog/entry/18051?#comment-230071" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-229994" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="230071" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="230071" class="CommentVoteFrame" data-commentrating="8" data-commentuserid="14750" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+8</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-230071">
                    <div class="moveup">
                    <div class="ttypography"><p>I don't remember, but of course it wasn't the first version, the code was revisited several times.</p><p>I think at first it looked like the code as I posted for non-commutative combiners, which is also used in <em>build</em> method.</p><p>^1 trick is used in max flow implementation where edge is stored adjacent to it's reverse, so we can use ^1 to get from one to another. I'm not sure, but probably it came from there.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-230071 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-230071 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-230071">
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="230332" commentparentid="229994">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/KADR" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/9089397f80c0fe42.jpg"><img title="Badge of honor for supporting Codeforces on its 10th anniversary" src="./Efficient and easy segment trees - Codeforces_files/if_medal-bronze-blue_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/KADR" title="Master KADR" class="rated-user user-orange">KADR</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/27/2015 13:27 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-230332" href="https://codeforces.com/blog/entry/18051?#comment-230332" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-229994" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="230332" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="230332" class="CommentVoteFrame" data-commentrating="19" data-commentuserid="1028" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+19</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-230332">
                    <div class="moveup">
                    <div class="ttypography"><p>I believe smth like this is more understandable and is equivalently short:</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="pln">p </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">;</span><span class="pln"> p </span><span class="pun">/=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span></code></pre></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-230332 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-230332 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-230332">
            <li>
<div class="comment">
    <table class="comment-table" commentid="230372" commentparentid="230332">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Al.Cash" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/dcbc95e9f176e573.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Al.Cash" title="Grandmaster Al.Cash" class="rated-user user-red">Al.Cash</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/27/2015 18:39 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-230372" href="https://codeforces.com/blog/entry/18051?#comment-230372" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-230332" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="230372" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="230372" class="CommentVoteFrame" data-commentrating="10" data-commentuserid="14750" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+10</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-230372">
                    <div class="moveup">
                    <div class="ttypography"><p>Well, it's a matter of style. I prefer not to write modifications inside a loop condition.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-230372 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-230372 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-230372">
            <li>
<div class="comment">
    <table class="comment-table" commentid="230375" commentparentid="230372">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/KADR" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/9089397f80c0fe42.jpg"><img title="Badge of honor for supporting Codeforces on its 10th anniversary" src="./Efficient and easy segment trees - Codeforces_files/if_medal-bronze-blue_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/KADR" title="Master KADR" class="rated-user user-orange">KADR</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/27/2015 18:45 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-230375" href="https://codeforces.com/blog/entry/18051?#comment-230375" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-230372" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="230375" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="230375" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1028" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-230375">
                    <div class="moveup">
                    <div class="ttypography"><p>I'm just saying that this way it's more similar to traditional segment tree implementation and thus easier to follow the logic. But you are right, it's just a matter of style :)</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-230375 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-230375 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-230375">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="230330" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/innok96" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/af9ed8235c453716.jpg">        </a>
        <div><a href="https://codeforces.com/profile/innok96" title="Expert innok96" class="rated-user user-blue">innok96</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/27/2015 13:22 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-230330" href="https://codeforces.com/blog/entry/18051?#comment-230330" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="230330" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="230330" class="CommentVoteFrame" data-commentrating="-16" data-commentuserid="209356" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-16</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-230330">
                    <div class="moveup">
                    <div class="ttypography"><p>it so useful for non-red participants</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-230330 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-230330 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-230330">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="230409" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/xrisk" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/5a12d74577b80ce3.jpg">        </a>
        <div><a href="https://codeforces.com/profile/xrisk" title="Pupil xrisk" class="rated-user user-green">xrisk</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/27/2015 21:13 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-230409" href="https://codeforces.com/blog/entry/18051?#comment-230409" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="230409" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="230409" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="230409" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="298584" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-230409">
                    <div class="moveup">
                    <div class="ttypography"><p>Hello, can you explain this line ? ~~~~~  t[p&gt;&gt;1] = t[p] + t[p^1] ~~~~~</p><p>Specifically, why are you xor-ing it?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-230409 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-230409 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-230409">
            <li>
<div class="comment">
    <table class="comment-table" commentid="230410" commentparentid="230409">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Rubanenko" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/1f1679364db3ac08.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Rubanenko" title="Master Rubanenko" class="rated-user user-orange">Rubanenko</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/27/2015 21:18 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-230410" href="https://codeforces.com/blog/entry/18051?#comment-230410" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-230409" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="230410" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="230410" class="CommentVoteFrame" data-commentrating="6" data-commentuserid="2366" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+6</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-230410">
                    <div class="moveup">
                    <div class="ttypography"><p>p&gt;&gt;1 is a parent of p in the tree. Another son of p&gt;&gt;1 is p^1, since x^1 gives you x with reversed parity(last bit). </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-230410 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-230410 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-230410">
            <li>
<div class="comment">
    <table class="comment-table" commentid="230412" commentparentid="230410">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/xrisk" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/5a12d74577b80ce3.jpg">        </a>
        <div><a href="https://codeforces.com/profile/xrisk" title="Pupil xrisk" class="rated-user user-green">xrisk</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/27/2015 21:26 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-230412" href="https://codeforces.com/blog/entry/18051?#comment-230412" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-230410" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="230412" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="230412" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="298584" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-230412">
                    <div class="moveup">
                    <div class="ttypography"><p>So basically, p^1 equals p/2 + 1 ? </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-230412 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-230412 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-230412">
            <li>
<div class="comment">
    <table class="comment-table" commentid="230418" commentparentid="230412">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Rubanenko" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/1f1679364db3ac08.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Rubanenko" title="Master Rubanenko" class="rated-user user-orange">Rubanenko</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/27/2015 21:49 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-230418" href="https://codeforces.com/blog/entry/18051?#comment-230418" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-230412" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="230418" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="230418" class="CommentVoteFrame" data-commentrating="18" data-commentuserid="2366" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+18</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-230418">
                    <div class="moveup">
                    <div class="ttypography"><p>No, p^1 equals to p+1 if p is even, and p-1 if p is odd. </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-230418 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-230418 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-230418">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="230414" commentparentid="230409">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/mketa" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/437c7cf3c16ae468.jpg">        </a>
        <div><a href="https://codeforces.com/profile/mketa" title="Specialist mketa" class="rated-user user-cyan">mketa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/27/2015 21:37 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-230414" href="https://codeforces.com/blog/entry/18051?#comment-230414" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-230409" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="230414" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="230414" class="CommentVoteFrame" data-commentrating="1" data-commentuserid="217787" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+1</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-230414">
                    <div class="moveup">
                    <div class="ttypography"><p>xor will give the other child of the parent. For example if p is left child, p^1 will give the right one. Quite an interesting way of doing this in fact.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-230414 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-230414 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-230414">
            <li>
<div class="comment">
    <table class="comment-table" commentid="230416" commentparentid="230414">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/xrisk" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/5a12d74577b80ce3.jpg">        </a>
        <div><a href="https://codeforces.com/profile/xrisk" title="Pupil xrisk" class="rated-user user-green">xrisk</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/27/2015 21:41 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-230416" href="https://codeforces.com/blog/entry/18051?#comment-230416" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-230414" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="230416" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="230416" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="298584" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-230416">
                    <div class="moveup">
                    <div class="ttypography"><p>Thank you!</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-230416 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-230416 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-230416">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="327177" commentparentid="230409">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/nurlansofiyev" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/c7bf115ff83c3eab.jpg">        </a>
        <div><a href="https://codeforces.com/profile/nurlansofiyev" title="Specialist nurlansofiyev" class="rated-user user-cyan">nurlansofiyev</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Nov/28/2016 00:25 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-327177" href="https://codeforces.com/blog/entry/18051?#comment-327177" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-230409" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="327177" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="327177" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="423612" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-327177">
                    <div class="moveup">
                    <div class="ttypography"><p>p&gt;&gt;1 equal to p/2, and this give us parent of node. and and p^1 is binary xor operator from discrete math. ^ operato copies the bit if it is set in one operand but not both. and if p is odd p^1 will be even and if p is even p^1 will be odd. this come from binary representation of p. example if 6^1 -&gt; 110 ^ 001 -&gt; 111 -&gt; 7. other expamle : 8^1 -&gt; 1000 ^ 0001 -&gt; 9</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-327177 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-327177 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-327177">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="230674" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/xrisk" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/5a12d74577b80ce3.jpg">        </a>
        <div><a href="https://codeforces.com/profile/xrisk" title="Pupil xrisk" class="rated-user user-green">xrisk</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/28/2015 19:08 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-230674" href="https://codeforces.com/blog/entry/18051?#comment-230674" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="230674" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="230674" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="298584" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-230674">
                    <div class="moveup">
                    <div class="ttypography"><p>Hello, sorry to ask another silly question. Al.Cash says :</p><p>"l, the left interval border, is odd (which is equivalent to l&amp;1)”</p><p>I am not familiar with bit operations too much, and I am having difficulty how <code class="tt">x AND 1</code> gives odd/even value. Thanks in advance :)</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-230674 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-230674 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-230674">
            <li>
<div class="comment">
    <table class="comment-table" commentid="230705" commentparentid="230674">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/edgarciarod" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/666f3e5663961350.jpg">        </a>
        <div><a href="https://codeforces.com/profile/edgarciarod" title="Specialist edgarciarod" class="rated-user user-cyan">edgarciarod</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/28/2015 23:33 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-230705" href="https://codeforces.com/blog/entry/18051?#comment-230705" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-230674" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="230705" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="230705" class="CommentVoteFrame" data-commentrating="3" data-commentuserid="121693" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-230705">
                    <div class="moveup">
                    <div class="ttypography"><p>Every odd value ends with 1(3 = 11, 5 = 101) and every even value ends with 0(2 = 10, 4 = 100).</p> <pre><code class="prettyprint prettyprinted" style=""><span class="pun">(</span><span class="pln">xxx1 </span><span class="kwd">and</span><span class="pln"> </span><span class="lit">0001</span><span class="pun">)</span><span class="pln"> </span><span class="pun">--&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="com">// odd</span><span class="pln">
</span><span class="pun">(</span><span class="pln">xxx0 </span><span class="kwd">and</span><span class="pln"> </span><span class="lit">0001</span><span class="pun">)</span><span class="pln"> </span><span class="pun">--&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="com">// even</span></code></pre></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-230705 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-230705 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-230705">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="230710" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/alanor1" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/alanor1" title="Newbie alanor1" class="rated-user user-gray">alanor1</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/28/2015 23:57 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-230710" href="https://codeforces.com/blog/entry/18051?#comment-230710" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="230710" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="230710" class="CommentVoteFrame" data-commentrating="-13" data-commentuserid="286573" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-13</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-230710">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi, I am new in competitive programming, I was reading this article and trying to use it , but i dont understand how the function query works, for example if I have these numbers 1 47 45 23 348 and I would like the sum from 47 to 23, whats numbers should I put in the arguments???? please help, thanks</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-230710 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-230710 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-230710">
            <li>
<div class="comment">
    <table class="comment-table" commentid="269894" commentparentid="230710">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/sebinechita" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/sebinechita" title="Candidate Master sebinechita" class="rated-user user-violet">sebinechita</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/31/2015 00:01 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-269894" href="https://codeforces.com/blog/entry/18051?#comment-269894" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-230710" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="269894" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="269894" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="135688" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-269894">
                    <div class="moveup">
                    <div class="ttypography"><p>well your array starts from position 0. Position of 47 is 1 and of 23 is 3. The Query will give you an answer for [l, r) so you should pass as arguments (1, 4). Hope it helps!</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-269894 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-269894 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-269894">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="230864" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Al.Cash" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/dcbc95e9f176e573.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Al.Cash" title="Grandmaster Al.Cash" class="rated-user user-red">Al.Cash</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/29/2015 22:46 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-230864" href="https://codeforces.com/blog/entry/18051?#comment-230864" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="230864" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="230864" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="230864" class="CommentVoteFrame" data-commentrating="25" data-commentuserid="14750" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+25</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-230864">
                    <div class="moveup">
                    <div class="ttypography"><p>Section about lazy propagation has been added.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-230864 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-230864 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-230864">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="230889" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/kllp" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/44882b58f6756412.jpg">        </a>
        <div><a href="https://codeforces.com/profile/kllp" title="Master kllp" class="rated-user user-orange">kllp</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/30/2015 01:31 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-230889" href="https://codeforces.com/blog/entry/18051?#comment-230889" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="230889" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="230889" class="CommentVoteFrame" data-commentrating="11" data-commentuserid="100053" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+11</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-230889">
                    <div class="moveup">
                    <div class="ttypography"><p>I did some speed comparison between recursive and non-recursive lazy segment trees. With array size of 1&lt;&lt;18 and 1e7 randomly chosen operations between modifications and queries. Array size of 1&lt;&lt;18 is of course easier for my recursive code which uses arrays of the size 2^n but on practise it doesn't affect much to the speed of the code. </p><p>My recursive ( <a href="http://paste.dy.fi/BUZ">http://paste.dy.fi/BUZ</a> ): 6 s</p><p>Non-recursive from the blog: ( <a href="http://paste.dy.fi/kBY">http://paste.dy.fi/kBY</a> ): 3 s</p><p>That's quite big difference in my opinion. Unfortunately the non-recursive one seems to be a bit more painful to code but maybe it's just that I'm used to code it recursively.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-230889 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-230889 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-230889">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="231203" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/stoic" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/b9650774063df1c7.jpg">        </a>
        <div><a href="https://codeforces.com/profile/stoic" title="Specialist stoic" class="rated-user user-cyan">stoic</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/31/2015 03:33 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-231203" href="https://codeforces.com/blog/entry/18051?#comment-231203" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="231203" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="231203" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="265885" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-231203">
                    <div class="moveup">
                    <div class="ttypography"><p>I think your modification on all element in an interval is not incrementing every element in an interval.You should check it.<br>Ex: n=8 0 1 2 3 4 5 6 7 modif(0,8,5); It should increment all places by 5.According to your algorithm array t is-  33  6 22  1 5 9 13  0 1 2 3 4 5 6 7<br>but clearly all element isn't incremented by 5. </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-231203 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-231203 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-231203">
            <li>
<div class="comment">
    <table class="comment-table" commentid="231271" commentparentid="231203">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Al.Cash" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/dcbc95e9f176e573.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Al.Cash" title="Grandmaster Al.Cash" class="rated-user user-red">Al.Cash</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/31/2015 05:28 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-231271" href="https://codeforces.com/blog/entry/18051?#comment-231271" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-231203" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="231271" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="231271" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="14750" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-231271">
                    <div class="moveup">
                    <div class="ttypography"><p>Probably you're talking about the last example, but the operation there is assignment, not increment. And array looks absolutely correct except it should start with 40 not 33 (I believe 33 is a typo — let me know if it's not the case).</p><p>That's the point of 'lazy propagation' — not to modify anything until we really need it. You shouldn't access tree elements directly unless you called <em>push(0, 8)</em>.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-231271 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-231271 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-231271">
            <li>
<div class="comment">
    <table class="comment-table" commentid="231283" commentparentid="231271">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/stoic" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/b9650774063df1c7.jpg">        </a>
        <div><a href="https://codeforces.com/profile/stoic" title="Specialist stoic" class="rated-user user-cyan">stoic</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/31/2015 06:04 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-231283" href="https://codeforces.com/blog/entry/18051?#comment-231283" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-231271" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="231283" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="231283" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="265885" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-231283">
                    <div class="moveup">
                    <div class="ttypography"><p>I was talking about this modify function: void modify(int l, int r, int value) {  for (l += n, r += n; l &lt; r; l &gt;&gt;= 1, r &gt;&gt;= 1) {  if (l&amp;1) t[l++] += value;  if (r&amp;1) t[--r] += value;  } }</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-231283 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-231283 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-231283">
            <li>
<div class="comment">
    <table class="comment-table" commentid="231287" commentparentid="231283">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Al.Cash" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/dcbc95e9f176e573.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Al.Cash" title="Grandmaster Al.Cash" class="rated-user user-red">Al.Cash</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/31/2015 06:25 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-231287" href="https://codeforces.com/blog/entry/18051?#comment-231287" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-231283" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="231287" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="231287" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="14750" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-231287">
                    <div class="moveup">
                    <div class="ttypography"><p>I see. Again, if you want to get an element — call <em>query</em>, don't access the tree directly. And you don't need to call <em>build</em> in this example.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-231287 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-231287 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-231287">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="232728" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/siddharths067" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/1072a16098961825.jpg">        </a>
        <div><a href="https://codeforces.com/profile/siddharths067" title="Newbie siddharths067" class="rated-user user-gray">siddharths067</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/05/2015 16:52 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-232728" href="https://codeforces.com/blog/entry/18051?#comment-232728" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="232728" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="232728" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="259462" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-232728">
                    <div class="moveup">
                    <div class="ttypography"><p>Is it possible to extend this form to Multiple dimensions ! </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-232728 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-232728 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-232728">
            <li>
<div class="comment">
    <table class="comment-table" commentid="232916" commentparentid="232728">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Al.Cash" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/dcbc95e9f176e573.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Al.Cash" title="Grandmaster Al.Cash" class="rated-user user-red">Al.Cash</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/06/2015 07:17 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-232916" href="https://codeforces.com/blog/entry/18051?#comment-232916" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-232728" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="232916" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="232916" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="14750" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-232916">
                    <div class="moveup">
                    <div class="ttypography"><p>Sure, just change one loop everywhere into two nested loops for different coordinates.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-232916 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-232916 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-232916">
            <li>
<div class="comment">
    <table class="comment-table" commentid="602660" commentparentid="232916">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/participant123" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/participant123" title="Expert participant123" class="rated-user user-blue">participant123</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/14/2020 00:34 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-602660" href="https://codeforces.com/blog/entry/18051?#comment-602660" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-232916" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="602660" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="602660" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1240787" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-602660">
                    <div class="moveup">
                    <div class="ttypography"><p>Is it possible to implement lazy propogation in 2D?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-602660 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-602660 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-602660">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="232956" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/wodesuck" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/233c675290f6e0a2.jpg">        </a>
        <div><a href="https://codeforces.com/profile/wodesuck" title="Expert wodesuck" class="rated-user user-blue">wodesuck</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/06/2015 14:21 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-232956" href="https://codeforces.com/blog/entry/18051?#comment-232956" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="232956" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="232956" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="39627" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-232956">
                    <div class="moveup">
                    <div class="ttypography"><p>How to perform find-kth query? For n that is not the power of 2.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-232956 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-232956 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-232956">
            <li>
<div class="comment">
    <table class="comment-table" commentid="727673" commentparentid="232956">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/TimeTraveler" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/9fb2da896f3bba45.jpg">        </a>
        <div><a href="https://codeforces.com/profile/TimeTraveler" title="Pupil TimeTraveler" class="rated-user user-green">TimeTraveler</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Nov/30/2020 23:11 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-727673" href="https://codeforces.com/blog/entry/18051?#comment-727673" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-232956" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="727673" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="727673" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1200747" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-727673">
                    <div class="moveup">
                    <div class="ttypography"><p>One way is to make it next power of two and fill rest with zeros. Then the K-th one query can be calculated iteratively as:</p> <div class="spoiler spoiler-open"><b class="spoiler-title">Code</b><div class="spoiler-content" style=""><pre><code class="prettyprint prettyprinted" style=""><span class="com">// N = next power of 2 after n</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> </span><span class="typ">Kth_One</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> s </span><span class="pun">=</span><span class="pln"> N </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln"> p </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> N</span><span class="pun">;</span><span class="pln"> p </span><span class="pun">&lt;&lt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> s </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">k </span><span class="pun">&lt;</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">])</span><span class="pln">	</span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
		k </span><span class="pun">-=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">++];</span><span class="pln">	i </span><span class="pun">+=</span><span class="pln"> s</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-727673 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-727673 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-727673">
            <li>
<div class="comment">
    <table class="comment-table" commentid="934147" commentparentid="727673">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Dio707" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/6562cb23f32443c4.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Dio707" title="Specialist Dio707" class="rated-user user-cyan">Dio707</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/20/2022 06:42 UTC+7">21 month(s) ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-934147" href="https://codeforces.com/blog/entry/18051?#comment-934147" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-727673" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="934147" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="934147" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="2428860" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-934147">
                    <div class="moveup">
                    <div class="ttypography"><p>could you explain how this is correct or how it works?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-934147 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-934147 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-934147">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="232961" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/satirmo" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg"><img title="Badge of honor for supporting Codeforces on its 10th anniversary" src="./Efficient and easy segment trees - Codeforces_files/if_medal-bronze-blue_46108.png" style="position:absolute;bottom:5px;right:10px">        </a>
        <div><a href="https://codeforces.com/profile/satirmo" title="Specialist satirmo" class="rated-user user-cyan">satirmo</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/06/2015 15:37 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-232961" href="https://codeforces.com/blog/entry/18051?#comment-232961" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="232961" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="232961" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="240648" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-232961">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi. I have a question. When should it be considered necessary to use lazy propagation?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-232961 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-232961 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-232961">
            <li>
<div class="comment">
    <table class="comment-table" commentid="232991" commentparentid="232961">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Al.Cash" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/dcbc95e9f176e573.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Al.Cash" title="Grandmaster Al.Cash" class="rated-user user-red">Al.Cash</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/06/2015 19:05 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-232991" href="https://codeforces.com/blog/entry/18051?#comment-232991" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-232961" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="232991" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="232991" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="14750" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-232991">
                    <div class="moveup">
                    <div class="ttypography"><p>When you have both range modifications and range queries, or just range modifications for which order is important (for example, assignment).</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-232991 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-232991 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-232991">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="233791" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/siddharths067" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/1072a16098961825.jpg">        </a>
        <div><a href="https://codeforces.com/profile/siddharths067" title="Newbie siddharths067" class="rated-user user-gray">siddharths067</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/08/2015 12:11 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-233791" href="https://codeforces.com/blog/entry/18051?#comment-233791" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="233791" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="233791" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="233791" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="259462" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-233791">
                    <div class="moveup">
                    <div class="ttypography"><p>Is it possible to generalize the structure for the Lazy propagation Loop , as in both the cases the propagation format of the loop changes. In recursion , no matter what the context the function has the same structure for lazy propagation namely , checking the Boolean flag and changing the value of the child nodes..</p><p>It would be better if you generalize it ....</p><p><strong>For Example in Function Build :</strong></p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> s </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> </span><span class="pun">--</span><span class="pln">s</span><span class="pun">,</span><span class="pln"> k </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> l </span><span class="pun">&gt;&gt;</span><span class="pln"> s</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> r </span><span class="pun">&gt;&gt;</span><span class="pln"> s</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span></code></pre><p>From Sum Queries</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">for</span><span class="pln"> </span><span class="pun">(;</span><span class="pln"> l </span><span class="pun">&lt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span></code></pre><p>To RMQ</p><p>There is a difference in initial values of l and r in each loop.</p><p>Note: My Concern here is generalizing a loop for propagating the Segment Tree Lazily , I don't Care about the additional factor K for Sum queries or any additional parameter for a particular purpose.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-233791 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-233791 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-233791">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="238800" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Azret" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/a7b1a0cee7127efc.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Azret" title="Expert Azret" class="rated-user user-blue">Azret</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/29/2015 02:11 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-238800" href="https://codeforces.com/blog/entry/18051?#comment-238800" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="238800" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="238800" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="238800" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="149990" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-238800">
                    <div class="moveup">
                    <div class="ttypography"><p>Understood. + for you!</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-238800 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-238800 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-238800">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="240006" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/praveen14078" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/praveen14078" title="Specialist praveen14078" class="rated-user user-cyan">praveen14078</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/06/2015 07:07 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-240006" href="https://codeforces.com/blog/entry/18051?#comment-240006" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="240006" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="240006" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="293417" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-240006">
                    <div class="moveup">
                    <div class="ttypography"><p>Can anyone please explain how the code in section "Modification on interval, single element access" actually work with a small example if possiple explaining how to we get sum over a range after the update(which also I am not able to understand!) ?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-240006 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-240006 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-240006">
            <li>
<div class="comment">
    <table class="comment-table" commentid="240058" commentparentid="240006">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Al.Cash" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/dcbc95e9f176e573.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Al.Cash" title="Grandmaster Al.Cash" class="rated-user user-red">Al.Cash</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/07/2015 00:41 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-240058" href="https://codeforces.com/blog/entry/18051?#comment-240058" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-240006" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="240058" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="240058" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="14750" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-240058">
                    <div class="moveup">
                    <div class="ttypography"><p>This example doesn't support getting sum over a range, only single element access (I was hoping it's clear from the heading). It only shows that sometimes we can invert basic operations, but for more complex operations you need lazy propagation.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-240058 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-240058 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-240058">
            <li>
<div class="comment">
    <table class="comment-table" commentid="240059" commentparentid="240058">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/praveen14078" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/praveen14078" title="Specialist praveen14078" class="rated-user user-cyan">praveen14078</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/07/2015 00:46 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-240059" href="https://codeforces.com/blog/entry/18051?#comment-240059" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-240058" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="240059" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="240059" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="293417" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-240059">
                    <div class="moveup">
                    <div class="ttypography"><p>can you give an example of single element access after some update , i am not able to grasp how query() would return a[p] (as u mentioned in some earlier comment to call query to access an element or simply what does the query() do ?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-240059 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-240059 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-240059">
            <li>
<div class="comment">
    <table class="comment-table" commentid="240082" commentparentid="240059">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Al.Cash" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/dcbc95e9f176e573.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Al.Cash" title="Grandmaster Al.Cash" class="rated-user user-red">Al.Cash</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/07/2015 04:43 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-240082" href="https://codeforces.com/blog/entry/18051?#comment-240082" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-240059" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="240082" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="240082" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="14750" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-240082">
                    <div class="moveup">
                    <div class="ttypography"><p>query() doesn't simply access the element — it calculates it as a sum of all the updates applied to that element.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-240082 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-240082 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-240082">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="240044" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/nishanthvydana" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/2b6c8bc8d041d871.jpg">        </a>
        <div><a href="https://codeforces.com/profile/nishanthvydana" title="Specialist nishanthvydana" class="rated-user user-cyan">nishanthvydana</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/06/2015 22:42 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-240044" href="https://codeforces.com/blog/entry/18051?#comment-240044" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="240044" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="240044" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="240044" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="221812" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-240044">
                    <div class="moveup">
                    <div class="ttypography"><p>Can someone explain logic(bit operations) here (t[p += n] = value; p &gt; 1; p &gt;&gt;= 1)</p><p>The above expression is from the below function void modify(int p, int value) { // set value at position p  for (t[p += n] = value; p &gt; 1; p &gt;&gt;= 1) t[p&gt;&gt;1] = t[p] + t[p^1]; }</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-240044 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-240044 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-240044">
            <li>
<div class="comment">
    <table class="comment-table" commentid="240051" commentparentid="240044">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/xrisk" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/5a12d74577b80ce3.jpg">        </a>
        <div><a href="https://codeforces.com/profile/xrisk" title="Pupil xrisk" class="rated-user user-green">xrisk</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/06/2015 23:39 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-240051" href="https://codeforces.com/blog/entry/18051?#comment-240051" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-240044" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="240051" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="240051" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="298584" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-240051">
                    <div class="moveup">
                    <div class="ttypography"><p>It is equivalent to this simplified code:</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">void</span><span class="pln"> modify</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> new_val</span><span class="pun">)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		p </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
		tree</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> new_val</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(;</span><span class="pln"> p </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">/=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			tree</span><span class="pun">[</span><span class="pln">p</span><span class="pun">/</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tree</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> tree</span><span class="pun">[</span><span class="pln">p</span><span class="pun">^</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span></code></pre><p>For the explanation of using xor(^) you can check the previous comment that I made.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-240051 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-240051 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-240051">
            <li>
<div class="comment">
    <table class="comment-table" commentid="240130" commentparentid="240051">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/nishanthvydana" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/2b6c8bc8d041d871.jpg">        </a>
        <div><a href="https://codeforces.com/profile/nishanthvydana" title="Specialist nishanthvydana" class="rated-user user-cyan">nishanthvydana</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/07/2015 17:21 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-240130" href="https://codeforces.com/blog/entry/18051?#comment-240130" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-240051" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="240130" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="240130" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="221812" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-240130">
                    <div class="moveup">
                    <div class="ttypography"><p>Can u explain query function a bit more clearly Thanks for ur previous answer</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-240130 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-240130 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-240130">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="240049" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/xrisk" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/5a12d74577b80ce3.jpg">        </a>
        <div><a href="https://codeforces.com/profile/xrisk" title="Pupil xrisk" class="rated-user user-green">xrisk</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/06/2015 23:28 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-240049" href="https://codeforces.com/blog/entry/18051?#comment-240049" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="240049" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="240049" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="298584" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-240049">
                    <div class="moveup">
                    <div class="ttypography"><p>Thanks for this post, it is very useful for beginners like me. But there is a small problem; the picture of the segment tree at the very beginning of the post is not showing. It would be nice if you fixed that :) </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-240049 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-240049 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-240049">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="240062" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/wadhwasahil" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/1bbfd5c11fa5242.jpg">        </a>
        <div><a href="https://codeforces.com/profile/wadhwasahil" title="Specialist wadhwasahil" class="rated-user user-cyan">wadhwasahil</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/07/2015 01:00 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-240062" href="https://codeforces.com/blog/entry/18051?#comment-240062" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="240062" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="240062" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="240062" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="145500" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-240062">
                    <div class="moveup">
                    <div class="ttypography"><p>Please can somebody explain how to change all the elements of an array in an interval [l,r]to a constant value v using lazy propagation.</p><p>Thanks.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-240062 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-240062 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-240062">
            <li>
<div class="comment">
    <table class="comment-table" commentid="240083" commentparentid="240062">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Al.Cash" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/dcbc95e9f176e573.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Al.Cash" title="Grandmaster Al.Cash" class="rated-user user-red">Al.Cash</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/07/2015 04:48 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-240083" href="https://codeforces.com/blog/entry/18051?#comment-240083" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-240062" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="240083" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="240083" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="14750" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-240083">
                    <div class="moveup">
                    <div class="ttypography"><p>The last example does exactly that, assignment on an interval.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-240083 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-240083 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-240083">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="240139" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/sierra101" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/7f0bc97b209a22a.jpg">        </a>
        <div><a href="https://codeforces.com/profile/sierra101" title="Specialist sierra101" class="rated-user user-cyan">sierra101</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/07/2015 19:54 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-240139" href="https://codeforces.com/blog/entry/18051?#comment-240139" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="240139" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="240139" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="223651" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-240139">
                    <div class="moveup">
                    <div class="ttypography"><p>how to scale values in a given range say [L,R] with constant C by segment tree or BIT . Thanks in advance :D</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-240139 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-240139 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-240139">
            <li>
<div class="comment">
    <table class="comment-table" commentid="243216" commentparentid="240139">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/afrizal" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/206f6cf479b00060.jpg">        </a>
        <div><a href="https://codeforces.com/profile/afrizal" title="Expert afrizal" class="rated-user user-blue">afrizal</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/31/2015 02:49 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-243216" href="https://codeforces.com/blog/entry/18051?#comment-243216" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-240139" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="243216" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="243216" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="103639" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-243216">
                    <div class="moveup">
                    <div class="ttypography"><p>I dont know for BIT but for segtree you can store additional <code class="tt">factor</code> for all nodes (initialized by 1). For each scale query, just scale this factor properties as always.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-243216 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-243216 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-243216">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="240193" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/t3rminated" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/2aabb613d9f71d67.jpg">        </a>
        <div><a href="https://codeforces.com/profile/t3rminated" title="Specialist t3rminated" class="rated-user user-cyan">t3rminated</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/08/2015 04:55 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-240193" href="https://codeforces.com/blog/entry/18051?#comment-240193" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="240193" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="240193" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="240193" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="298943" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-240193">
                    <div class="moveup">
                    <div class="ttypography"><p>i didn't get this part -</p> <pre><code class="prettyprint prettyprinted" style=""><span class="typ">When</span><span class="pln"> processing the left border</span><span class="pun">,</span><span class="pln"> the node we modify </span><span class="kwd">is</span><span class="pln"> always the right child </span><span class="kwd">of</span><span class="pln"> its parent</span><span class="pun">.</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> all the previous modifications were made </span><span class="kwd">in</span><span class="pln"> the subtree </span><span class="kwd">of</span><span class="pln"> the left child </span><span class="kwd">of</span><span class="pln"> the same parent</span><span class="pun">.</span><span class="pln"> </span><span class="typ">Otherwise</span><span class="pln"> we would process the parent instead </span><span class="kwd">of</span><span class="pln"> both its children</span><span class="pun">.</span><span class="pln"> </span><span class="typ">This</span><span class="pln"> means current direct parent </span><span class="kwd">is</span><span class="pln"> also a parent </span><span class="kwd">of</span><span class="pln"> leaf l</span><span class="pun">+</span><span class="pln">n</span></code></pre></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-240193 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-240193 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-240193">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="243608" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/abinash_nitr" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/abinash_nitr" title="Unrated, abinash_nitr" class="rated-user user-black">abinash_nitr</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/02/2015 17:16 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-243608" href="https://codeforces.com/blog/entry/18051?#comment-243608" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="243608" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="243608" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="308857" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-243608">
                    <div class="moveup">
                    <div class="ttypography"><p>I am new to segment tree and algorithms in general. I see a difference in implementation of query function at <a href="https://codeforces.com/blog/entry/1256">http://codeforces.com/blog/entry/1256</a>. In my observation query function in this post does not give correct result. Did anyone else notice that? </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-243608 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-243608 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-243608">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="245596" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/kalimm" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/5d84f7c675e9c120.jpg"><img title="Badge of honor for supporting Codeforces on its 10th anniversary" src="./Efficient and easy segment trees - Codeforces_files/if_medal-bronze-blue_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/kalimm" title="Master kalimm" class="rated-user user-orange">kalimm</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/13/2015 04:23 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-245596" href="https://codeforces.com/blog/entry/18051?#comment-245596" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="245596" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="245596" class="CommentVoteFrame" data-commentrating="5" data-commentuserid="87308" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-245596">
                    <div class="moveup">
                    <div class="ttypography"><p>I have a little question. In this problem, <a href="https://codeforces.com/problemset/problem/533/A">533A — Berland Miners</a>, I used this. I used this before, so I thought it works perfectly. </p><p>My submission with <span class="tex-span"><i>N</i> = 10<sup class="upper-index">6</sup> + 5</span> got WA. When I changed it to <span class="tex-span"><i>N</i> = 2<sup class="upper-index">20</sup></span>, it took AC.</p><p><span class="tex-span"><i>N</i> = 10<sup class="upper-index">6</sup> + 5</span> --&gt; <a href="https://codeforces.com/contest/533/submission/12482628">http://codeforces.com/contest/533/submission/12482628</a></p><p><span class="tex-span"><i>N</i> = 2<sup class="upper-index">20</sup></span> --&gt; <a href="https://codeforces.com/contest/533/submission/12483080">http://codeforces.com/contest/533/submission/12483080</a></p><p><span class="tex-span">2<sup class="upper-index">20</sup></span> is bigger than <span class="tex-span">10<sup class="upper-index">6</sup> + 5</span> but problem isn't this. I tried it with <span class="tex-span"><i>N</i> = 2 * 10<sup class="upper-index">6</sup> + 5</span> but I got WA again.</p><p><span class="tex-span"><i>N</i> = 2 * 10<sup class="upper-index">6</sup> + 5</span> --&gt; <a href="https://codeforces.com/contest/533/submission/12483105">http://codeforces.com/contest/533/submission/12483105</a></p><p>Do you have any idea about it?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-245596 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-245596 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-245596">
            <li>
<div class="comment">
    <table class="comment-table" commentid="245622" commentparentid="245596">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Urbanowicz" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Urbanowicz" title="Expert Urbanowicz" class="rated-user user-blue">Urbanowicz</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/13/2015 08:16 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-245622" href="https://codeforces.com/blog/entry/18051?#comment-245622" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-245596" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="245622" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="245622" class="CommentVoteFrame" data-commentrating="5" data-commentuserid="11366" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-245622">
                    <div class="moveup">
                    <div class="ttypography"><p>As said in this post:</p> <blockquote><p>It's not actually a single tree any more, but a set of perfect binary trees</p> </blockquote><p>Not sure, where exactly that fails for you, but I guess it's here:</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">int</span><span class="pln"> mn </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">op</span><span class="pun">[</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> x</span><span class="pun">],</span><span class="pln"> cl</span><span class="pun">[</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> x </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]);</span></code></pre><p>Seems like you intend to take left child of <code class="tt">op</code> and right child of <code class="tt">cl</code>, but when you have a set of trees it doesn't always work.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-245622 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-245622 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-245622">
            <li>
<div class="comment">
    <table class="comment-table" commentid="245629" commentparentid="245622">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/kalimm" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/5d84f7c675e9c120.jpg"><img title="Badge of honor for supporting Codeforces on its 10th anniversary" src="./Efficient and easy segment trees - Codeforces_files/if_medal-bronze-blue_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/kalimm" title="Master kalimm" class="rated-user user-orange">kalimm</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/13/2015 08:44 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-245629" href="https://codeforces.com/blog/entry/18051?#comment-245629" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-245622" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="245629" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="245629" class="CommentVoteFrame" data-commentrating="5" data-commentuserid="87308" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-245629">
                    <div class="moveup">
                    <div class="ttypography"><p>I didn't understand the problem on here. Is it different from maximum of range or another segment operation?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-245629 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-245629 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-245629">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="245623" commentparentid="245596">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Urbanowicz" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Urbanowicz" title="Expert Urbanowicz" class="rated-user user-blue">Urbanowicz</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/13/2015 08:22 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-245623" href="https://codeforces.com/blog/entry/18051?#comment-245623" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-245596" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="245623" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="245623" class="CommentVoteFrame" data-commentrating="5" data-commentuserid="11366" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-245623">
                    <div class="moveup">
                    <div class="ttypography"><p>But it works with <span class="tex-span"><i>N</i> = 3·10<sup class="upper-index">6</sup> + 5</span>... <a href="https://codeforces.com/contest/533/submission/12484538" title="Submission 12484538 by Urbanowicz">12484538</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-245623 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-245623 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-245623">
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="245659" commentparentid="245596">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Al.Cash" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/dcbc95e9f176e573.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Al.Cash" title="Grandmaster Al.Cash" class="rated-user user-red">Al.Cash</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/13/2015 17:37 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-245659" href="https://codeforces.com/blog/entry/18051?#comment-245659" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-245596" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="245659" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="245659" class="CommentVoteFrame" data-commentrating="5" data-commentuserid="14750" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-245659">
                    <div class="moveup">
                    <div class="ttypography"><p>I think the problem is in this line: <code class="tt">if(op[1] == 0)</code></p><p>Node 1 is a true root only if N is a power of 2, otherwise it's not trivial to define what's stored there (just look at the picture).</p><p>Everything is guaranteed to work only if you use queries and don't access tree element directly (except for leaves).</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-245659 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-245659 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-245659">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="255156" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/trainingtmp" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/trainingtmp" title="Specialist trainingtmp" class="rated-user user-cyan">trainingtmp</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Oct/07/2015 21:53 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-255156" href="https://codeforces.com/blog/entry/18051?#comment-255156" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="255156" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="255156" class="CommentVoteFrame" data-commentrating="10" data-commentuserid="285623" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+10</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-255156">
                    <div class="moveup">
                    <div class="ttypography"><p>Great and efficient implementation. Could you please say more about "Modification on interval [l, r) affects t[i] values only in the parents of border leaves: l+n and r+n-1.". Because, the inc method modifies more than the parents of the border leaves.</p><p>If I well understood, you want to explain the fact that in query method (max implementation) we need only to push down ONLY to the left border and right border nodes. Since when computing the query we will be using only the nodes along the route. Moreover, this explains the fact that when we finish increment method, we need ONLY to propagate up to to root of the tree starting from the left and right border leaves, so that the tree and the lazy array will be consistent and representing correct values. </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-255156 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-255156 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-255156">
            <li>
<div class="comment">
    <table class="comment-table" commentid="255273" commentparentid="255156">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Al.Cash" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/dcbc95e9f176e573.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Al.Cash" title="Grandmaster Al.Cash" class="rated-user user-red">Al.Cash</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Oct/08/2015 06:11 UTC+7">9 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-255273" href="https://codeforces.com/blog/entry/18051?#comment-255273" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-255156" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="255273" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="255273" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="14750" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-255273">
                    <div class="moveup">
                    <div class="ttypography"><p>You're right. I wanted to say what values are affected except the ones we modify directly in the loop (the ones that compose the interval). Will think how to formulate it better.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-255273 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-255273 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-255273">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="258073" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/rvelloso" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/rvelloso" title="Unrated, rvelloso" class="rated-user user-black">rvelloso</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Oct/23/2015 06:59 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-258073" href="https://codeforces.com/blog/entry/18051?#comment-258073" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="258073" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="258073" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="258073" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="347435" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-258073">
                    <div class="moveup">
                    <div class="ttypography"><pre><code class="prettyprint prettyprinted" style=""><span class="com">// In case someone needs: query with [l, r] inclusive interval:</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> query</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  </span><span class="com">// sum on interval [l, r]</span><span class="pln">
  </span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&lt;=</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> res </span><span class="pun">+=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">l</span><span class="pun">++];</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!(</span><span class="pln">r</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">))</span><span class="pln"> res </span><span class="pun">+=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">r</span><span class="pun">--];</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-258073 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-258073 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-258073">
            <li>
<div class="comment">
    <table class="comment-table" commentid="258191" commentparentid="258073">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Al.Cash" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/dcbc95e9f176e573.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Al.Cash" title="Grandmaster Al.Cash" class="rated-user user-red">Al.Cash</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Oct/24/2015 18:46 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-258191" href="https://codeforces.com/blog/entry/18051?#comment-258191" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-258073" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="258191" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="258191" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="258191" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="14750" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-258191">
                    <div class="moveup">
                    <div class="ttypography"><p>If you prefer closed interval, just change <code class="tt">r += n</code> to <code class="tt">r += n+1</code>, otherwise it's easy to make mistakes.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-258191 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-258191 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-258191">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="263737" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/ReaLNero" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/51f7ee9733475c2.jpg">        </a>
        <div><a href="https://codeforces.com/profile/ReaLNero" title="Master ReaLNero" class="rated-user user-orange">ReaLNero</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Nov/21/2015 08:15 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-263737" href="https://codeforces.com/blog/entry/18051?#comment-263737" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="263737" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="263737" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="290793" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-263737">
                    <div class="moveup">
                    <div class="ttypography"><p>You said that range modifications and point updates are simple, but the following test case doesn't give a correct example (if I understood the problem correctly): - 5 nodes - 1 2 4 8 16 are t[n, n + 1, n + 2, n + 3, n + 4] - one modification: add 2 to [0, 5) - query for 0</p><p>returns 59, while it should be 3.</p><p>Code (same as all the functions given above, but for unambiguity:</p> <pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstdio&gt;</span><span class="pln">

</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e5</span><span class="pun">;</span><span class="pln">  </span><span class="com">// limit for array size</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">  </span><span class="com">// array size</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">[</span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> N</span><span class="pun">];</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> build</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  </span><span class="com">// build the tree</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> </span><span class="pun">--</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">|</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> modify</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&lt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">l</span><span class="pun">++]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> t</span><span class="pun">[--</span><span class="pln">r</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> query</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> p </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> p </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> res </span><span class="pun">+=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> t </span><span class="pun">+</span><span class="pln"> n </span><span class="pun">+</span><span class="pln"> i</span><span class="pun">);</span><span class="pln">
  build</span><span class="pun">();</span><span class="pln">
  modify</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">);</span><span class="pln">
  printf</span><span class="pun">(</span><span class="str">"%d\n"</span><span class="pun">,</span><span class="pln"> query</span><span class="pun">(</span><span class="lit">0</span><span class="pun">));</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>Input: 5 1 2 4 8 16</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-263737 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-263737 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-263737">
            <li>
<div class="comment">
    <table class="comment-table" commentid="263740" commentparentid="263737">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Al.Cash" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/dcbc95e9f176e573.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Al.Cash" title="Grandmaster Al.Cash" class="rated-user user-red">Al.Cash</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Nov/21/2015 08:41 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-263740" href="https://codeforces.com/blog/entry/18051?#comment-263740" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-263737" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="263740" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="263740" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="14750" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-263740">
                    <div class="moveup">
                    <div class="ttypography"><p>Just remove build — it doesn't belong to this example.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-263740 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-263740 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-263740">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="263864" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/1theweblover007" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/1theweblover007" title="Pupil 1theweblover007" class="rated-user user-green">1theweblover007</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Nov/22/2015 03:58 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-263864" href="https://codeforces.com/blog/entry/18051?#comment-263864" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="263864" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="263864" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="299666" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-263864">
                    <div class="moveup">
                    <div class="ttypography"><p><a class="rated-user user-red" href="https://codeforces.com/profile/Al.Cash" title="Grandmaster Al.Cash">Al.Cash</a> , I am finding the code inside the header of for-loop too confusing, Can you please tell me the easy and the common version of theirs ?</p><p>Like this :</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&lt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span></code></pre><p>What does it mean ? Its tough for me to understand. Would be great if you could clarify this. </p><p>Thanks Alot. PS. Nice work on the tutorial, CF needs more articles like this one :)</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-263864 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-263864 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-263864">
            <li>
<div class="comment">
    <table class="comment-table" commentid="265449" commentparentid="263864">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/yeputons" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/cfc26825136c163e.jpg">        </a>
        <div><a href="https://codeforces.com/profile/yeputons" title="Grandmaster yeputons" class="rated-user user-red">yeputons</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/01/2015 06:04 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-265449" href="https://codeforces.com/blog/entry/18051?#comment-265449" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-263864" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="265449" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="265449" class="CommentVoteFrame" data-commentrating="8" data-commentuserid="2412" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+8</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-265449">
                    <div class="moveup">
                    <div class="ttypography"><p>Step-by-step, in the simpler case (when <span class="tex-span"><i>n</i> = 2<sup class="upper-index"><i>k</i></sup></span> and we have full binary tree). Consider <span class="tex-span"><i>n</i> = 16</span>:</p> <ol>   <li>We have both <code class="tt">l</code> and <code class="tt">r</code> from <span class="tex-span">[0, 16]</span>, as outer world does not know anything about tree representation — it gives is bounds of the query.</li>   <li>First operation of <code class="tt">for</code> is executed exactly once before any iteration (as per definition). That is: add <span class="tex-span"><i>n</i></span> (16 in our case) to both <code class="tt">l</code> and <code class="tt">r</code>, i.e. convert "array coordinates" to numbers of vertices in the tree.</li>   <li>Then we iterate while current segment is not-empty, that is <span class="tex-span"><i>l</i> &lt; <i>r</i></span>.</li>   <li>After each iteration we move 'up' the tree. We know that parent of vertex <span class="tex-span"><i>x</i></span> is <img align="middle" class="tex-formula" src="./Efficient and easy segment trees - Codeforces_files/de43941b404f1447fc92d014fe8c70dbdd1a60f7.png" style="max-width: 100.0%;max-height: 100.0%;">, so we should divide both <code class="tt">l</code> and <code class="tt">r</code> by two. <code class="tt">&gt;&gt;= 1</code> means "bitwise shift by one bit", which works exactly like division by two with rounding down for non-negative integers.</li> </ol></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-265449 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-265449 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-265449">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="265445" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/saurabh.kakar05" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/saurabh.kakar05" title="Newbie saurabh.kakar05" class="rated-user user-gray">saurabh.kakar05</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/01/2015 05:49 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-265445" href="https://codeforces.com/blog/entry/18051?#comment-265445" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="265445" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="265445" revisioncount="3" revision="3">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">3</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="265445" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="99874" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-265445">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi, I am trying to solve SPOJ GSS1 according to this tutorial on Segement Trees. But I am not able to write a query method. Following is my code so far. I understood the logic but not able to write query method. Please help.</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.</span><span class="typ">Scanner</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> GSS1_CanYouAnswerTheseQueriesI </span><span class="pun">{</span><span class="pln">


	</span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">SegNode</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">SegNode</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> left</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> right</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> segsum</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> bestsum</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">super</span><span class="pun">();</span><span class="pln">
			</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">left </span><span class="pun">=</span><span class="pln"> left</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">right </span><span class="pun">=</span><span class="pln"> right</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">segsum </span><span class="pun">=</span><span class="pln"> segsum</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">bestsum </span><span class="pun">=</span><span class="pln"> bestsum</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">SegNode</span><span class="pun">(){</span><span class="pln">
			</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">left </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Integer</span><span class="pun">.</span><span class="pln">MIN_VALUE</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">right </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Integer</span><span class="pun">.</span><span class="pln">MIN_VALUE</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">segsum </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Integer</span><span class="pun">.</span><span class="pln">MIN_VALUE</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">bestsum </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Integer</span><span class="pun">.</span><span class="pln">MIN_VALUE</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> left</span><span class="pun">,</span><span class="pln">right</span><span class="pun">,</span><span class="pln">segsum</span><span class="pun">,</span><span class="pln">bestsum</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">};</span><span class="pln">

	</span><span class="com">//array size</span><span class="pln">
	</span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">static</span><span class="pln"> </span><span class="typ">SegNode</span><span class="pun">[]</span><span class="pln"> nodes</span><span class="pun">;</span><span class="pln">
	
	</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> main</span><span class="pun">(</span><span class="typ">String</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		  </span><span class="typ">Scanner</span><span class="pln"> sc </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Scanner</span><span class="pun">(</span><span class="typ">System</span><span class="pun">.</span><span class="kwd">in</span><span class="pun">);</span><span class="pln">	
		  n </span><span class="pun">=</span><span class="pln"> sc</span><span class="pun">.</span><span class="pln">nextInt</span><span class="pun">();</span><span class="pln">
		  </span><span class="com">//Height of segment tree </span><span class="pln">
	      </span><span class="kwd">int</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pun">)</span><span class="pln"> </span><span class="pun">(</span><span class="typ">Math</span><span class="pun">.</span><span class="pln">ceil</span><span class="pun">(</span><span class="typ">Math</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="lit">2</span><span class="pun">)));</span><span class="pln">
	      </span><span class="com">//Maximum size of segment tree</span><span class="pln">
	      </span><span class="kwd">int</span><span class="pln"> max_size </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">pow</span><span class="pun">(</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	      nodes </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SegNode</span><span class="pun">[</span><span class="pln">max_size</span><span class="pun">];</span><span class="pln">
	      
		  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
			  </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> sc</span><span class="pun">.</span><span class="pln">nextInt</span><span class="pun">();</span><span class="pln">
			  </span><span class="typ">SegNode</span><span class="pln"> node </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SegNode</span><span class="pun">(</span><span class="kwd">in</span><span class="pun">,</span><span class="kwd">in</span><span class="pun">,</span><span class="kwd">in</span><span class="pun">,</span><span class="kwd">in</span><span class="pun">);</span><span class="pln">
			  </span><span class="com">//nodes[n + i - 1] = node;</span><span class="pln">
			  nodes</span><span class="pun">[</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> node</span><span class="pun">;</span><span class="pln">
		  </span><span class="pun">}</span><span class="pln"> 
			   
		  
		  build</span><span class="pun">();</span><span class="pln">
		  </span><span class="kwd">int</span><span class="pln"> M </span><span class="pun">=</span><span class="pln"> sc</span><span class="pun">.</span><span class="pln">nextInt</span><span class="pun">();</span><span class="pln">
		 
		  </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">M</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++){</span><span class="pln">
			  </span><span class="kwd">int</span><span class="pln"> l </span><span class="pun">=</span><span class="pln"> sc</span><span class="pun">.</span><span class="pln">nextInt</span><span class="pun">();</span><span class="pln">
			  </span><span class="kwd">int</span><span class="pln"> r </span><span class="pun">=</span><span class="pln"> sc</span><span class="pun">.</span><span class="pln">nextInt</span><span class="pun">();</span><span class="pln">
			  </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">query</span><span class="pun">(</span><span class="pln">l</span><span class="pun">,</span><span class="pln">r</span><span class="pun">));</span><span class="pln">
		  </span><span class="pun">}</span><span class="pln">
		  
	</span><span class="pun">}</span><span class="pln">
	
	</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="typ">SegNode</span><span class="pln"> merge</span><span class="pun">(</span><span class="typ">SegNode</span><span class="pln"> cl</span><span class="pun">,</span><span class="typ">SegNode</span><span class="pln"> cr</span><span class="pun">)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		</span><span class="typ">SegNode</span><span class="pln"> newNode </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SegNode</span><span class="pun">();</span><span class="pln"> 
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">cl</span><span class="pun">!=</span><span class="kwd">null</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> cr</span><span class="pun">!=</span><span class="kwd">null</span><span class="pun">){</span><span class="pln">
			newNode</span><span class="pun">.</span><span class="pln">segsum </span><span class="pun">=</span><span class="pln"> cl</span><span class="pun">.</span><span class="pln">segsum</span><span class="pun">+</span><span class="pln">cr</span><span class="pun">.</span><span class="pln">segsum</span><span class="pun">;</span><span class="pln">
			newNode</span><span class="pun">.</span><span class="pln">left </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">max</span><span class="pun">(</span><span class="pln">cl</span><span class="pun">.</span><span class="pln">segsum</span><span class="pun">+</span><span class="pln">cr</span><span class="pun">.</span><span class="pln">left</span><span class="pun">,</span><span class="pln">cl</span><span class="pun">.</span><span class="pln">left</span><span class="pun">);</span><span class="pln">
			newNode</span><span class="pun">.</span><span class="pln">right </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">max</span><span class="pun">(</span><span class="pln">cr</span><span class="pun">.</span><span class="pln">segsum</span><span class="pun">+</span><span class="pln">cl</span><span class="pun">.</span><span class="pln">right</span><span class="pun">,</span><span class="pln">cr</span><span class="pun">.</span><span class="pln">right</span><span class="pun">);</span><span class="pln">
			newNode</span><span class="pun">.</span><span class="pln">bestsum </span><span class="pun">=</span><span class="pln"> max3</span><span class="pun">(</span><span class="pln">cl</span><span class="pun">.</span><span class="pln">bestsum</span><span class="pun">,</span><span class="pln">cr</span><span class="pun">.</span><span class="pln">bestsum</span><span class="pun">,</span><span class="pln">cl</span><span class="pun">.</span><span class="pln">right</span><span class="pun">+</span><span class="pln">cr</span><span class="pun">.</span><span class="pln">left</span><span class="pun">);</span><span class="pln">
			</span><span class="kwd">return</span><span class="pln"> newNode</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">cl</span><span class="pun">==</span><span class="kwd">null</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">return</span><span class="pln"> cr</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">cr</span><span class="pun">==</span><span class="kwd">null</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">return</span><span class="pln"> cl</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		
		</span><span class="kwd">return</span><span class="pln"> newNode</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	
	</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> max3</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> a</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> b</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> c</span><span class="pun">)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">max</span><span class="pun">(</span><span class="typ">Math</span><span class="pun">.</span><span class="pln">max</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln">b</span><span class="pun">),</span><span class="pln">c</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> build</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  </span><span class="com">// build the tree</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> </span><span class="pun">--</span><span class="pln">i</span><span class="pun">){</span><span class="pln"> 
			nodes</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SegNode</span><span class="pun">();</span><span class="pln">
			nodes</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> merge</span><span class="pun">(</span><span class="pln">nodes</span><span class="pun">[</span><span class="pln">i</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">],</span><span class="pln">nodes</span><span class="pun">[</span><span class="pln">i</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">|</span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
			</span><span class="com">//nodes[i] = merge(nodes[2*i+1],nodes[2*i+2]);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> query</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  </span><span class="com">// sum on interval (l, r)</span><span class="pln">
		</span><span class="typ">SegNode</span><span class="pln"> leftinMergeNode </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span><span class="pln">
		</span><span class="typ">SegNode</span><span class="pln"> rightinMerge </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span><span class="pln">

		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&lt;=</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			</span><span class="com">//if l is the right child</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">l</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)&gt;</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
				leftinMergeNode </span><span class="pun">=</span><span class="pln"> merge</span><span class="pun">(</span><span class="pln">leftinMergeNode</span><span class="pun">,</span><span class="pln">nodes</span><span class="pun">[</span><span class="pln">l</span><span class="pun">++]);</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			</span><span class="com">//if r is the left child</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">r</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)==</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
				rightinMerge </span><span class="pun">=</span><span class="pln"> merge</span><span class="pun">(</span><span class="pln">rightinMerge</span><span class="pun">,</span><span class="pln">nodes</span><span class="pun">[</span><span class="pln">r</span><span class="pun">--]);</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			
	</span><span class="pun">}</span><span class="pln">

		</span><span class="typ">SegNode</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> merge</span><span class="pun">(</span><span class="pln">leftinMergeNode</span><span class="pun">,</span><span class="pln">rightinMerge</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">.</span><span class="pln">bestsum</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">	
</span></code></pre></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-265445 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-265445 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-265445">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="265503" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/LaFuckinGioconda" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/ab5ae451f7dc2b25.jpg">        </a>
        <div><a href="https://codeforces.com/profile/LaFuckinGioconda" title="Specialist LaFuckinGioconda" class="rated-user user-cyan">LaFuckinGioconda</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/01/2015 15:32 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-265503" href="https://codeforces.com/blog/entry/18051?#comment-265503" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="265503" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="265503" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="340095" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-265503">
                    <div class="moveup">
                    <div class="ttypography"><p>What a nice! I'm fucking wet.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-265503 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-265503 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-265503">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="267388" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/punetharomil" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/1059fb9058bdf184.jpg">        </a>
        <div><a href="https://codeforces.com/profile/punetharomil" title="Pupil punetharomil" class="rated-user user-green">punetharomil</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/15/2015 13:38 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-267388" href="https://codeforces.com/blog/entry/18051?#comment-267388" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="267388" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="267388" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="364408" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-267388">
                    <div class="moveup">
                    <div class="ttypography"><p>5 elements. (Read as 'count of 0 is 5') 0-&gt;5 1-&gt;0 2-&gt;0 3-&gt;0 4-&gt;0. Therefore for query &lt;1, the answer should be 4 cuz 4 slots have value &lt;1 (1,2,3 and 4).</p><p>according to this implementation when array is not of size 2^n, the tree is coming out to be wrong. n=5. so we start filling at n=5.</p><p>We have 4 slots with value [0,1) and 1 slot with value [5-6). The array would be like:  (started filling at 5 cuz n=5, representing [0,1)) 0 1 2 3 4 5 6 7 8 9 10<br>0 0 0 0 0 4 0 0 0 0 1</p><p>now when making segment for array index 10, the value at index 5 gets overwritten. How to handle this?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-267388 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-267388 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-267388">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="269883" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/eggeek" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/bae8799f9a73fa9d.jpg">        </a>
        <div><a href="https://codeforces.com/profile/eggeek" title="Expert eggeek" class="rated-user user-blue">eggeek</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/30/2015 22:47 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-269883" href="https://codeforces.com/blog/entry/18051?#comment-269883" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="269883" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="269883" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="32411" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-269883">
                    <div class="moveup">
                    <div class="ttypography"><p>To this line </p> <pre><code class="prettyprint prettyprinted" style=""><span class="typ">Modification</span><span class="pln"> on interval </span><span class="pun">[</span><span class="pln">l</span><span class="pun">, </span><span class="pln">r</span><span class="pun">)</span><span class="pln"> affects t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> values only </span><span class="kwd">in</span><span class="pln"> the parents </span><span class="kwd">of</span><span class="pln"> border leaves</span><span class="pun">:</span><span class="pln"> l</span><span class="pun">+</span><span class="pln">n </span><span class="kwd">and</span><span class="pln"> r</span><span class="pun">+</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">except</span><span class="pln"> the values that compose the interval itself </span><span class="pun">—</span><span class="pln"> the ones accessed </span><span class="kwd">in</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> loop</span><span class="pun">).</span></code></pre><p>I have a question:  If the <strong>apply</strong> operation does not satisfy the associative law, is it still work?</p><p>For example:  <code class="tt">modify(3, 11, value1)</code></p><p>1 If I use <strong>push(3, 11)</strong>, operations on node 5 is:</p><p>1.1 apply(2, d[2]); ( in the <code class="tt">push</code> loop); </p><p>1.2 d[5] += d[2] ( in the <code class="tt">apply</code>);</p><p>1.3 d[2] is passed to 5's son, d[5] = 0 (in the <code class="tt">apply(5, d[5])</code>;</p><p>1.4 d[5] = value (in the <code class="tt">modify</code> loop);</p><p>...</p><p>value is passed to 5's son 10 and 11, so:</p><p>1.5 <strong>d[10] = (d[10] + d[2]) + value;</strong> ( same to 11) </p><p>2 If I use <strong>push(3, 4), push(10, 11)</strong>, operations on node 5 is:</p><p>2.1 apply(2, d[2]); (in the <code class="tt">push</code> loop);</p><p>2.2 d[5] += d[2]; (in the <code class="tt">apply</code>);</p><p>2.3 d[5] += value; (in the <code class="tt">modify</code> loop);</p><p>...</p><p>d[5] is passed to 5's son 10 and 11, so:</p><p>2.4 <strong>d[10] = d[10] + (d[2] + value);</strong></p><p>1.5 is equal to 2.4, because (a+b)+c = a+(b+c), but if I replace the <code class="tt">+</code> to other special operation which does not satisfy the associative law, what should I do in <code class="tt">Lazy propagation</code>.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-269883 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-269883 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-269883">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="269891" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/NYU" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/27b21db703693fe2.jpg">        </a>
        <div><a href="https://codeforces.com/profile/NYU" title="Expert NYU" class="rated-user user-blue">NYU</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/30/2015 23:18 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-269891" href="https://codeforces.com/blog/entry/18051?#comment-269891" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="269891" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="269891" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="214122" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-269891">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi, I enjoy your post. Just wondering do you have templates for 2-D segment tree as well?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-269891 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-269891 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-269891">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="270190" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Arpa" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/bb527f3e70763938.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Arpa" title="International Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/01/2016 00:17 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-270190" href="https://codeforces.com/blog/entry/18051?#comment-270190" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="270190" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="270190" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="124237" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-270190">
                    <div class="moveup">
                    <div class="ttypography"><p><a class="rated-user user-red" href="https://codeforces.com/profile/PrinceOfPersia" title="Grandmaster PrinceOfPersia">PrinceOfPersia</a> has post about data structures:<a href="https://codeforces.com/blog/entry/15729">Link</a>.</p><p>And for segment tree:<a href="https://codeforces.com/blog/entry/15890">Link</a>.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-270190 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-270190 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-270190">
            <li>
<div class="comment">
    <table class="comment-table" commentid="275671" commentparentid="270190">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/sheri.mori" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/64ba0fe07623bc31.jpg">        </a>
        <div><a href="https://codeforces.com/profile/sheri.mori" title="Expert sheri.mori" class="rated-user user-blue">sheri.mori</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/31/2016 07:17 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-275671" href="https://codeforces.com/blog/entry/18051?#comment-275671" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-270190" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="275671" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="275671" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="275569" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-275671">
                    <div class="moveup">
                    <div class="ttypography"><p>He is <a class="rated-user user-red" href="https://codeforces.com/profile/PrinceOfPersia" title="Grandmaster PrinceOfPersia">PrinceOfPersia</a> now</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-275671 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-275671 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-275671">
            <li>
<div class="comment">
    <table class="comment-table" commentid="343688" commentparentid="275671">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/vatsal" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/501c4de31c9b6916.jpg">        </a>
        <div><a href="https://codeforces.com/profile/vatsal" title="Pupil vatsal" class="rated-user user-green">vatsal</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/17/2017 23:33 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-343688" href="https://codeforces.com/blog/entry/18051?#comment-343688" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-275671" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="343688" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="343688" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="317733" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-343688">
                    <div class="moveup">
                    <div class="ttypography"><p>He is <a class="rated-user user-orange" href="https://codeforces.com/profile/PrinceOfPersia" title="International Master PrinceOfPersia">PrinceOfPersia</a> now.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-343688 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-343688 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-343688">
            <li>
<div class="comment">
    <table class="comment-table" commentid="405253" commentparentid="343688">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/-_-_-" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/6790dac8ca3cf5da.jpg">        </a>
        <div><a href="https://codeforces.com/profile/-_-_-" title="Specialist -_-_-" class="rated-user user-cyan">-_-_-</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/03/2018 20:03 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-405253" href="https://codeforces.com/blog/entry/18051?#comment-405253" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-343688" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="405253" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="405253" class="CommentVoteFrame" data-commentrating="1" data-commentuserid="372400" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+1</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-405253">
                    <div class="moveup">
                    <div class="ttypography"><p>He is <a class="rated-user user-orange" href="https://codeforces.com/profile/PrinceOfPersia" title="International Master PrinceOfPersia">PrinceOfPersia</a> now</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-405253 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-405253 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-405253">
            <li>
<div class="comment">
    <table class="comment-table" commentid="469121" commentparentid="405253">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/harrypotter0" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/550a6a614ea92893.jpg">        </a>
        <div><a href="https://codeforces.com/profile/harrypotter0" title="Pupil harrypotter0" class="rated-user user-green">harrypotter0</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Nov/03/2018 17:12 UTC+7">5 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-469121" href="https://codeforces.com/blog/entry/18051?#comment-469121" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-405253" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="469121" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="469121" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="400753" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-469121">
                    <div class="moveup">
                    <div class="ttypography"><p>Million Dollar question (for everyone AmirMohammad Dehghan) except his future handle will be ???</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-469121 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-469121 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-469121">
            <li>
<div class="comment">
    <table class="comment-table" commentid="480726" commentparentid="469121">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/PrinceOfPersia" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/4fa31bcb20de75af.jpg">        </a>
        <div><a href="https://codeforces.com/profile/PrinceOfPersia" title="International Master PrinceOfPersia" class="rated-user user-orange">PrinceOfPersia</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/31/2018 18:09 UTC+7">5 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-480726" href="https://codeforces.com/blog/entry/18051?#comment-480726" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-469121" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="480726" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="480726" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="207254" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-480726">
                    <div class="moveup">
                    <div class="ttypography"><p>Who can guess? ;)</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-480726 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-480726 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-480726">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="270716" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/-RooneY-" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/-RooneY-" title="Specialist -RooneY-" class="rated-user user-cyan">-RooneY-</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/04/2016 00:09 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-270716" href="https://codeforces.com/blog/entry/18051?#comment-270716" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="270716" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="270716" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="270716" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="541" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-270716">
                    <div class="moveup">
                    <div class="ttypography"><p>N.A.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-270716 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-270716 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-270716">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="271254" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/shyam81295" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/shyam81295" title="Newbie shyam81295" class="rated-user user-gray">shyam81295</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/08/2016 05:09 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-271254" href="https://codeforces.com/blog/entry/18051?#comment-271254" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="271254" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="271254" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="259627" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-271254">
                    <div class="moveup">
                    <div class="ttypography"><p>I solved some questions based on this method (non-recursive segment trees) and it worked like a charm,but I think this method fails when building of tree depends on position of nodes for calculations, i.e. when there is non-combiner functions. Example: <a href="https://www.hackerearth.com/problem/algorithm/2-vs-3/">https://www.hackerearth.com/problem/algorithm/2-vs-3/</a></p><p>Is it possible to solve this problem using above mentioned method ?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-271254 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-271254 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-271254">
            <li>
<div class="comment">
    <table class="comment-table" commentid="271257" commentparentid="271254">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/yeputons" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/cfc26825136c163e.jpg">        </a>
        <div><a href="https://codeforces.com/profile/yeputons" title="Grandmaster yeputons" class="rated-user user-red">yeputons</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/08/2016 06:28 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-271257" href="https://codeforces.com/blog/entry/18051?#comment-271257" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-271254" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="271257" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="271257" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="2412" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-271257">
                    <div class="moveup">
                    <div class="ttypography"><p>Sure. Non-recursive bottom-top approach changes order of calculations and node visiting only. If that does not matter (and it does not if there are no complex group operations), you can apply all top-bottom tricks, including dependency on node's position. One way is to get node's interval's borders based on its id, another way is to simple 'embed' all necessary information into node inself, so it not only know value modulo 3, but also its length (or which power of 3 we should use when appending that node to the right).</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-271257 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-271257 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-271257">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="274004" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Ahmadshallouf" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/bc9ba78fa17ca2f7.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Ahmadshallouf" title="Specialist Ahmadshallouf" class="rated-user user-cyan">Ahmadshallouf</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/22/2016 10:23 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-274004" href="https://codeforces.com/blog/entry/18051?#comment-274004" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="274004" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="274004" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="282228" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-274004">
                    <div class="moveup">
                    <div class="ttypography"><p>the range modify function is not working can you explain it please ?</p><p>void modify(int l, int r, int value) {  for (l += n, r += n; l &lt; r; l &gt;&gt;= 1, r &gt;&gt;= 1) {  if (l&amp;1) t[l++] += value;  if (r&amp;1) t[--r] += value;  } }</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-274004 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-274004 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-274004">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="275686" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/sheri.mori" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/64ba0fe07623bc31.jpg">        </a>
        <div><a href="https://codeforces.com/profile/sheri.mori" title="Expert sheri.mori" class="rated-user user-blue">sheri.mori</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/31/2016 08:07 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-275686" href="https://codeforces.com/blog/entry/18051?#comment-275686" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="275686" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="275686" revisioncount="3" revision="3">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">3</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="275686" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="275569" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-275686">
                    <div class="moveup">
                    <div class="ttypography"><p>First thank you for this awesome tutorial.But one thing I was confused about ever since I read the first code was why do you always say : <code class="tt">if (r&amp;1)</code> shouldn't it be <code class="tt">if ((r^1)&amp;1)</code> ? because if r is odd then we have all of the children of its parent , so we do the changes to its parent rather than r itself.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-275686 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-275686 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-275686">
            <li>
<div class="comment">
    <table class="comment-table" commentid="276963" commentparentid="275686">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/csssaz" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/c8fbd9463a80b0a1.jpg">        </a>
        <div><a href="https://codeforces.com/profile/csssaz" title="Expert csssaz" class="rated-user user-blue">csssaz</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/06/2016 07:58 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-276963" href="https://codeforces.com/blog/entry/18051?#comment-276963" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-275686" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="276963" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="276963" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="276963" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="263152" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-276963">
                    <div class="moveup">
                    <div class="ttypography"><p>remember that operations are defined as [l, r), so r always refers to the element in the right of your inclusive range. </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-276963 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-276963 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-276963">
            <li>
<div class="comment">
    <table class="comment-table" commentid="276980" commentparentid="276963">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/sheri.mori" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/64ba0fe07623bc31.jpg">        </a>
        <div><a href="https://codeforces.com/profile/sheri.mori" title="Expert sheri.mori" class="rated-user user-blue">sheri.mori</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/06/2016 15:47 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-276980" href="https://codeforces.com/blog/entry/18051?#comment-276980" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-276963" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="276980" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="276980" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="275569" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-276980">
                    <div class="moveup">
                    <div class="ttypography"><p>Yeah. Thx. got it</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-276980 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-276980 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-276980">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="280527" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/chrisboo" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/chrisboo" title="Expert chrisboo" class="rated-user user-blue">chrisboo</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/26/2016 12:37 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-280527" href="https://codeforces.com/blog/entry/18051?#comment-280527" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="280527" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="280527" class="CommentVoteFrame" data-commentrating="8" data-commentuserid="262131" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+8</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-280527">
                    <div class="moveup">
                    <div class="ttypography"><p>This blog is brilliant! Can you also add a section on Persistent Segment Tree? We need to create new nodes when updating a node, how can it be done efficiently using this kind of segment tree? Thanks!</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-280527 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-280527 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-280527">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="285866" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/theMonkeyKing" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/a18a5e79d9bb6a7.jpg">        </a>
        <div><a href="https://codeforces.com/profile/theMonkeyKing" title="Pupil theMonkeyKing" class="rated-user user-green">theMonkeyKing</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/25/2016 07:04 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-285866" href="https://codeforces.com/blog/entry/18051?#comment-285866" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="285866" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="285866" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="363394" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-285866">
                    <div class="moveup">
                    <div class="ttypography"><p>A wonderful implementation of segment tree . Thanks for this awesome article. If you write another blog or add a section in this blog on <strong>persistent segment tree</strong> (non-recursive implementation) that will be very helpful. </p><p>Thanks Again :) @Al.Cash</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-285866 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-285866 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-285866">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="287327" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/YukimuraYukino" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/YukimuraYukino" title="Specialist YukimuraYukino" class="rated-user user-cyan">YukimuraYukino</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/01/2016 06:58 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-287327" href="https://codeforces.com/blog/entry/18051?#comment-287327" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="287327" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="287327" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="403400" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-287327">
                    <div class="moveup">
                    <div class="ttypography"><p>How to implement the query method for problems like this: <a href="https://codeforces.com/problemset/problem/145/E">145E</a> ? </p><p>I tried dividing the array into O(log n) disjoint segment and then DP on them and got AC, but it made me implement a lot more thing, and I think it won't work if the problem asks to print answer for a segment [l; r], for example, GSS1 on SPOJ.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-287327 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-287327 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-287327">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="287332" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/adamant" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/69bc1400e66dced8.jpg">        </a>
        <div><a href="https://codeforces.com/profile/adamant" title="Grandmaster adamant" class="rated-user user-red">adamant</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/01/2016 07:15 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-287332" href="https://codeforces.com/blog/entry/18051?#comment-287332" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="287332" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="287332" class="CommentVoteFrame" data-commentrating="8" data-commentuserid="50468" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+8</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-287332">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi, <a class="rated-user user-red" href="https://codeforces.com/profile/Al.Cash" title="International Grandmaster Al.Cash">Al.Cash</a>!</p><p>Frankly saying, I didn't watch the whole entry. But anyway I want to coin something. </p><p>The reason I use recursive implementation of segment trees besides that it is clear and simple is the fact that it is very generic. Many modifications of it come with no cost. For example it is the matter of additional 5-10 lines to make the tree persistent or to make it work on some huge interval like <span class="tex-span">[0;10<sup class="upper-index">9</sup>]</span>. Your tree is heavily based on binary indexation. So, such modifications should be pretty hard. Am I correct?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-287332 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-287332 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-287332">
            <li>
<div class="comment">
    <table class="comment-table" commentid="288022" commentparentid="287332">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Al.Cash" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/dcbc95e9f176e573.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Al.Cash" title="Grandmaster Al.Cash" class="rated-user user-red">Al.Cash</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/06/2016 06:28 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-288022" href="https://codeforces.com/blog/entry/18051?#comment-288022" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-287332" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="288022" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="288022" class="CommentVoteFrame" data-commentrating="23" data-commentuserid="14750" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+23</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-288022">
                    <div class="moveup">
                    <div class="ttypography"><p>True, is't impossible to modify this approach to support persistency or arbitrary intervals. However it handles all other cases better and they are the vast majority. Especially it's noticeable in the simplest (and the most common) case.</p><p>The choice is up to you, of course :)</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-288022 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-288022 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-288022">
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="288066" commentparentid="287332">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/NSV" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/32adf5df347b8168.jpg">        </a>
        <div><a href="https://codeforces.com/profile/NSV" title="Candidate Master NSV" class="rated-user user-violet">NSV</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/06/2016 08:58 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-288066" href="https://codeforces.com/blog/entry/18051?#comment-288066" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-287332" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="288066" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="288066" class="CommentVoteFrame" data-commentrating="5" data-commentuserid="9904" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-288066">
                    <div class="moveup">
                    <div class="ttypography"><p>BTW you can just use unordered_map instead of array in order to make it work on some huge interval like <span class="tex-span">[0;10<sup class="upper-index">9</sup>]</span>. AFAIK it's well known trick used with Fenwick Tree.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-288066 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-288066 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-288066">
            <li>
<div class="comment">
    <table class="comment-table" commentid="288074" commentparentid="288066">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/adamant" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/69bc1400e66dced8.jpg">        </a>
        <div><a href="https://codeforces.com/profile/adamant" title="Grandmaster adamant" class="rated-user user-red">adamant</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/06/2016 09:18 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-288074" href="https://codeforces.com/blog/entry/18051?#comment-288074" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-288066" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="288074" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="288074" class="CommentVoteFrame" data-commentrating="5" data-commentuserid="50468" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-288074">
                    <div class="moveup">
                    <div class="ttypography"><p>Noooo. Very, very, very bad idea. The constant is too large even for Fenwick. Many problems where <span class="tex-span">[0;10<sup class="upper-index">9</sup>]</span> expect participant to compress the data instead of using dynamic structure, so it is usually hard to get accepted even with fair dynamic tree. Using unordered_map instead of it is simply waste of time, in my opinion. </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-288074 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-288074 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-288074">
            <li>
<div class="comment">
    <table class="comment-table" commentid="288075" commentparentid="288074">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/NSV" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/32adf5df347b8168.jpg">        </a>
        <div><a href="https://codeforces.com/profile/NSV" title="Candidate Master NSV" class="rated-user user-violet">NSV</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/06/2016 09:31 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-288075" href="https://codeforces.com/blog/entry/18051?#comment-288075" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-288074" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="288075" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="288075" class="CommentVoteFrame" data-commentrating="5" data-commentuserid="9904" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-288075">
                    <div class="moveup">
                    <div class="ttypography"><p>Yes, you are right, data compression of course better. But I guess that perfomance of BIT + unordered_map is not so much worse than performance of dynamic tree. From another hand it's extremely easy way to modify this data structure and it's also possible for some problems.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-288075 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-288075 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-288075">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="287990" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/iskon" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/iskon" title="Pupil iskon" class="rated-user user-green">iskon</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/06/2016 03:09 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-287990" href="https://codeforces.com/blog/entry/18051?#comment-287990" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="287990" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="287990" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="254802" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-287990">
                    <div class="moveup">
                    <div class="ttypography"><p>can we find sum of elements(of different sets respectively) of a power set using segment tree?Explain.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-287990 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-287990 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-287990">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="288549" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/kocko" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/451fc55bcbb1ab42.jpg"><img title="Badge of honor for supporting Codeforces on its 10th anniversary" src="./Efficient and easy segment trees - Codeforces_files/if_medal-bronze-blue_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/kocko" title="Specialist kocko" class="rated-user user-cyan">kocko</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/10/2016 06:12 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-288549" href="https://codeforces.com/blog/entry/18051?#comment-288549" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="288549" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="288549" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="288549" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="23635" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-288549">
                    <div class="moveup">
                    <div class="ttypography"><p>I'm not that much into C++, but shouldn't this statement</p> <pre>scanf("%d", t + n + i);</pre><p>be actually:</p> <pre>scanf("%d", t[n + i]); // since t is an array</pre><p>?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-288549 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-288549 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-288549">
            <li>
<div class="comment">
    <table class="comment-table" commentid="288553" commentparentid="288549">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/hellman_" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/14b2cadb062277ab.jpg"><img title="Badge of honor for supporting Codeforces on its 10th anniversary" src="./Efficient and easy segment trees - Codeforces_files/if_medal-bronze-blue_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/hellman_" title="Master hellman_" class="rated-user user-orange">hellman_</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/10/2016 07:06 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-288553" href="https://codeforces.com/blog/entry/18051?#comment-288553" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-288549" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="288553" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="288553" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="216097" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-288553">
                    <div class="moveup">
                    <div class="ttypography"><p>Those are equivalent. In the first case C treats <span class="tex-span"><i>t</i></span> as a pointer.</p><p>PS: in the second you would need to write <code class="tt">&amp;t[n+i]</code>, that's why the first one is easier.</p><p>PPS: C/C++ is very crazy, <code class="tt">3["abcd"]</code> works and is equivalent to <code class="tt">"abcd"[3]</code>, this is shit.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-288553 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-288553 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-288553">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="298501" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/AK_47_avi" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/AK_47_avi" title="Unrated, AK_47_avi" class="rated-user user-black">AK_47_avi</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/09/2016 01:00 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-298501" href="https://codeforces.com/blog/entry/18051?#comment-298501" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="298501" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="298501" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="329583" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-298501">
                    <div class="moveup">
                    <div class="ttypography"><p>i am unable to solve this question using the above implementation of segment tree. Can someone please provide me with a solution to this problem using this implementation. <a href="https://www.hackerearth.com/code-monk-segment-tree-and-lazy-propagation/algorithm/2-vs-3/">https://www.hackerearth.com/code-monk-segment-tree-and-lazy-propagation/algorithm/2-vs-3/</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-298501 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-298501 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-298501">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="313277" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/adarsh_1998" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/45efe638350f754e.jpg">        </a>
        <div><a href="https://codeforces.com/profile/adarsh_1998" title="Newbie adarsh_1998" class="rated-user user-gray">adarsh_1998</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Sep/02/2016 11:54 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-313277" href="https://codeforces.com/blog/entry/18051?#comment-313277" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="313277" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="313277" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="423557" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-313277">
                    <div class="moveup">
                    <div class="ttypography"><p>I'm having difficulty in this problem --&gt;<a href="http://www.spoj.com/problems/DQUERY/">http://www.spoj.com/problems/DQUERY/</a> the best i could think for a merge step is O(n) which would make my code run in O(n^2 log(n))+O(q*n*log(n)) definitely tle help me in improving my uppper bound; </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-313277 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-313277 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-313277">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="313631" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/hulk_baba" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/24d311fa2c62cc8a.jpg">        </a>
        <div><a href="https://codeforces.com/profile/hulk_baba" title="Pupil hulk_baba" class="rated-user user-green">hulk_baba</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Sep/06/2016 23:55 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-313631" href="https://codeforces.com/blog/entry/18051?#comment-313631" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="313631" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="313631" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="311895" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-313631">
                    <div class="moveup">
                    <div class="ttypography"><p>I want to update every element E in range L,R with =&gt; E = E/f(E); I tried hard but can't write lazy propagation for it. function is LeastPrimeDivisor(E) . Can anybody help me?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-313631 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-313631 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-313631">
            <li>
<div class="comment">
    <table class="comment-table" commentid="313885" commentparentid="313631">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/dam_sehgal" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/3a1321774be8f84d.jpg">        </a>
        <div><a href="https://codeforces.com/profile/dam_sehgal" title="Expert dam_sehgal" class="rated-user user-blue">dam_sehgal</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Sep/09/2016 06:42 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-313885" href="https://codeforces.com/blog/entry/18051?#comment-313885" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-313631" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="313885" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="313885" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="370603" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-313885">
                    <div class="moveup">
                    <div class="ttypography"><p>Don't answer this question as it belongs to live <a href="https://www.codechef.com/SEPT16/problems/DIVMAC">contest</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-313885 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-313885 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-313885">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="313704" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/suraj021" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/suraj021" title="Pupil suraj021" class="rated-user user-green">suraj021</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Sep/07/2016 20:20 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-313704" href="https://codeforces.com/blog/entry/18051?#comment-313704" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="313704" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="313704" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="266541" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-313704">
                    <div class="moveup">
                    <div class="ttypography"><p>Is lazy propagation always applicable for a segment tree problem ? Suppose we have to find the lcm of a given range, and there are range update operation of adding a number to the range. Is Lazy propagation applicable here?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-313704 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-313704 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-313704">
            <li>
<div class="comment">
    <table class="comment-table" commentid="313938" commentparentid="313704">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/aaaaajack" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/14b31530cbd28c6f.jpg">        </a>
        <div><a href="https://codeforces.com/profile/aaaaajack" title="International Master aaaaajack" class="rated-user user-orange">aaaaajack</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Sep/09/2016 22:33 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-313938" href="https://codeforces.com/blog/entry/18051?#comment-313938" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-313704" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="313938" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="313938" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="149435" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-313938">
                    <div class="moveup">
                    <div class="ttypography"><p>No. You should know how to fix the answer without knowing the exact elements in that range.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-313938 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-313938 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-313938">
            <li>
<div class="comment">
    <table class="comment-table" commentid="313951" commentparentid="313938">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/suraj021" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/suraj021" title="Pupil suraj021" class="rated-user user-green">suraj021</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Sep/10/2016 01:06 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-313951" href="https://codeforces.com/blog/entry/18051?#comment-313951" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-313938" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="313951" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="313951" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="266541" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-313951">
                    <div class="moveup">
                    <div class="ttypography"><p>How do I optimize solution to such problems then? It will TLE for range updates ( no lazy ) for N &lt;= 10^6. </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-313951 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-313951 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-313951">
            <li>
<div class="comment">
    <table class="comment-table" commentid="313961" commentparentid="313951">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/aaaaajack" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/14b31530cbd28c6f.jpg">        </a>
        <div><a href="https://codeforces.com/profile/aaaaajack" title="International Master aaaaajack" class="rated-user user-orange">aaaaajack</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Sep/10/2016 02:24 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-313961" href="https://codeforces.com/blog/entry/18051?#comment-313961" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-313951" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="313961" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="313961" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="149435" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-313961">
                    <div class="moveup">
                    <div class="ttypography"><p>Can you provide the link or the full problem statement?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-313961 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-313961 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-313961">
            <li>
<div class="comment">
    <table class="comment-table" commentid="314022" commentparentid="313961">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/suraj021" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/suraj021" title="Pupil suraj021" class="rated-user user-green">suraj021</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Sep/10/2016 20:49 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-314022" href="https://codeforces.com/blog/entry/18051?#comment-314022" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-313961" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="314022" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="314022" class="CommentVoteFrame" data-commentrating="10" data-commentuserid="266541" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+10</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-314022">
                    <div class="moveup">
                    <div class="ttypography"><p>I would but there is a similar problem in a live running contest, where I have to make range updates to a similar problem. I think i should discuss after the contest ends.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-314022 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-314022 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-314022">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="316291" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/skavurskaa" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/8978f33b043b4b3d.jpg">        </a>
        <div><a href="https://codeforces.com/profile/skavurskaa" title="Candidate Master skavurskaa" class="rated-user user-violet">skavurskaa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Sep/23/2016 05:04 UTC+7">8 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-316291" href="https://codeforces.com/blog/entry/18051?#comment-316291" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="316291" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="316291" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="356953" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-316291">
                    <div class="moveup">
                    <div class="ttypography"><p>Could you please explain the theory behind the first query function? I get how it works but i don't know how to prove it is always correct. I am doing a dissertation on range queries and i am writing about iterative and recursive segment trees, but i have to prove why these functions are correct and i'm struggling right now.</p><p>Thanks in advance.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-316291 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-316291 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-316291">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="324993" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/shahidul_brur" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/eee6cef2315f0e62.jpg">        </a>
        <div><a href="https://codeforces.com/profile/shahidul_brur" title="Newbie shahidul_brur" class="rated-user user-gray">shahidul_brur</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Nov/13/2016 22:31 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-324993" href="https://codeforces.com/blog/entry/18051?#comment-324993" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="324993" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="324993" revisioncount="3" revision="3">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">3</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="324993" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="334688" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-324993">
                    <div class="moveup">
                    <div class="ttypography"><p>Under "Modification on interval, single element access", in the query function, why we need to sum up the res? We are asked to give the ans 'What is the value at position p?'. We need to reply a single value, why we are summing multiple values in res?</p> <pre><code class="prettyprint prettyprinted" style=""><span class="com">//didn't get this part</span><span class="pln">
 </span><span class="kwd">int</span><span class="pln"> query</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> p </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> p </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> res </span><span class="pun">+=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>I didn't understand. Can anyone please explain me?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-324993 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-324993 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-324993">
            <li>
<div class="comment">
    <table class="comment-table" commentid="374657" commentparentid="324993">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Mahilewets" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Mahilewets" title="Specialist Mahilewets" class="rated-user user-cyan">Mahilewets</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/24/2017 16:23 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-374657" href="https://codeforces.com/blog/entry/18051?#comment-374657" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-324993" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="374657" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="374657" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="374657" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="366621" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-374657">
                    <div class="moveup">
                    <div class="ttypography"><p>That is something like lazy propagation. </p><p>For every segment, we have memorized, which value we have added for all elements belong to that segment. </p><p>If we just take tree[leaf], we would get <strong>initial</strong> value. </p><p>To get actual value we should apply all those modifications.</p><p>That means we should add all those modification flags belong to segments contain that particular element. </p><p>Look at recursive implementation of range add. </p><p>We return TREE[vertex] + answer for corresponding child segment.</p><p>In the iterative implementation, we are doing <strong>absolutely</strong> the same thing and we are doing it just in the reverse order. </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-374657 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-374657 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-374657">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="325571" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/saimor" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/77c02fbc988cfaea.jpg">        </a>
        <div><a href="https://codeforces.com/profile/saimor" title="Newbie saimor" class="rated-user user-gray">saimor</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Nov/17/2016 16:36 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-325571" href="https://codeforces.com/blog/entry/18051?#comment-325571" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="325571" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="325571" revisioncount="4" revision="4">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">4</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="325571" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="248108" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-325571">
                    <div class="moveup">
                    <div class="ttypography"><p><strong>is it always give the right answer ??</strong></p><p>int query(int l, int r) { // sum on interval [l, r)</p><p>int res = 0;</p><p>for (l += n, r += n; l &lt; r; l &gt;&gt;= 1, r &gt;&gt;= 1) {</p> <pre>if (l&amp;1) res += t[l++];

if (r&amp;1) res += t[--r];</pre><p>}</p><p>return res;</p><p>}</p><p>suppos int array[]={154,382,574,938,827,923,949,748,806,78};</p><p>if we build segment tree it will look like this t[1]=6379,t[2]=3117,t[3]=3262,t[4]=2581,t[5]=536,t[6]=1512,t[7]=1750,t[8]=1697,t[9]=884,t[10]=154,t[11]=382,t[12]=574,t[13]=938,t[14]=827,t[15]=923,t[16]=949,t[17]=748,t[18]=806,t[19]=78;</p><p>int query(5,8);</p><p>answer should be 3426.</p><p>but it gives 2620</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-325571 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-325571 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-325571">
            <li>
<div class="comment">
    <table class="comment-table" commentid="325573" commentparentid="325571">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/KADR" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/9089397f80c0fe42.jpg"><img title="Badge of honor for supporting Codeforces on its 10th anniversary" src="./Efficient and easy segment trees - Codeforces_files/if_medal-bronze-blue_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/KADR" title="Master KADR" class="rated-user user-orange">KADR</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Nov/17/2016 17:19 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-325573" href="https://codeforces.com/blog/entry/18051?#comment-325573" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-325571" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="325573" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="325573" class="CommentVoteFrame" data-commentrating="5" data-commentuserid="1028" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-325573">
                    <div class="moveup">
                    <div class="ttypography"><p>Right end should not be included into the sum.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-325573 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-325573 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-325573">
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="327200" commentparentid="325571">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/nurlansofiyev" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/c7bf115ff83c3eab.jpg">        </a>
        <div><a href="https://codeforces.com/profile/nurlansofiyev" title="Specialist nurlansofiyev" class="rated-user user-cyan">nurlansofiyev</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Nov/28/2016 02:29 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-327200" href="https://codeforces.com/blog/entry/18051?#comment-327200" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-325571" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="327200" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="327200" revisioncount="4" revision="4">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">4</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="327200" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="423612" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-327200">
                    <div class="moveup">
                    <div class="ttypography"><p>fucntion query(int l, int r) calculate sum of [l,r); it means if you want to calc sum of [5,8] you must call query(5,9). if you want your function calculate interval [l,r] you must implement by this way :</p><p>int sum_f(int l, int r ) {</p><p>int sum = 0;</p><p>l += n, r += n; </p><p>while (l &lt;= r)</p><p>{</p> <pre>if (l &amp; 1) sum += v[l] ;
if (!(r &amp; 1)) sum += v[r] ;
l = (l + 1) / 2, r = (r - 1) / 2;</pre><p>} </p><p>return sum;</p><p>}</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-327200 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-327200 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-327200">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="325601" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/sheep0x" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/sheep0x" title="Expert sheep0x" class="rated-user user-blue">sheep0x</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Nov/17/2016 21:29 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-325601" href="https://codeforces.com/blog/entry/18051?#comment-325601" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="325601" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="325601" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="333620" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-325601">
                    <div class="moveup">
                    <div class="ttypography"><p>For the sake of breaking language barrier, this bottom-up implementation is called “zkw segment tree” in China, because it was (supposedly) independently discovered by Zhang Kunwei in his famous paper. Not sure who was the earliest inventor though.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-325601 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-325601 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-325601">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="329074" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/haleyk100198" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/f2d97d505af17e9d.jpg">        </a>
        <div><a href="https://codeforces.com/profile/haleyk100198" title="Candidate Master haleyk100198" class="rated-user user-violet">haleyk100198</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/06/2016 02:35 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-329074" href="https://codeforces.com/blog/entry/18051?#comment-329074" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="329074" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="329074" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="416324" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-329074">
                    <div class="moveup">
                    <div class="ttypography"><p>Is there a way that we could do better for non-commutative segment trees? For this implementation sometimes node are just not being used, as extra merging were done. (eg: for size 13 in the example shown, we merged 2 and 3 even though it is meaningless)</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-329074 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-329074 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-329074">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="332441" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/sunghoo" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/sunghoo" title="Candidate Master sunghoo" class="rated-user user-violet">sunghoo</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/22/2016 01:24 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-332441" href="https://codeforces.com/blog/entry/18051?#comment-332441" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="332441" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="332441" revisioncount="7" revision="7">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">7</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="332441" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="245784" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-332441">
                    <div class="moveup">
                    <div class="ttypography"><p>I just wonder if i could make arbitrary size of array to some nearest power of 2 if i put useless values which don't affect to final result of each query to the rest of indices? For example, making a size of array from 13 to 16, or 29 to 32 and putting -inf for the additional indices in a max-segtree(or 0 in a sum-segtree)</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-332441 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-332441 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-332441">
            <li>
<div class="comment">
    <table class="comment-table" commentid="332443" commentparentid="332441">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/haleyk100198" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/f2d97d505af17e9d.jpg">        </a>
        <div><a href="https://codeforces.com/profile/haleyk100198" title="Candidate Master haleyk100198" class="rated-user user-violet">haleyk100198</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/22/2016 01:47 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-332443" href="https://codeforces.com/blog/entry/18051?#comment-332443" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-332441" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="332443" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="332443" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="416324" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-332443">
                    <div class="moveup">
                    <div class="ttypography"><p>Sure you can.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-332443 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-332443 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-332443">
            <li>
<div class="comment">
    <table class="comment-table" commentid="332450" commentparentid="332443">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/sunghoo" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/sunghoo" title="Candidate Master sunghoo" class="rated-user user-violet">sunghoo</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/22/2016 03:19 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-332450" href="https://codeforces.com/blog/entry/18051?#comment-332450" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-332443" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="332450" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="332450" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="245784" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-332450">
                    <div class="moveup">
                    <div class="ttypography"><p>thank you for your reply. But I'm just wondering how people usually implement codes for range operation. For example, fenwick tree with lazy propagation for some situation or non-recursive segment tree(like this article) or recursive segment tree. Which one is the most simple for specific situation? I just heard that it is easier to implement segment tree with lazy propagation with recursive way. So I just wanna know.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-332450 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-332450 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-332450">
            <li>
<div class="comment">
    <table class="comment-table" commentid="332482" commentparentid="332450">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Bassel" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/3ad3325c8d8f53cb.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Bassel" title="Expert Bassel" class="rated-user user-blue">Bassel</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/22/2016 12:10 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-332482" href="https://codeforces.com/blog/entry/18051?#comment-332482" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-332450" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="332482" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="332482" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="348167" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-332482">
                    <div class="moveup">
                    <div class="ttypography"><p>Implementing lazy propagation in recursive way is much easier yet less efficient than iterative approach</p><p>I would go with Fenwick Tree if it's sum/xor or something similar and with iterative segment tree otherwise unless the update function is hard to implement and debug in time</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-332482 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-332482 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-332482">
            <li>
<div class="comment">
    <table class="comment-table" commentid="332483" commentparentid="332482">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/sunghoo" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/sunghoo" title="Candidate Master sunghoo" class="rated-user user-violet">sunghoo</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/22/2016 12:50 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-332483" href="https://codeforces.com/blog/entry/18051?#comment-332483" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-332482" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="332483" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="332483" revisioncount="3" revision="3">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">3</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="332483" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="245784" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-332483">
                    <div class="moveup">
                    <div class="ttypography"><p>So you would go Fenwick Tree whenever you have to do range sum/xor stuff even if you need lazy propagation and would go iterative segtree if there is no need of lazy propagation or complicated stuff in operations except for sum/xor and recursive way for the others, right?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-332483 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-332483 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-332483">
            <li>
<div class="comment">
    <table class="comment-table" commentid="332484" commentparentid="332483">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Bassel" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/3ad3325c8d8f53cb.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Bassel" title="Expert Bassel" class="rated-user user-blue">Bassel</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/22/2016 13:08 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-332484" href="https://codeforces.com/blog/entry/18051?#comment-332484" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-332483" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="332484" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="332484" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="332484" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="348167" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-332484">
                    <div class="moveup">
                    <div class="ttypography"><p>Right :D</p><p>There is also a trick to do both range queries and lazy range updates with Fenwick tree <a href="https://codeforces.com/blog/entry/45585#comment-301662">here</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-332484 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-332484 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-332484">
            <li>
<div class="comment">
    <table class="comment-table" commentid="348798" commentparentid="332484">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Dpman" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Dpman" title="Pupil Dpman" class="rated-user user-green">Dpman</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/15/2017 16:03 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-348798" href="https://codeforces.com/blog/entry/18051?#comment-348798" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-332484" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="348798" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="348798" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="227844" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-348798">
                    <div class="moveup">
                    <div class="ttypography"><p>Can you explain how does it handle both of them more clearly?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-348798 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-348798 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-348798">
            <li>
<div class="comment">
    <table class="comment-table" commentid="350142" commentparentid="348798">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Rezwan.Arefin01" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/68ec3668b1ccc552.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Rezwan.Arefin01" title="Candidate Master Rezwan.Arefin01" class="rated-user user-violet">Rezwan.Arefin01</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/21/2017 18:34 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-350142" href="https://codeforces.com/blog/entry/18051?#comment-350142" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-348798" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="350142" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="350142" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="358701" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-350142">
                    <div class="moveup">
                    <div class="ttypography"><p>Here is a good explanation — <a href="http://www.geeksforgeeks.org/binary-indexed-tree-range-update-range-queries/">GeeskForGeeks — Binary Indexed Tree : Range Update and Range Queries</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-350142 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-350142 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-350142">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="337941" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/xsc" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/9eaf243b1eb8c3d4.jpg">        </a>
        <div><a href="https://codeforces.com/profile/xsc" title="Specialist xsc" class="rated-user user-cyan">xsc</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/17/2017 23:29 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-337941" href="https://codeforces.com/blog/entry/18051?#comment-337941" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="337941" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="337941" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="343" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-337941">
                    <div class="moveup">
                    <div class="ttypography"><p>How to find index of segment tree by given sum. example <a href="http://acm.timus.ru/problem.aspx?space=1&amp;num=1896">acm.timus.ru 1896 </a> </p> <pre><code class="prettyprint prettyprinted" style=""><span class="com">// Following code Gives WA38. How to fix it ??</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1.1E+6</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> tree</span><span class="pun">[</span><span class="pln">N </span><span class="pun">+</span><span class="pln"> N</span><span class="pun">];</span><span class="pln"> </span><span class="com">//  tree[ n .. n + n ] = only 0 or 1</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> find_index</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> sum</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
   </span><span class="kwd">int</span><span class="pln"> r </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> 
  </span><span class="kwd">for</span><span class="pun">(</span><span class="pln">  </span><span class="pun">;</span><span class="pln"> r </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> r </span><span class="pun">&lt;&lt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln"> tree</span><span class="pun">[</span><span class="pln">r</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> sum </span><span class="pun">)</span><span class="pln"> sum</span><span class="pun">-=</span><span class="pln"> tree</span><span class="pun">[</span><span class="pln">r </span><span class="pun">++</span><span class="pln"> </span><span class="pun">]</span><span class="pln"> </span><span class="pun">;</span><span class="pln">
   </span><span class="kwd">return</span><span class="pln"> r </span><span class="pun">-</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> 
</span><span class="pun">}</span></code></pre></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-337941 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-337941 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-337941">
            <li>
<div class="comment">
    <table class="comment-table" commentid="337942" commentparentid="337941">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/xsc" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/9eaf243b1eb8c3d4.jpg">        </a>
        <div><a href="https://codeforces.com/profile/xsc" title="Specialist xsc" class="rated-user user-cyan">xsc</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/17/2017 23:30 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-337942" href="https://codeforces.com/blog/entry/18051?#comment-337942" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-337941" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="337942" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="337942" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="343" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-337942">
                    <div class="moveup">
                    <div class="ttypography"><p>I mean, need find that i, which query(0,i) == sum.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-337942 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-337942 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-337942">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="341490" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/kanchicoder" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/kanchicoder" title="Newbie kanchicoder" class="rated-user user-gray">kanchicoder</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/04/2017 14:01 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-341490" href="https://codeforces.com/blog/entry/18051?#comment-341490" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="341490" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="341490" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="439469" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-341490">
                    <div class="moveup">
                    <div class="ttypography"><p>What's wrong for <strong>Sum of given Range</strong> </p> <pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
ll t</span><span class="pun">[(</span><span class="kwd">int</span><span class="pun">)</span><span class="lit">2e6</span><span class="pun">+</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> d</span><span class="pun">[(</span><span class="kwd">int</span><span class="pun">)</span><span class="lit">1e6</span><span class="pun">+</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
ll h</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> apply</span><span class="pun">(</span><span class="pln">ll i</span><span class="pun">,</span><span class="pln"> ll v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> v</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> v</span><span class="pun">;</span><span class="pln">	
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> build</span><span class="pun">(</span><span class="pln">ll i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	ll p</span><span class="pun">,</span><span class="pln"> count</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">i </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		i </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		p </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
		count </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">while</span><span class="pun">((</span><span class="pln">p </span><span class="pun">&lt;&lt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">*</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
			count</span><span class="pun">++;</span><span class="pln">
		t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">|</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]&lt;&lt;</span><span class="pln">count</span><span class="pun">);</span><span class="pln">  
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> push</span><span class="pun">(</span><span class="pln">ll i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">ll s </span><span class="pun">=</span><span class="pln"> h</span><span class="pun">;</span><span class="pln"> s </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> </span><span class="pun">--</span><span class="pln">s</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		ll p </span><span class="pun">=</span><span class="pln"> i </span><span class="pun">&gt;&gt;</span><span class="pln"> s</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">d</span><span class="pun">[</span><span class="pln">p</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			apply</span><span class="pun">(</span><span class="pln">p</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]);</span><span class="pln">
			apply</span><span class="pun">(</span><span class="pln">p</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">|</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]);</span><span class="pln">
			d</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> update</span><span class="pun">(</span><span class="pln">ll l</span><span class="pun">,</span><span class="pln"> ll r</span><span class="pun">,</span><span class="pln"> ll </span><span class="kwd">value</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  l </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
  ll l0 </span><span class="pun">=</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> r0 </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(;</span><span class="pln"> l </span><span class="pun">&lt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  	
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> apply</span><span class="pun">(</span><span class="pln">l</span><span class="pun">++,</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> apply</span><span class="pun">(--</span><span class="pln">r</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  build</span><span class="pun">(</span><span class="pln">l0</span><span class="pun">);</span><span class="pln">
  build</span><span class="pun">(</span><span class="pln">r0 </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

ll query</span><span class="pun">(</span><span class="pln">ll l</span><span class="pun">,</span><span class="pln"> ll r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  l </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
  push</span><span class="pun">(</span><span class="pln">l</span><span class="pun">);</span><span class="pln">
  push</span><span class="pun">(</span><span class="pln">r </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
  ll res </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(;</span><span class="pln"> l </span><span class="pun">&lt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> res </span><span class="pun">+=</span><span class="pln">  t</span><span class="pun">[</span><span class="pln">l</span><span class="pun">++];</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> res </span><span class="pun">+=</span><span class="pln">  t</span><span class="pun">[--</span><span class="pln">r</span><span class="pun">];</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="com">// your code goes here</span><span class="pln">
	ll te</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">,</span><span class="pln"> ch</span><span class="pun">,</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">;</span><span class="pln">
	cin </span><span class="pun">&gt;&gt;</span><span class="pln"> te</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">te</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">
		memset</span><span class="pun">(</span><span class="pln">t</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">sizeof</span><span class="pun">(</span><span class="pln">t</span><span class="pun">));</span><span class="pln">
		memset</span><span class="pun">(</span><span class="pln">d</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">sizeof</span><span class="pun">(</span><span class="pln">d</span><span class="pun">));</span><span class="pln">
		h </span><span class="pun">=</span><span class="pln"> </span><span class="lit">64</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> __builtin_clzll</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">m</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			cin </span><span class="pun">&gt;&gt;</span><span class="pln"> ch</span><span class="pun">;</span><span class="pln">		
			</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">ch</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
				cin </span><span class="pun">&gt;&gt;</span><span class="pln"> l </span><span class="pun">&gt;&gt;</span><span class="pln"> r </span><span class="pun">&gt;&gt;</span><span class="pln"> v</span><span class="pun">;</span><span class="pln">
				update</span><span class="pun">(--</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">);</span><span class="pln">
				</span><span class="kwd">print</span><span class="pun">();</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
				cin </span><span class="pun">&gt;&gt;</span><span class="pln"> l </span><span class="pun">&gt;&gt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">			
				cout </span><span class="pun">&lt;&lt;</span><span class="pln"> query</span><span class="pun">(--</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">print</span><span class="pun">();</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-341490 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-341490 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-341490">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="342833" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/hunter1703" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/hunter1703" title="Expert hunter1703" class="rated-user user-blue">hunter1703</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/12/2017 06:05 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-342833" href="https://codeforces.com/blog/entry/18051?#comment-342833" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="342833" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="342833" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="503188" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-342833">
                    <div class="moveup">
                    <div class="ttypography"><p>Please, can someone explain apply and build functions in lazy propagation in max queries...?? Really need help there. </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-342833 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-342833 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-342833">
            <li>
<div class="comment">
    <table class="comment-table" commentid="342838" commentparentid="342833">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/xsc" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/9eaf243b1eb8c3d4.jpg">        </a>
        <div><a href="https://codeforces.com/profile/xsc" title="Specialist xsc" class="rated-user user-cyan">xsc</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/12/2017 09:25 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-342838" href="https://codeforces.com/blog/entry/18051?#comment-342838" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-342833" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="342838" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="342838" class="CommentVoteFrame" data-commentrating="3" data-commentuserid="343" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-342838">
                    <div class="moveup">
                    <div class="ttypography"><p>Some theory: initial: we have array a[0...n-1] — initial array.  t[ 0 ... n + n ] — segment tree array.  d[0...n + n ] — lazy propogation array.  d[i] = 0 (i=0..n+n-1) initially.</p><p>1) t[ i + n ] == a[i], if 0 &lt;= i &lt; n. So if a[i] increments a <code class="tt">value</code>, t[i+n] also increments the <code class="tt">value</code>.</p><p>2) t[i] = max(t[i * 2] , t[i * 2 + 1]) , if 0&lt;= i &lt; n. we call t[i] as i-th root of segment tree, because, t[i] = max{ a[ i * 2^k + h — n ], where i*2^k &gt;=n, and 0&lt;=h&lt;2^k }  for example, n = 8. so t[3] = max{ a[3*4 — 8], a[3*4 + 1 — 8], a[3*4+2 — 8], a[3*4+3-8]} = max{ a[4], a[5], a[6], a[7] } </p><p>3) d[i] = 0, if there not increment operation in the i-th root. d[i] &gt; 0, need increment  all of t[i*2^k + h] element by d[i]. see below.</p><p>4) if t[i*2] and t[i*2+1] — incremented same <code class="tt">value</code> so, t[i] — maximum of t[i*2] , t[i*2+1] also incremented to <code class="tt">value</code>. It's applied recursive.</p><p>5). if need increment i-th root to <code class="tt">value</code>, by standard algorithm need increment t[i], t[i*2], t[i*2+1], t[i*4], t[i*4+1], t[i*4+2], t[i*4+3], ...., t[i*2^k+h] nodes to <code class="tt">value.     but, with lazy propogation, all these operations absent.     Need only increment t[i] and   d[i] to</code>value`. d[i] &gt; 0 means, t[i*2^k+h] values will incremented some later.</p> <pre><code class="prettyprint prettyprinted" style=""><br><span class="pln">   </span><span class="typ">For</span><span class="pln"> example</span><span class="pun">,</span><span class="pln"> n </span><span class="pun">=</span><span class="pln"> </span><span class="lit">8.</span><span class="pln"> a</span><span class="pun">[]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">4</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">}</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> need increment a</span><span class="pun">[</span><span class="lit">4.</span><span class="pun">.</span><span class="lit">7</span><span class="pun">]</span><span class="pln"> elements to </span><span class="lit">5.</span><span class="pln">
   t</span><span class="pun">[</span><span class="lit">8.</span><span class="pun">.</span><span class="lit">15</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">0.</span><span class="pun">.</span><span class="lit">7</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">4</span><span class="pun">,</span><span class="pln">   </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln">   </span><span class="lit">8</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">   </span><span class="lit">5</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
   t</span><span class="pun">[</span><span class="lit">4.</span><span class="pun">.</span><span class="lit">7</span><span class="pln"> </span><span class="pun">]</span><span class="pln">             </span><span class="pun">{</span><span class="pln">   </span><span class="lit">4</span><span class="pln">       </span><span class="lit">1</span><span class="pln">       </span><span class="lit">8</span><span class="pln">       </span><span class="lit">5</span><span class="pln">  </span><span class="pun">}</span><span class="pln">
   t</span><span class="pun">[</span><span class="lit">2.</span><span class="pun">.</span><span class="pln"> </span><span class="lit">3</span><span class="pun">]</span><span class="pln">             </span><span class="pun">{</span><span class="pln">        </span><span class="lit">4</span><span class="pln">           </span><span class="pun">(</span><span class="lit">8</span><span class="pun">+</span><span class="lit">5</span><span class="pln"> d</span><span class="pun">:</span><span class="lit">5</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
   t</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln">                 </span><span class="pun">{</span><span class="pln">               </span><span class="lit">8</span><span class="pln">              </span><span class="pun">}</span><span class="pln">
   a</span><span class="pun">[</span><span class="lit">4</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==&gt;</span><span class="pln"> t</span><span class="pun">[</span><span class="lit">4</span><span class="pun">+</span><span class="lit">8</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> t</span><span class="pun">[</span><span class="lit">12</span><span class="pun">],</span><span class="pln"> so need increment t</span><span class="pun">[</span><span class="lit">12</span><span class="pun">],</span><span class="pln"> t</span><span class="pun">[</span><span class="lit">13</span><span class="pun">],</span><span class="pln"> t</span><span class="pun">[</span><span class="lit">14</span><span class="pun">],</span><span class="pln"> t</span><span class="pun">[</span><span class="lit">15</span><span class="pun">]</span><span class="pln"> to </span><span class="lit">5</span><span class="pun">,</span><span class="pln"> also need increment  t</span><span class="pun">[</span><span class="lit">6</span><span class="pun">]</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> because t</span><span class="pun">[</span><span class="lit">6</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="lit">12</span><span class="pun">],</span><span class="pln"> t</span><span class="pun">[</span><span class="lit">13</span><span class="pun">]),</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> need increment t</span><span class="pun">[</span><span class="lit">7</span><span class="pun">],</span><span class="pln"> t</span><span class="pun">[</span><span class="lit">7</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="lit">13</span><span class="pun">],</span><span class="pln"> t</span><span class="pun">[</span><span class="lit">14</span><span class="pun">]),</span><span class="pln"> at least need increment t</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> because t</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="lit">6</span><span class="pun">],</span><span class="pln"> t</span><span class="pun">[</span><span class="lit">7</span><span class="pun">]).</span><span class="pln"> total</span><span class="pun">:</span><span class="pln"> </span><span class="lit">7</span><span class="pln"> increments</span><span class="pun">.</span><span class="pln">
   but </span><span class="kwd">with</span><span class="pln"> lazy propogation t</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> root </span><span class="kwd">of</span><span class="pln"> all t</span><span class="pun">[</span><span class="lit">6</span><span class="pun">],</span><span class="pln"> t</span><span class="pun">[</span><span class="lit">7</span><span class="pun">],</span><span class="pln"> t</span><span class="pun">[</span><span class="lit">12</span><span class="pun">],</span><span class="pln"> t</span><span class="pun">[</span><span class="lit">13</span><span class="pun">],</span><span class="pln"> t</span><span class="pun">[</span><span class="lit">14</span><span class="pun">],</span><span class="pln"> t</span><span class="pun">[</span><span class="lit">16</span><span class="pun">]</span><span class="pln">  nodes</span><span class="pun">.</span><span class="pln"> so need increment only   t</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]</span><span class="pln">  to </span><span class="lit">5</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> increment d</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> to </span><span class="lit">5.</span><span class="pln"> </span><span class="kwd">this</span><span class="pln"> operation </span><span class="kwd">is</span><span class="pln"> </span><span class="str">`apply`</span><span class="pun">.</span><span class="pln">
    
but after </span><span class="str">`apply`</span><span class="pln"> increment operation</span><span class="pun">,</span><span class="pln">  t</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> become incorrect </span><span class="kwd">value</span><span class="pun">,</span><span class="pln"> it should be max</span><span class="pun">(</span><span class="lit">4</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8</span><span class="pun">+</span><span class="lit">5</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">13.</span><span class="pln">  </span><span class="pun">--</span><span class="pln"> </span><span class="kwd">this</span><span class="pln"> </span><span class="kwd">is</span><span class="pln"> </span><span class="str">`build`</span><span class="pln"> operation</span><span class="pun">.</span></code></pre><p>GoOd LuCk.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-342838 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-342838 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-342838">
            <li>
<div class="comment">
    <table class="comment-table" commentid="342860" commentparentid="342838">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/hunter1703" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/hunter1703" title="Expert hunter1703" class="rated-user user-blue">hunter1703</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/12/2017 17:45 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-342860" href="https://codeforces.com/blog/entry/18051?#comment-342860" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-342838" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="342860" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="342860" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="503188" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-342860">
                    <div class="moveup">
                    <div class="ttypography"><p>Thank you very much...... Such a great help.... I was really stuck there.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-342860 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-342860 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-342860">
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="342865" commentparentid="342838">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/hunter1703" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/hunter1703" title="Expert hunter1703" class="rated-user user-blue">hunter1703</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/12/2017 18:26 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-342865" href="https://codeforces.com/blog/entry/18051?#comment-342865" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-342838" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="342865" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="342865" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="503188" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-342865">
                    <div class="moveup">
                    <div class="ttypography"><p>Thanks for yur help. Can you tell how build and push works in sum queries (It says new build and push methods incorporated both types of build and push methods mentioned before). I can't seem to get it. Also why does both calc and apply update t[p]. NO understanding these both methods...</p><p>By compacting the code (by author), code longer is simple in understanding although it is simple in implementing....</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-342865 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-342865 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-342865">
            <li>
<div class="comment">
    <table class="comment-table" commentid="342867" commentparentid="342865">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/xsc" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/9eaf243b1eb8c3d4.jpg">        </a>
        <div><a href="https://codeforces.com/profile/xsc" title="Specialist xsc" class="rated-user user-cyan">xsc</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/12/2017 18:38 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-342867" href="https://codeforces.com/blog/entry/18051?#comment-342867" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-342865" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="342867" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="342867" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="343" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-342867">
                    <div class="moveup">
                    <div class="ttypography"><p>Which : </p><p>1) update: Assignment in range, and query: sum in range ??? OR</p><p>2) update: Increment in range, and query : sum in range ?? </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-342867 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-342867 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-342867">
            <li>
<div class="comment">
    <table class="comment-table" commentid="342881" commentparentid="342867">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/hunter_17" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/hunter_17" title="Expert hunter_17" class="rated-user user-blue">hunter_17</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/12/2017 23:02 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-342881" href="https://codeforces.com/blog/entry/18051?#comment-342881" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-342867" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="342881" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="342881" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="440312" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-342881">
                    <div class="moveup">
                    <div class="ttypography"><p>increment in range query.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-342881 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-342881 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-342881">
            <li>
<div class="comment">
    <table class="comment-table" commentid="342885" commentparentid="342881">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/xsc" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/9eaf243b1eb8c3d4.jpg">        </a>
        <div><a href="https://codeforces.com/profile/xsc" title="Specialist xsc" class="rated-user user-cyan">xsc</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/12/2017 23:56 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-342885" href="https://codeforces.com/blog/entry/18051?#comment-342885" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-342881" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="342885" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="342885" class="CommentVoteFrame" data-commentrating="8" data-commentuserid="343" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+8</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-342885">
                    <div class="moveup">
                    <div class="ttypography"><p>This entry explains for Assigment in range, sum in range — and it is difficult than increment operation.</p><p>But, If you want increment in range, it simple than assignment.</p><p>Let Theory, again; 1&lt;=n&lt;=N ~ 10^5. a[0], a[1], ... , a[n-1] — given array. Need apply two operations: </p> <ol>   <li><p>increment a[L], a[L+1],... a[R-1] to <code class="tt">value</code>, i.e [L..R) range.</p></li>   <li><p>find sum a[L] + a[L+1] + ... + a[R-1] , i.e. [L..R) range.</p></li> </ol><p>t[0..n+n] — segment tree array.  d[0..n+n] — lazy propogation.</p><p>where</p><p>t[i] = a[ i — n], n&lt;=i &lt; n+n. and </p><p>t[i] = t[i*2] + t[i*2+1], for 0&lt;=i&lt;n.</p> <ol>   <li><p>If a[i] incremented by <code class="tt">value</code>, so t[i+n] also incremented by <code class="tt">value</code>.</p></li>   <li><p>if t[i*2] and t[i*2+1] incremented by <code class="tt">value</code>, they root t[i] incremented <code class="tt">2* value</code>. and its applied recursive down. </p></li> </ol><p>In general, if all <code class="tt">leaf</code> nodes of i-th root incremented by <code class="tt">value</code>, so t[i] should increment the <code class="tt">value</code> multiply number of <code class="tt">leaf</code> children of i-th root.</p><p>for example: n = 8. if a[4] , a[5], a[6], a[7] increment by 5, so t[12], t[13], t[14], t[15] incremented by 1*5,  t[6], and t[7] — incremented by 2*5, and  t[3] incremented by 4*5. t[3] — has 4 children.</p> <ol>   <li>Now, about lazy propogation d[] array. d[ i ] == 0, means there no increment operation i-th root. d[i] &gt; 0, means all <code class="tt">leaf</code> nodes from i-th root of segment tree will increment by d[i], and applied 2.step operation recursivily.</li> </ol> <pre>If we need increment [L..R)  range by `value` , need increment only root nodes by  `value` * children(i), and d[i] increments by `value`.  Other nodes will calculated some later.</pre><p>For example: if need increment a[4..7] to 5.  There only increment t[3] to 5*4, and put d[3] = 5. This <code class="tt">apply</code> operation.  Other nodes t[6], t[7], t[12], t[13], t[14], t[15] nodes will incremented some later (may never). </p> <pre><code class="prettyprint prettyprinted" style=""><span class="com">#define</span><span class="pln"> N </span><span class="lit">100008</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">N</span><span class="pun">+</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">N</span><span class="pun">+</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
</span><span class="com">//int ch[N+N]; // number of children .</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> apply </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> children</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    t</span><span class="pun">[</span><span class="pln"> p </span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="kwd">value</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> children</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p </span><span class="pun">&lt;</span><span class="pln"> n </span><span class="pun">)</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">.</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> build</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">)</span><span class="pln"> </span><span class="com">// fixes applied nodes and down nodes.</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> children </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
     </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
     </span><span class="pun">{</span><span class="pln">
           p </span><span class="pun">=</span><span class="pln"> p  </span><span class="pun">/</span><span class="pln">  </span><span class="lit">2</span><span class="pln"> </span><span class="pun">;</span><span class="pln">
           children </span><span class="pun">=</span><span class="pln"> children </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
           t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln"> p </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> t</span><span class="pun">[</span><span class="pln"> p </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> d</span><span class="pun">[</span><span class="pln"> p </span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> children</span><span class="pun">;</span><span class="pln">
     </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> push</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">)</span><span class="pln"> </span><span class="com">// calculate lazy operations from p nodes.</span><span class="pln">
</span><span class="pun">{</span><span class="pln">  </span><span class="com">// h = log2(n).</span><span class="pln">
     </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> s </span><span class="pun">=</span><span class="pln"> h </span><span class="pun">;</span><span class="pln"> s </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> </span><span class="pun">--</span><span class="pln">s</span><span class="pun">)</span><span class="pln">
     </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> p </span><span class="pun">&gt;&gt;</span><span class="pln"> s</span><span class="pun">;</span><span class="pln"> </span><span class="com">// i = p / 2^s</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">)</span><span class="pln">
            </span><span class="pun">{</span><span class="pln">
 </span><span class="com">// so i*2 and i*2+1 nodes will increase by</span><span class="pln">
</span><span class="com">//  d[i] * children,  where children = 2^(s-1)</span><span class="pln">
                   </span><span class="kwd">int</span><span class="pln"> children </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
                   apply</span><span class="pun">(</span><span class="pln">i</span><span class="pun">*</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> children</span><span class="pun">);</span><span class="pln">
                   apply</span><span class="pun">(</span><span class="pln">i</span><span class="pun">*</span><span class="lit">2</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> children</span><span class="pun">);</span><span class="pln">
             
              </span><span class="com">// now d[i] - is dont need no more, clear it.</span><span class="pln">
                  d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">        
            </span><span class="pun">}</span><span class="pln">
     </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">


</span><span class="kwd">int</span><span class="pln"> increment</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> L</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> R</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
     L </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> R </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> 
     </span><span class="kwd">int</span><span class="pln"> L0 </span><span class="pun">=</span><span class="pln"> L</span><span class="pun">,</span><span class="pln"> R0 </span><span class="pun">=</span><span class="pln"> R</span><span class="pun">;</span><span class="pln"> </span><span class="com">//presave they.</span><span class="pln">
</span><span class="kwd">for</span><span class="pun">(</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> children </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> L </span><span class="pun">&lt;</span><span class="pln"> R </span><span class="pun">;</span><span class="pln">  L</span><span class="pun">/=</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> R</span><span class="pun">/=</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> children </span><span class="pun">*=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln">
     </span><span class="pun">{</span><span class="pln">
           </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">L </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="com">// L - root node </span><span class="pln">
              apply</span><span class="pun">(</span><span class="pln">L</span><span class="pun">++,</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">,</span><span class="pln"> children</span><span class="pun">);</span><span class="pln">

           </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln"> R </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="com">// R - 1  root node</span><span class="pln">
              apply</span><span class="pun">(--</span><span class="pln">R</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">,</span><span class="pln"> children</span><span class="pun">);</span><span class="pln">
      </span><span class="pun">}</span><span class="pln">

    </span><span class="com">// now fix applied nodes and downsite nodes.</span><span class="pln">
     build</span><span class="pun">(</span><span class="pln">L0</span><span class="pun">);</span><span class="pln">
     build</span><span class="pun">(</span><span class="pln">R0</span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">


</span><span class="kwd">int</span><span class="pln"> sumRange</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> L</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> R</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
      </span><span class="com">// need calculate applied nodes from L and R.</span><span class="pln">
      L </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> R</span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
      push</span><span class="pun">(</span><span class="pln">L</span><span class="pun">);</span><span class="pln"> push</span><span class="pun">(</span><span class="pln">R</span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln"> </span><span class="com">// it clears all lazy d[] nodes.</span><span class="pln">
      </span><span class="kwd">int</span><span class="pln"> sum </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
      </span><span class="kwd">for</span><span class="pun">(</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> L </span><span class="pun">&lt;</span><span class="pln"> R</span><span class="pun">;</span><span class="pln"> L </span><span class="pun">/=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln"> R</span><span class="pun">/=</span><span class="lit">2</span><span class="pun">)</span><span class="pln">
      </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">L </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> sum </span><span class="pun">+=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">L</span><span class="pun">++];</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">R </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> sum </span><span class="pun">+=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln"> </span><span class="pun">--</span><span class="pln">R</span><span class="pun">];</span><span class="pln">
      </span><span class="pun">}</span><span class="pln">
     </span><span class="kwd">return</span><span class="pln"> sum</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-342885 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-342885 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-342885">
            <li>
<div class="comment">
    <table class="comment-table" commentid="342886" commentparentid="342885">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/hunter1703" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/hunter1703" title="Expert hunter1703" class="rated-user user-blue">hunter1703</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/13/2017 00:19 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-342886" href="https://codeforces.com/blog/entry/18051?#comment-342886" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-342885" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="342886" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="342886" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="503188" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-342886">
                    <div class="moveup">
                    <div class="ttypography"><p>You are great, man!!! Really. Very very much helpful</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-342886 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-342886 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-342886">
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="342887" commentparentid="342885">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/hunter1703" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/hunter1703" title="Expert hunter1703" class="rated-user user-blue">hunter1703</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/13/2017 00:21 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-342887" href="https://codeforces.com/blog/entry/18051?#comment-342887" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-342885" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="342887" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="342887" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="503188" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-342887">
                    <div class="moveup">
                    <div class="ttypography"><p>Last very silly question. What if n is not power of 2. Do we have to first increase n to the nearest power of 2 and fill values with zeroes or there is a way getting around it??</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-342887 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-342887 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-342887">
            <li>
<div class="comment">
    <table class="comment-table" commentid="342894" commentparentid="342887">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/xsc" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/9eaf243b1eb8c3d4.jpg">        </a>
        <div><a href="https://codeforces.com/profile/xsc" title="Specialist xsc" class="rated-user user-cyan">xsc</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/13/2017 01:42 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-342894" href="https://codeforces.com/blog/entry/18051?#comment-342894" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-342887" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="342894" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="342894" revisioncount="3" revision="3">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">3</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="342894" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="343" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-342894">
                    <div class="moveup">
                    <div class="ttypography"><p>Hmm, Did not test for n != 2^k . There may some bug when calculate children of i-th root, iff n != 2^k, be careful.</p><p>In competitive programming, I, always, use n = 2^k. </p><p>For example: </p> <div class="spoiler"><b class="spoiler-title">example</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="kwd">static</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">&lt;&lt;</span><span class="lit">17</span><span class="pun">;</span><span class="com">// easy to write, instead of 100000.</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">struct</span><span class="pln"> segment_tree
</span><span class="pun">{</span><span class="pln">
     ll t</span><span class="pun">[</span><span class="pln">N</span><span class="pun">+</span><span class="pln">N</span><span class="pun">],</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">N</span><span class="pun">+</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
     </span><span class="kwd">void</span><span class="pln"> apply</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> ll </span><span class="kwd">value</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> children</span><span class="pun">);</span><span class="pln">
     </span><span class="kwd">void</span><span class="pln"> build</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">);</span><span class="pln">
     </span><span class="kwd">void</span><span class="pln"> push</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">);</span><span class="pln">

     </span><span class="kwd">void</span><span class="pln"> increment</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> L</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> R</span><span class="pun">,</span><span class="pln"> ll </span><span class="kwd">value</span><span class="pun">)</span><span class="pln">
     </span><span class="pun">{</span><span class="pln">
         L </span><span class="pun">+=</span><span class="pln"> N</span><span class="pun">;</span><span class="pln"> </span><span class="com">// 2^17</span><span class="pln">
         R </span><span class="pun">+=</span><span class="pln"> N</span><span class="pun">;</span><span class="pln">
          
         push</span><span class="pun">(</span><span class="pln">L</span><span class="pun">);</span><span class="pln"> push</span><span class="pun">(</span><span class="pln">R</span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
         </span><span class="pun">.......</span><span class="pln">
     </span><span class="pun">}</span><span class="pln">

     ll sum</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> L</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> R</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
          L </span><span class="pun">+=</span><span class="pln"> N</span><span class="pun">;</span><span class="pln"> </span><span class="com">//2^17</span><span class="pln">
          R </span><span class="pun">+=</span><span class="pln"> N</span><span class="pun">;</span><span class="pln">
           </span><span class="pun">......</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="typ">Tree</span><span class="pun">;</span><span class="pln"> </span><span class="com">// segment_tree don't relative to real value of `n`.</span><span class="pln">



</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="com">// real n value, which n &lt; N.</span><span class="pln">
</span><span class="pun">......</span><span class="pln">

</span><span class="kwd">use</span><span class="pln"> </span><span class="typ">Tree</span><span class="pun">.</span></code></pre></div></div></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-342894 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-342894 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-342894">
            <li>
<div class="comment">
    <table class="comment-table" commentid="342968" commentparentid="342894">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/hunter1703" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/hunter1703" title="Expert hunter1703" class="rated-user user-blue">hunter1703</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/13/2017 17:12 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-342968" href="https://codeforces.com/blog/entry/18051?#comment-342968" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-342894" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="342968" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="342968" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="503188" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-342968">
                    <div class="moveup">
                    <div class="ttypography"><p>Thanks man for all your help. I was stuck here for very long time......</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-342968 en true" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-342968 en true" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-342968">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="342899" commentparentid="342887">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Al.Cash" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/dcbc95e9f176e573.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Al.Cash" title="Grandmaster Al.Cash" class="rated-user user-red">Al.Cash</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/13/2017 02:02 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-342899" href="https://codeforces.com/blog/entry/18051?#comment-342899" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-342887" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="342899" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="342899" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="14750" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-342899">
                    <div class="moveup">
                    <div class="ttypography"><p>All the codes in the article work for any n.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-342899 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-342899 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-342899">
            <li>
<div class="comment">
    <table class="comment-table" commentid="342967" commentparentid="342899">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/hunter1703" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/hunter1703" title="Expert hunter1703" class="rated-user user-blue">hunter1703</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/13/2017 17:11 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-342967" href="https://codeforces.com/blog/entry/18051?#comment-342967" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-342899" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="342967" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="342967" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="503188" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-342967">
                    <div class="moveup">
                    <div class="ttypography"><p>but for n!=2^n wouldn't there be one entry left which will have parent whose range will be 2 already and on adding this additional child its range become (2+1) ????</p><p>Thanks in advance</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-342967 en true" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-342967 en true" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-342967">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="344761" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/is-it-down" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/is-it-down" title="Unrated, is-it-down" class="rated-user user-black">is-it-down</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/21/2017 17:32 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-344761" href="https://codeforces.com/blog/entry/18051?#comment-344761" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="344761" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="344761" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="344761" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="509631" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-344761">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi everyone ... I was trying a 2D Segtree question <a href="https://uva.onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;category=637&amp;page=show_problem&amp;problem=2272">Census</a> I am getting stuck in the query function. Can someone tell me how to implement query using the method in the post. </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-344761 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-344761 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-344761">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="346084" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/avisheksanvas" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/avisheksanvas" title="Specialist avisheksanvas" class="rated-user user-cyan">avisheksanvas</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/26/2017 17:17 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-346084" href="https://codeforces.com/blog/entry/18051?#comment-346084" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="346084" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="346084" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="364597" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-346084">
                    <div class="moveup">
                    <div class="ttypography"><p>Could you explain how the query function for this question would be? <a href="https://codeforces.com/contest/380/problem/C" title="Codeforces Round 223 (Div. 1)">380C - Sereja and Brackets</a> I've done it with the recursive approach, but am not able to code the query function using this method. </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-346084 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-346084 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-346084">
            <li>
<div class="comment">
    <table class="comment-table" commentid="350109" commentparentid="346084">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/kunnu96" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/3f2f8ea70d77fdb1.jpg">        </a>
        <div><a href="https://codeforces.com/profile/kunnu96" title="Expert kunnu96" class="rated-user user-blue">kunnu96</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/21/2017 06:39 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-350109" href="https://codeforces.com/blog/entry/18051?#comment-350109" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-346084" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="350109" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="350109" class="CommentVoteFrame" data-commentrating="5" data-commentuserid="324946" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-350109">
                    <div class="moveup">
                    <div class="ttypography"><p>I too have encountered the same problem.<a href="http://www.spoj.com/problems/BRCKTS/">BRCKTS</a> is the easier version of <a href="https://codeforces.com/contest/380/problem/C"> 380C — Sereja and Brackets</a> but how to modify query function according to the problem as t[p&gt;&gt;1] = t[p] + t[p^1] logic will work for only all problems related with associative operations but here it is not.So I solved this problem by changing the logic to t[p]=combine(t[i &lt;&lt; 1], tree[i &lt;&lt; 1 | 1]) where p goes from (n+p)/2 to 1 in reverse for loop.Anyone has much more easier modification idea please share.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-350109 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-350109 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-350109">
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="350134" commentparentid="346084">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/CountZero" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/5d71cc3cc611312.jpg">        </a>
        <div><a href="https://codeforces.com/profile/CountZero" title="Expert CountZero" class="rated-user user-blue">CountZero</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/21/2017 16:34 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-350134" href="https://codeforces.com/blog/entry/18051?#comment-350134" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-346084" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="350134" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="350134" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="17812" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-350134">
                    <div class="moveup">
                    <div class="ttypography"><p>my incorrect solution of that problem: <a href="https://codeforces.com/contest/381/submission/5684965" title="Submission 5684965 by CountZero">5684965</a><br>how I fixed it: <a href="https://codeforces.com/contest/381/submission/5685269" title="Submission 5685269 by CountZero">5685269</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-350134 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-350134 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-350134">
            <li>
<div class="comment">
    <table class="comment-table" commentid="350141" commentparentid="350134">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/kunnu96" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/3f2f8ea70d77fdb1.jpg">        </a>
        <div><a href="https://codeforces.com/profile/kunnu96" title="Expert kunnu96" class="rated-user user-blue">kunnu96</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/21/2017 18:07 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-350141" href="https://codeforces.com/blog/entry/18051?#comment-350141" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-350134" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="350141" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="350141" class="CommentVoteFrame" data-commentrating="5" data-commentuserid="324946" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-350141">
                    <div class="moveup">
                    <div class="ttypography"><p>Actually in <a href="https://codeforces.com/contest/380/problem/C"> 380C — Sereja and Brackets</a> no update type of query is present so no need of modify function is there which will be easy to do with the above mentioned optimized segment tree implementation. Try this <a href="http://www.spoj.com/problems/BRCKTS/">BRCKTS</a> using the same modify function as mentioned by <a class="rated-user user-red" href="https://codeforces.com/profile/Al.Cash" title="Grandmaster Al.Cash">Al.Cash</a> you will realize it will not work in that way.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-350141 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-350141 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-350141">
            <li>
<div class="comment">
    <table class="comment-table" commentid="350143" commentparentid="350141">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/CountZero" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/5d71cc3cc611312.jpg">        </a>
        <div><a href="https://codeforces.com/profile/CountZero" title="Expert CountZero" class="rated-user user-blue">CountZero</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/21/2017 19:13 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-350143" href="https://codeforces.com/blog/entry/18051?#comment-350143" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-350141" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="350143" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="350143" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="17812" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-350143">
                    <div class="moveup">
                    <div class="ttypography"><p>there are at least 3 ways to solve this problem.<br>if memory is not an issue then you can just set array length to the power of 2<br>modify query function: <a href="https://codeforces.com/contest/400/submission/6026442" title="Submission 6026442 by Urbanowicz">6026442</a><br>split queries: <a href="https://codeforces.com/contest/400/submission/6006570" title="Submission 6006570 by CountZero">6006570</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-350143 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-350143 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-350143">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="360080" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/f2lk6wf90d" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/f2lk6wf90d" title="Pupil f2lk6wf90d" class="rated-user user-green">f2lk6wf90d</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/14/2017 21:47 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-360080" href="https://codeforces.com/blog/entry/18051?#comment-360080" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="360080" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="360080" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="500897" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-360080">
                    <div class="moveup">
                    <div class="ttypography"><p>I implemented a generic segment tree based on this article: <a href="https://gist.github.com/f2lk6wf90d/c22279724284a771c92f5642b3bed17c">Code</a>. Usage: simply write two structures <code class="tt">struct node</code> and <code class="tt">struct node_update</code> representing your tree nodes and updates, then provide function pointers that merge two nodes together, apply an update to a node, and merge two updates.</p><p>Example: <a href="https://codeforces.com/contest/794/submission/27103823" title="Submission 27103823 by f2lk6wf90d">27103823</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-360080 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-360080 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-360080">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="363159" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/motabhai_" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/26c7ceec6a18f8ba.jpg">        </a>
        <div><a href="https://codeforces.com/profile/motabhai_" title="Pupil motabhai_" class="rated-user user-green">motabhai_</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/30/2017 05:58 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-363159" href="https://codeforces.com/blog/entry/18051?#comment-363159" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="363159" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="363159" revisioncount="3" revision="3">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">3</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="363159" class="CommentVoteFrame" data-commentrating="1" data-commentuserid="572921" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+1</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-363159">
                    <div class="moveup">
                    <div class="ttypography"><p>As a noob I am still confused that what is the requirement of modify() function. As you are just doing the same thing that you did in build() function. Please explain.... But I must say you explained the whole concept in a nice manner..</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-363159 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-363159 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-363159">
            <li>
<div class="comment">
    <table class="comment-table" commentid="363178" commentparentid="363159">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/itu" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/98aa34dcee1c63c4.jpg">        </a>
        <div><a href="https://codeforces.com/profile/itu" title="Master itu" class="rated-user user-orange">itu</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/30/2017 07:44 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-363178" href="https://codeforces.com/blog/entry/18051?#comment-363178" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-363159" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="363178" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="363178" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="363178" class="CommentVoteFrame" data-commentrating="5" data-commentuserid="220803" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-363178">
                    <div class="moveup">
                    <div class="ttypography"><p>The idea is that modify() runs in O(logn) so doing it for every point is O(nlogn). build(), on the other hand, does the same thing but runs only in O(n).</p><p>This might not be significant in simple cases but will make a difference for complicated operations, or when num_queries &lt; n.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-363178 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-363178 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-363178">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="368618" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/donbox5" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/donbox5" title="Unrated, donbox5" class="rated-user user-black">donbox5</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/24/2017 09:44 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-368618" href="https://codeforces.com/blog/entry/18051?#comment-368618" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="368618" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="368618" revisioncount="4" revision="4">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">4</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="368618" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="337558" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-368618">
                    <div class="moveup">
                    <div class="ttypography"><p>noob here, Say the input is of size 6</p><p>Following parent child relationships are made:</p> <pre><code class="prettyprint prettyprinted" style=""><br><span class="lit">5</span><span class="pun">-&gt;</span><span class="pln">  left child </span><span class="lit">10</span><span class="pun">,</span><span class="pln">  right child </span><span class="lit">11</span><span class="pln">
</span><span class="lit">4</span><span class="pun">-&gt;</span><span class="pln">  left child  </span><span class="lit">8</span><span class="pun">,</span><span class="pln">  right child </span><span class="lit">9</span><span class="pln">
</span><span class="lit">3</span><span class="pun">-&gt;</span><span class="pln">  left child  </span><span class="lit">6</span><span class="pun">,</span><span class="pln">  right child </span><span class="lit">7</span><span class="pln">
</span><span class="lit">2</span><span class="pun">-&gt;</span><span class="pln">  left child  </span><span class="lit">4</span><span class="pun">,</span><span class="pln">  right child </span><span class="lit">5</span><span class="pln">
</span><span class="lit">1</span><span class="pun">-&gt;</span><span class="pln">  left child  </span><span class="lit">2</span><span class="pun">,</span><span class="pln">  right child </span><span class="lit">3</span><span class="pln">

</span><span class="typ">Now</span><span class="pun">,</span><span class="pln"> we can see </span><span class="kwd">in</span><span class="pln"> segment array</span><span class="pun">,</span><span class="pln">  </span><span class="lit">1</span><span class="pln"> has </span><span class="lit">2</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> left child   </span><span class="kwd">and</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> right child 
      

            </span><span class="lit">1</span><span class="pln">
         </span><span class="pun">/</span><span class="pln">	\  	
       </span><span class="pun">/</span><span class="pln">         </span><span class="lit">2</span><span class="pln">
      </span><span class="pun">/</span><span class="pln">        </span><span class="pun">/</span><span class="pln">    \ 
    </span><span class="lit">3</span><span class="pln">         </span><span class="lit">4</span><span class="pln">       </span><span class="lit">5</span><span class="pln">	
   </span><span class="pun">/</span><span class="pln">  \      </span><span class="pun">/</span><span class="pln">  \   </span><span class="pun">/</span><span class="pln">   \
  </span><span class="lit">6</span><span class="pln">    </span><span class="lit">7</span><span class="pln">    </span><span class="lit">8</span><span class="pln">   </span><span class="lit">9</span><span class="pln">   </span><span class="lit">10</span><span class="pln">   </span><span class="lit">11</span><span class="pln">


</span><span class="com">// Should not 2 ideally be a right child of 1</span></code></pre><p>If the usage context is such that the rules are different for processing left and right childs, then we will have wrong result, since node 2 should ideally be processed as a right child .</p><p>e.g. <a href="http://www.spoj.com/problems/BRCKTS/">http://www.spoj.com/problems/BRCKTS/</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-368618 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-368618 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-368618">
            <li>
<div class="comment">
    <table class="comment-table" commentid="504656" commentparentid="368618">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/edsa" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/918ba1be731a372e.jpg">        </a>
        <div><a href="https://codeforces.com/profile/edsa" title="International Master edsa" class="rated-user user-orange">edsa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/10/2019 02:23 UTC+7">5 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-504656" href="https://codeforces.com/blog/entry/18051?#comment-504656" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-368618" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="504656" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="504656" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="504656" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="591208" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-504656">
                    <div class="moveup">
                    <div class="ttypography"><p>I have been testing other sizes that incur in the same problem, as size 7 or 5. I do also agree that in these cases, if the operations is not conmutative or handles differently left and right children, this implementation will give an incorrect answer. Can you clarify <a class="rated-user user-red" href="https://codeforces.com/profile/Al.Cash" title="Grandmaster Al.Cash">Al.Cash</a>?</p><p>EDIT: Autocorrection: Those nodes are not used in the queries.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-504656 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-504656 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-504656">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="370346" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/inception_95" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/inception_95" title="Pupil inception_95" class="rated-user user-green">inception_95</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/29/2017 17:27 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-370346" href="https://codeforces.com/blog/entry/18051?#comment-370346" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="370346" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="370346" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="451557" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-370346">
                    <div class="moveup">
                    <div class="ttypography"><p>How can I find gcd(L,R) with the non-recursive segment tree? </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-370346 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-370346 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-370346">
            <li>
<div class="comment">
    <table class="comment-table" commentid="408025" commentparentid="370346">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/noob__coder" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/db5ffef19eba12ce.jpg">        </a>
        <div><a href="https://codeforces.com/profile/noob__coder" title="Pupil noob__coder" class="rated-user user-green">noob__coder</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/17/2018 04:10 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-408025" href="https://codeforces.com/blog/entry/18051?#comment-408025" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-370346" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="408025" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="408025" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="446537" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-408025">
                    <div class="moveup">
                    <div class="ttypography"><p>I guess it is not possible, since gcd function has no inverse. </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-408025 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-408025 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-408025">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="377353" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/SleepyShashwat" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/a2f0ad57d77866da.jpg"><img title="Badge of honor for supporting Codeforces on its 10th anniversary" src="./Efficient and easy segment trees - Codeforces_files/if_medal-bronze-blue_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/SleepyShashwat" title="Master SleepyShashwat" class="rated-user user-orange">SleepyShashwat</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/06/2017 21:55 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-377353" href="https://codeforces.com/blog/entry/18051?#comment-377353" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="377353" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="377353" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="578666" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-377353">
                    <div class="moveup">
                    <div class="ttypography"><p>Can somebody please explain what the bitwise operators do here cause its very difficult to catch up?</p><p>P.S — I know about Bitwise operators but have never used them in my code.</p><p>Thanks.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-377353 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-377353 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-377353">
            <li>
<div class="comment">
    <table class="comment-table" commentid="377354" commentparentid="377353">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/f2lk6wf90d" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/f2lk6wf90d" title="Pupil f2lk6wf90d" class="rated-user user-green">f2lk6wf90d</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/06/2017 22:12 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-377354" href="https://codeforces.com/blog/entry/18051?#comment-377354" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-377353" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="377354" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="377354" class="CommentVoteFrame" data-commentrating="3" data-commentuserid="500897" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-377354">
                    <div class="moveup">
                    <div class="ttypography"><p>If <span class="tex-span"><i>p</i></span> is a node in the tree, then <code class="tt">p &gt;&gt; 1</code> is its parent, <code class="tt">p &gt;&gt; s</code> is its <span class="tex-span"><i>s</i><sup class="upper-index"><i>th</i></sup></span> ancestor, <code class="tt">p &lt;&lt; 1</code> is its left child, and <code class="tt">p &lt;&lt; 1 | 1</code> is its right child.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-377354 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-377354 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-377354">
            <li>
<div class="comment">
    <table class="comment-table" commentid="377362" commentparentid="377354">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/SleepyShashwat" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/a2f0ad57d77866da.jpg"><img title="Badge of honor for supporting Codeforces on its 10th anniversary" src="./Efficient and easy segment trees - Codeforces_files/if_medal-bronze-blue_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/SleepyShashwat" title="Master SleepyShashwat" class="rated-user user-orange">SleepyShashwat</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/06/2017 23:14 UTC+7">7 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-377362" href="https://codeforces.com/blog/entry/18051?#comment-377362" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-377354" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="377362" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="377362" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="578666" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-377362">
                    <div class="moveup">
                    <div class="ttypography"><p>Thank you soo much!!!</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-377362 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-377362 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-377362">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="394333" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/ilovema" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/ilovema" title="Specialist ilovema" class="rated-user user-cyan">ilovema</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Nov/10/2017 23:09 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-394333" href="https://codeforces.com/blog/entry/18051?#comment-394333" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="394333" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="394333" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="394333" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="519367" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-394333">
                    <div class="moveup">
                    <div class="ttypography"><p>Is Binary Search possible like classic Segmented Tree ?</p><p>int ask(int id, int ID, int k, int l = 0,int r = n){// id is the index of the node after l-1-th update (or ir) and ID will be its index after r-th update  if(r — l &lt; 2) return l;  int mid = (l+r)/2;  if(s[L[ID]] — s[L[id]] &gt;= k)// answer is in the left child's interval  return ask(L[id], L[ID], k, l, mid);  else  return ask(R[id], R[ID], k — (s[L[ID]] — s[L[id]] ), mid, r);// there are already s[L[ID]] — s[L[id]] 1s in the left child's interval }</p><p><a href="https://codeforces.com/blog/entry/15890">http://codeforces.com/blog/entry/15890</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-394333 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-394333 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-394333">
            <li>
<div class="comment">
    <table class="comment-table" commentid="394349" commentparentid="394333">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Jakube" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/3a8c17167e460f5c.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Jakube" title="Grandmaster Jakube" class="rated-user user-red">Jakube</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Nov/11/2017 00:50 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-394349" href="https://codeforces.com/blog/entry/18051?#comment-394349" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-394333" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="394349" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="394349" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="394349" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="290814" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-394349">
                    <div class="moveup">
                    <div class="ttypography"><p>If n is a power of 2, than you can use the identical code as in the classic recursive Segment Tree. </p><p>If n is not a power of 2, it is still possible, but it is definitely harder.</p><p>One possible approach: - collect all indices of the segements that partition the query segment (be careful here, the iterative version alternatively finds such segments from the left and right border): there are O(log n) many - then iterate over them from the most left segment to the most right one, until you find the segment that contains the element you want to find. - then continue traversing to either the left or right child until you reach the leave node (this can be done iteratively or recursively).</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-394349 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-394349 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-394349">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="397257" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/brdy" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/93b8b981d83e596f.jpg">        </a>
        <div><a href="https://codeforces.com/profile/brdy" title="Expert brdy" class="rated-user user-blue">brdy</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Nov/26/2017 03:36 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-397257" href="https://codeforces.com/blog/entry/18051?#comment-397257" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="397257" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="397257" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="397257" class="CommentVoteFrame" data-commentrating="1" data-commentuserid="660867" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+1</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-397257">
                    <div class="moveup">
                    <div class="ttypography"><p>I have a question about this part of the code on the section: Modification on interval, single element access</p><p>int query(int p) {  int res = 0;  for (p += n; p &gt; 0; p &gt;&gt;= 1) res += t[p];  return res; }</p><p>Why do we travel all the way up the tree? Why do we not just return t[p+n]? I think I am missing something.</p><p>Edit: It's prefix sums.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-397257 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-397257 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-397257">
            <li>
<div class="comment">
    <table class="comment-table" commentid="405810" commentparentid="397257">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/sguu" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/f24f4c1e23b95e13.jpg">        </a>
        <div><a href="https://codeforces.com/profile/sguu" title="Pupil sguu" class="rated-user user-green">sguu</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/06/2018 10:16 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-405810" href="https://codeforces.com/blog/entry/18051?#comment-405810" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-397257" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="405810" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="405810" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="671369" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-405810">
                    <div class="moveup">
                    <div class="ttypography"><p>lol</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-405810 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-405810 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-405810">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="402710" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/altier" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/altier" title="Specialist altier" class="rated-user user-cyan">altier</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/25/2017 09:04 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-402710" href="https://codeforces.com/blog/entry/18051?#comment-402710" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="402710" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="402710" class="CommentVoteFrame" data-commentrating="5" data-commentuserid="326160" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-402710">
                    <div class="moveup">
                    <div class="ttypography"><p>I wrote some notes for query function, might be useful to others</p> <ol>   <li>if l is odd, that means l the right child of l's parent (see from 16: to 31: all left childs are even)</li> </ol> <ul>   <li>Hence we don't need to include l's parent</li>   <li>We add it to the result: res += t[l];</li>   <li>We include the parent just right of the current l's parent: l = (l+1)/2 (notice the l++)</li> </ul> <ol>   <li>if l is even, that means both left and right child of l's parent are included in the result</li> </ol> <ul>   <li>Include l's parent: l/=2</li>   <li>Don't add l to the result: if condition isn't m- et</li> </ul> <ol>   <li>if r is odd, that means the (r-1)th element is the left child of it's parent, and the same reasoning follows.</li> </ol></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-402710 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-402710 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-402710">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="402927" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/altier" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/altier" title="Specialist altier" class="rated-user user-cyan">altier</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/27/2017 07:59 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-402927" href="https://codeforces.com/blog/entry/18051?#comment-402927" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="402927" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="402927" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="326160" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-402927">
                    <div class="moveup">
                    <div class="ttypography"><p>I had an issue coding this segment tree for <a href="http://www.spoj.com/problems/DQUERY/">this</a> </p><p>As you can see in <a href="https://github.com/anoopkverma/Competitive-programming/blob/master/spoj_GSS1.cpp">this</a> solution, at the final step, we merge the left and right nodes to get the solution. I can't figure out how and when to do this merging in the iterative approach.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-402927 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-402927 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-402927">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="406788" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/sdpsarker88" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/89ddce264def4ea0.jpg">        </a>
        <div><a href="https://codeforces.com/profile/sdpsarker88" title="Expert sdpsarker88" class="rated-user user-blue">sdpsarker88</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/11/2018 03:38 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-406788" href="https://codeforces.com/blog/entry/18051?#comment-406788" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="406788" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="406788" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="306696" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-406788">
                    <div class="moveup">
                    <div class="ttypography"><p>I've modified the code lazy propagation for sum queries (Increment modifications), but it isn't working. What's the problem? </p><p><a href="https://ideone.com/TQsEjs">https://ideone.com/TQsEjs</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-406788 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-406788 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-406788">
            <li>
<div class="comment">
    <table class="comment-table" commentid="406901" commentparentid="406788">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Al.Cash" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/dcbc95e9f176e573.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Al.Cash" title="Grandmaster Al.Cash" class="rated-user user-red">Al.Cash</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/11/2018 21:00 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-406901" href="https://codeforces.com/blog/entry/18051?#comment-406901" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-406788" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="406901" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="406901" class="CommentVoteFrame" data-commentrating="3" data-commentuserid="14750" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-406901">
                    <div class="moveup">
                    <div class="ttypography"><p>When you increment the interval by a value, you need to add this value times the interval length to the sum. So, you need to modify the last example where the interval length is maintained, not the one you took.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-406901 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-406901 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-406901">
            <li>
<div class="comment">
    <table class="comment-table" commentid="406919" commentparentid="406901">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/sdpsarker88" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/89ddce264def4ea0.jpg">        </a>
        <div><a href="https://codeforces.com/profile/sdpsarker88" title="Expert sdpsarker88" class="rated-user user-blue">sdpsarker88</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/12/2018 00:11 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-406919" href="https://codeforces.com/blog/entry/18051?#comment-406919" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-406901" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="406919" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="406919" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="306696" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-406919">
                    <div class="moveup">
                    <div class="ttypography"><p>ok, thanks! </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-406919 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-406919 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-406919">
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="408439" commentparentid="406901">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/P___" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/P___" title="Expert P___" class="rated-user user-blue">P___</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/20/2018 03:39 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-408439" href="https://codeforces.com/blog/entry/18051?#comment-408439" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-406901" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="408439" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="408439" revisioncount="3" revision="3">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">3</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="408439" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="333" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-408439">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi,</p><p>I also have some issue with this. The code in the link looks perfectly fine to me, even though it may not be working...</p><p>Edit 2.: Task using below code was accepted, so there is a chance that below procedures are correct for range increment and sum queries. </p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2e5</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">10</span><span class="pun">;</span><span class="pln">  </span><span class="com">// limit for array size</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">  </span><span class="com">// array size</span><span class="pln">
	LL tree</span><span class="pun">[</span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> N</span><span class="pun">];</span><span class="pln">
	LL d</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> h</span><span class="pun">;</span><span class="pln">

	</span><span class="kwd">void</span><span class="pln"> apply</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> LL </span><span class="kwd">value</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">,</span><span class="pln"> LL </span><span class="pun">*</span><span class="pln">t</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="kwd">value</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	</span><span class="kwd">void</span><span class="pln"> build</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> LL </span><span class="pun">*</span><span class="pln">t</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> k </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> k </span><span class="pun">&lt;&lt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			l </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&gt;=</span><span class="pln"> l</span><span class="pun">;</span><span class="pln"> </span><span class="pun">--</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
				t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	</span><span class="kwd">void</span><span class="pln"> push</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> LL </span><span class="pun">*</span><span class="pln">t</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> s </span><span class="pun">=</span><span class="pln"> h</span><span class="pun">,</span><span class="pln"> k </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">h </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> s </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> </span><span class="pun">--</span><span class="pln">s</span><span class="pun">,</span><span class="pln"> k </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> l </span><span class="pun">&gt;&gt;</span><span class="pln"> s</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> r </span><span class="pun">&gt;&gt;</span><span class="pln"> s</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
				apply</span><span class="pun">(</span><span class="pln">i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> k</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">);</span><span class="pln">
				apply</span><span class="pun">(</span><span class="pln">i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> k</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">);</span><span class="pln">
				d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	</span><span class="kwd">void</span><span class="pln"> inc</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">,</span><span class="pln"> LL </span><span class="pun">*</span><span class="pln">t</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">value</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
		push</span><span class="pun">(</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> l </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">);</span><span class="pln">
		push</span><span class="pun">(</span><span class="pln">r </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> l0 </span><span class="pun">=</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> r0 </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> k </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&lt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> k </span><span class="pun">&lt;&lt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> apply</span><span class="pun">(</span><span class="pln">l</span><span class="pun">++,</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">);</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> apply</span><span class="pun">(--</span><span class="pln">r</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		build</span><span class="pun">(</span><span class="pln">l0</span><span class="pun">,</span><span class="pln"> l0 </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">);</span><span class="pln">
		build</span><span class="pun">(</span><span class="pln">r0 </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r0</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	LL query</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> LL </span><span class="pun">*</span><span class="pln">t</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		push</span><span class="pun">(</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> l </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">);</span><span class="pln">
		push</span><span class="pun">(</span><span class="pln">r </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">);</span><span class="pln">
		LL res </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&lt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> res </span><span class="pun">+=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">l</span><span class="pun">++];</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> res </span><span class="pun">+=</span><span class="pln"> t</span><span class="pun">[--</span><span class="pln">r</span><span class="pun">];</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span></code></pre></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-408439 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-408439 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-408439">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="408022" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/noob__coder" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/db5ffef19eba12ce.jpg">        </a>
        <div><a href="https://codeforces.com/profile/noob__coder" title="Pupil noob__coder" class="rated-user user-green">noob__coder</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/17/2018 04:07 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-408022" href="https://codeforces.com/blog/entry/18051?#comment-408022" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="408022" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="408022" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="446537" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-408022">
                    <div class="moveup">
                    <div class="ttypography"><p>Hello AI. I was trying to solve this <a href="https://codeforces.com/contest/915/problem/E">quesetion</a>. I learned that this is a question on Dynamic Segment tree. My question is — Can I implement Dynamic Seg Tree using the approach given. Or should I go for the recursive one?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-408022 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-408022 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-408022">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="410056" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/aviroop123" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/9ae5461a2f94a27f.jpg">        </a>
        <div><a href="https://codeforces.com/profile/aviroop123" title="Master aviroop123" class="rated-user user-orange">aviroop123</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/27/2018 18:14 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-410056" href="https://codeforces.com/blog/entry/18051?#comment-410056" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="410056" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="410056" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="494338" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-410056">
                    <div class="moveup">
                    <div class="ttypography"><p><a href="https://codeforces.com/problemset/problem/914/D">http://codeforces.com/problemset/problem/914/D</a> — Can non-recursive segtree be used for this problem ?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-410056 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-410056 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-410056">
            <li>
<div class="comment">
    <table class="comment-table" commentid="410449" commentparentid="410056">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/adhvana" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/fbb97262fc8a5d04.jpg">        </a>
        <div><a href="https://codeforces.com/profile/adhvana" title="Specialist adhvana" class="rated-user user-cyan">adhvana</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/30/2018 02:46 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-410449" href="https://codeforces.com/blog/entry/18051?#comment-410449" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-410056" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="410449" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="410449" class="CommentVoteFrame" data-commentrating="3" data-commentuserid="676832" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-410449">
                    <div class="moveup">
                    <div class="ttypography"><p>Yes : <a href="https://codeforces.com/contest/914/submission/34679495">http://codeforces.com/contest/914/submission/34679495</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-410449 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-410449 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-410449">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="410364" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/dhruvsomani" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/d23d58abf29de1ea.jpg">        </a>
        <div><a href="https://codeforces.com/profile/dhruvsomani" title="Expert dhruvsomani" class="rated-user user-blue">dhruvsomani</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/29/2018 20:29 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-410364" href="https://codeforces.com/blog/entry/18051?#comment-410364" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="410364" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="410364" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="311852" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-410364">
                    <div class="moveup">
                    <div class="ttypography"><p><img alt=" " src="./Efficient and easy segment trees - Codeforces_files/d0634cdfce4f463b389284ca85fa7b2c1a653b02.png" style="max-width: 100.0%;max-height: 100.0%;"></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-410364 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-410364 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-410364">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="410376" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/JettyOller" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/dbb34121022134dd.jpg">        </a>
        <div><a href="https://codeforces.com/profile/JettyOller" title="Grandmaster JettyOller" class="rated-user user-red">JettyOller</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/29/2018 21:53 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-410376" href="https://codeforces.com/blog/entry/18051?#comment-410376" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="410376" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="410376" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="687558" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-410376">
                    <div class="moveup">
                    <div class="ttypography"><p>Thanks for writing!I think this blog very useful for everyone,especially people who want to study about segment tree.Segment tree is a data structure that very amazing and great.This blog give me more knowledge about segment tree</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-410376 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-410376 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-410376">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="417688" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Marine7" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Marine7" title="Expert Marine7" class="rated-user user-blue">Marine7</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/01/2018 06:42 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-417688" href="https://codeforces.com/blog/entry/18051?#comment-417688" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="417688" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="417688" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="561966" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-417688">
                    <div class="moveup">
                    <div class="ttypography"><p>Could anybody share a 2d implementation of this segtree? Specifically, I'm trying to solve <a href="http://www.spoj.com/problems/MATSUM/">http://www.spoj.com/problems/MATSUM/</a> with it, but can't get it right :c</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-417688 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-417688 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-417688">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="421039" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/arpit728" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/arpit728" title="Specialist arpit728" class="rated-user user-cyan">arpit728</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/20/2018 15:07 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-421039" href="https://codeforces.com/blog/entry/18051?#comment-421039" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="421039" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="421039" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="493894" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-421039">
                    <div class="moveup">
                    <div class="ttypography"><p>Can anyone please explain range update operation with example, I didn't understand how is that working.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-421039 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-421039 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-421039">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="423842" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/OoO256" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/OoO256" title="Specialist OoO256" class="rated-user user-cyan">OoO256</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/06/2018 23:12 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-423842" href="https://codeforces.com/blog/entry/18051?#comment-423842" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="423842" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="423842" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="564632" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-423842">
                    <div class="moveup">
                    <div class="ttypography"><p>Thanks you for awesome post! Do you mind if I translate this post into Korean and share it on my blog? Of course I will cite this page and make sure that you are the original writer.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-423842 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-423842 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-423842">
            <li>
<div class="comment">
    <table class="comment-table" commentid="424041" commentparentid="423842">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Al.Cash" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/dcbc95e9f176e573.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Al.Cash" title="Grandmaster Al.Cash" class="rated-user user-red">Al.Cash</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/08/2018 02:07 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-424041" href="https://codeforces.com/blog/entry/18051?#comment-424041" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-423842" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="424041" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="424041" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="14750" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-424041">
                    <div class="moveup">
                    <div class="ttypography"><p>Sure, no problem.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-424041 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-424041 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-424041">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="426802" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/CaptainDaVinci" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/b40d0a8d047471db.jpg">        </a>
        <div><a href="https://codeforces.com/profile/CaptainDaVinci" title="Pupil CaptainDaVinci" class="rated-user user-green">CaptainDaVinci</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/26/2018 17:59 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-426802" href="https://codeforces.com/blog/entry/18051?#comment-426802" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="426802" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="426802" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="581192" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-426802">
                    <div class="moveup">
                    <div class="ttypography"><p>Will the left node always contain a range which lies before the range of right node? For example, when <span class="tex-span"><i>n</i> = 6</span>, wouldn't node 2 contain range <span class="tex-span">[8, 12)</span>, whereas node 3 contains <span class="tex-span">[6, 8)</span>?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-426802 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-426802 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-426802">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="428980" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/primelee" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/db65cb05eac51146.jpg">        </a>
        <div><a href="https://codeforces.com/profile/primelee" title="Pupil primelee" class="rated-user user-green">primelee</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/07/2018 10:34 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-428980" href="https://codeforces.com/blog/entry/18051?#comment-428980" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="428980" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="428980" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="631628" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-428980">
                    <div class="moveup">
                    <div class="ttypography"><p>I check your "modify" function code in section"Modification on interval, single element access". It didn't work out perfectly. It got wrong answer.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-428980 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-428980 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-428980">
            <li>
<div class="comment">
    <table class="comment-table" commentid="428981" commentparentid="428980">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/primelee" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/db65cb05eac51146.jpg">        </a>
        <div><a href="https://codeforces.com/profile/primelee" title="Pupil primelee" class="rated-user user-green">primelee</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/07/2018 10:36 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-428981" href="https://codeforces.com/blog/entry/18051?#comment-428981" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-428980" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="428981" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="428981" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="631628" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-428981">
                    <div class="moveup">
                    <div class="ttypography"><p>In the case that after add value to an interval,I want to get the result of the sum(i,j) of the array.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-428981 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-428981 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-428981">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="432206" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/AlexArdelean" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/AlexArdelean" title="Expert AlexArdelean" class="rated-user user-blue">AlexArdelean</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/20/2018 06:22 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-432206" href="https://codeforces.com/blog/entry/18051?#comment-432206" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="432206" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="432206" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="432206" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="544391" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-432206">
                    <div class="moveup">
                    <div class="ttypography"><p>[sorry, i was asking a stupid question, i got the answer myself]</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-432206 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-432206 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-432206">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="435496" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/abhijeetkaurav1st" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/abhijeetkaurav1st" title="Pupil abhijeetkaurav1st" class="rated-user user-green">abhijeetkaurav1st</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/04/2018 10:19 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-435496" href="https://codeforces.com/blog/entry/18051?#comment-435496" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="435496" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="435496" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="572034" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-435496">
                    <div class="moveup">
                    <div class="ttypography"><p>Not getting, the approach to carry it on <a href="http://acm.timus.ru/problem.aspx?space=1&amp;num=2042">Timus 2042</a>. If anyone can provide the solution. Thanks</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-435496 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-435496 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-435496">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="437499" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/srinath5943" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/srinath5943" title="Unrated, srinath5943" class="rated-user user-black">srinath5943</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/15/2018 16:38 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-437499" href="https://codeforces.com/blog/entry/18051?#comment-437499" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="437499" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="437499" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="228014" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-437499">
                    <div class="moveup">
                    <div class="ttypography"><p>For the first code snippet, why does this not work ? The only thing I changed is I wanted L, R to be inclusive. If R is even which means its the left child meaning it should be added and moved left and iterate over its parents. </p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">int</span><span class="pln"> sumRange</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&lt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> 
        </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">l </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                res </span><span class="pun">+=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">l</span><span class="pun">++];</span><span class="pln">
            </span><span class="pun">}</span><span class="pln"> 
            </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">r </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                res </span><span class="pun">+=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">r</span><span class="pun">--];</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">    
    </span><span class="pun">}</span></code></pre></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-437499 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-437499 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-437499">
            <li>
<div class="comment">
    <table class="comment-table" commentid="437510" commentparentid="437499">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Jakube" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/3a8c17167e460f5c.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Jakube" title="Grandmaster Jakube" class="rated-user user-red">Jakube</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/15/2018 19:58 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-437510" href="https://codeforces.com/blog/entry/18051?#comment-437510" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-437499" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="437510" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="437510" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="290814" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-437510">
                    <div class="moveup">
                    <div class="ttypography"><p>Try calling <code class="tt">sumRange(1, 1)</code>. What happens?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-437510 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-437510 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-437510">
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="448695" commentparentid="437499">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/ThiagoMM" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/72c949f83cd99d4b.jpg">        </a>
        <div><a href="https://codeforces.com/profile/ThiagoMM" title="Expert ThiagoMM" class="rated-user user-blue">ThiagoMM</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/02/2018 01:07 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-448695" href="https://codeforces.com/blog/entry/18051?#comment-448695" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-437499" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="448695" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="448695" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="487085" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-448695">
                    <div class="moveup">
                    <div class="ttypography"><p>You must do <code class="tt">l &lt;= r</code> instead of <code class="tt">l &lt; r</code>.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-448695 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-448695 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-448695">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="448694" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/ThiagoMM" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/72c949f83cd99d4b.jpg">        </a>
        <div><a href="https://codeforces.com/profile/ThiagoMM" title="Expert ThiagoMM" class="rated-user user-blue">ThiagoMM</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/02/2018 01:05 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-448694" href="https://codeforces.com/blog/entry/18051?#comment-448694" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="448694" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="448694" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="487085" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-448694">
                    <div class="moveup">
                    <div class="ttypography"><p>Is it possible to do Binary Search on this kind of Segment Tree?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-448694 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-448694 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-448694">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="455685" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/kkdp" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/77bb653ed4671ded.jpg">        </a>
        <div><a href="https://codeforces.com/profile/kkdp" title="Newbie kkdp" class="rated-user user-gray">kkdp</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Sep/03/2018 21:27 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-455685" href="https://codeforces.com/blog/entry/18051?#comment-455685" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="455685" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="455685" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="574457" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-455685">
                    <div class="moveup">
                    <div class="ttypography"><p>I used this implementation for <a href="https://www.geeksforgeeks.org/range-queries-longest-correct-bracket-subsequence/">this problem</a> but it seems like giving wrong answer.</p><p>this is my implementation ---&gt; <a href="https://ide.geeksforgeeks.org/Lw0xpjOTyX">click-here</a></p><p>the correct answer should be 26 but it gives 24</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-455685 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-455685 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-455685">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="459596" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/proofbycontradiction" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/25c17035aa988a1a.jpg">        </a>
        <div><a href="https://codeforces.com/profile/proofbycontradiction" title="Expert proofbycontradiction" class="rated-user user-blue">proofbycontradiction</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Sep/22/2018 02:35 UTC+7">6 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-459596" href="https://codeforces.com/blog/entry/18051?#comment-459596" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="459596" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="459596" class="CommentVoteFrame" data-commentrating="-8" data-commentuserid="314671" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-8</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-459596">
                    <div class="moveup">
                    <div class="ttypography"><p>This write-up is amazing. I come back to this every year and learn something new.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-459596 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-459596 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-459596">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="472338" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/srinath5943" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/srinath5943" title="Unrated, srinath5943" class="rated-user user-black">srinath5943</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Nov/19/2018 09:52 UTC+7">5 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-472338" href="https://codeforces.com/blog/entry/18051?#comment-472338" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="472338" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="472338" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="228014" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-472338">
                    <div class="moveup">
                    <div class="ttypography"><p><code class="tt">Leaves seem to appear on different heights, but that can be fixed by cutting the tree before the node 13 and moving its right part to the left.</code></p><p>I cant seem to understand this line when the author was talking about the case when n is not a power of 2 and how a simpler restructuring will make it look like a perfect binary tree. </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-472338 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-472338 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-472338">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="476080" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/nichas" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/6e1fa6fca8c358d6.jpg">        </a>
        <div><a href="https://codeforces.com/profile/nichas" title="Newbie nichas" class="rated-user user-gray">nichas</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/11/2018 22:59 UTC+7">5 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-476080" href="https://codeforces.com/blog/entry/18051?#comment-476080" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="476080" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="476080" class="CommentVoteFrame" data-commentrating="5" data-commentuserid="674010" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-476080">
                    <div class="moveup">
                    <div class="ttypography"><p>Read <a href="https://codeforces.com/blog/entry/60837">this(seg_tree_blog)</a> after this(for me).</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-476080 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-476080 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-476080">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="490305" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/vikas_404" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/vikas_404" title="Expert vikas_404" class="rated-user user-blue">vikas_404</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/06/2019 18:06 UTC+7">5 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-490305" href="https://codeforces.com/blog/entry/18051?#comment-490305" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="490305" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="490305" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="461309" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-490305">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi Al.cash , after watching few tutorial videos and understanding segment tree, I tried to implement it by understanding your tutorial. I never knew I would be able to implement it so quickly and so efficiently. I can't thank you enough for providing this tutorial. Thankyou so much!!</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-490305 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-490305 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-490305">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="491896" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/am1tbh47" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/am1tbh47" title="Expert am1tbh47" class="rated-user user-blue">am1tbh47</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/12/2019 03:56 UTC+7">5 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-491896" href="https://codeforces.com/blog/entry/18051?#comment-491896" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="491896" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="491896" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="680345" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-491896">
                    <div class="moveup">
                    <div class="ttypography"><p>As mentioned, the push function takes O(log(n) + |r - l|) time to complete and it is called on every call to modify(). isn't O(|r — l|) = O(n) which makes push take O(n) time in worst case?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-491896 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-491896 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-491896">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="510310" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/CP_Sucks" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/34704cae7ff6a9a1.jpg">        </a>
        <div><a href="https://codeforces.com/profile/CP_Sucks" title="Newbie CP_Sucks" class="rated-user user-gray">CP_Sucks</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/09/2019 15:29 UTC+7">5 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-510310" href="https://codeforces.com/blog/entry/18051?#comment-510310" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="510310" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="510310" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="674607" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-510310">
                    <div class="moveup">
                    <div class="ttypography"><p>Hope after this i will never need recursive segtree. I havent learnt it and hope i dont need it ever. </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-510310 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-510310 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-510310">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="512000" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/adityaaaaaaaaaaaaaaa" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/cfe209dced8f83c3.jpg">        </a>
        <div><a href="https://codeforces.com/profile/adityaaaaaaaaaaaaaaa" title="Expert adityaaaaaaaaaaaaaaa" class="rated-user user-blue">adityaaaaaaaaaaaaaaa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/18/2019 01:15 UTC+7">5 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-512000" href="https://codeforces.com/blog/entry/18051?#comment-512000" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="512000" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="512000" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="504135" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-512000">
                    <div class="moveup">
                    <div class="ttypography"><p>Why doesnt it work for gcd?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-512000 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-512000 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-512000">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="515764" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/a61742" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/a61742" title="Unrated, a61742" class="rated-user user-black">a61742</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/04/2019 17:48 UTC+7">5 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-515764" href="https://codeforces.com/blog/entry/18051?#comment-515764" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="515764" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="515764" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="873350" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-515764">
                    <div class="moveup">
                    <div class="ttypography"><p>It seems that it's harder to implement dynamic tree (for example 2D tree with size 1e5 * 1e5) with lazy propagation this way, because it's not trivial to move between arbitrary adjacent node (for example from 28 to 13 in the <a href="http://i.imgur.com/CG6aftV.png">last image</a>) to do range update.</p><p>It's possible to use <code class="tt">unordered_map</code> to store data but that may have larger constant factor than the recursive implementation.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-515764 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-515764 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-515764">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="558711" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/watchdogs132" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/watchdogs132" title="Newbie watchdogs132" class="rated-user user-gray">watchdogs132</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Nov/18/2019 17:41 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-558711" href="https://codeforces.com/blog/entry/18051?#comment-558711" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="558711" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="558711" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="785723" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-558711">
                    <div class="moveup">
                    <div class="ttypography"><p>Can gcd be found for a range using this style of segment tree?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-558711 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-558711 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-558711">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="560439" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/youdit" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/13fbbbbf29a12be9.jpg">        </a>
        <div><a href="https://codeforces.com/profile/youdit" title="Specialist youdit" class="rated-user user-cyan">youdit</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Nov/25/2019 20:06 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-560439" href="https://codeforces.com/blog/entry/18051?#comment-560439" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="560439" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="560439" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="681055" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-560439">
                    <div class="moveup">
                    <div class="ttypography"><p>I tried moving downward in this segment tree from root node to a node but it always give wrong result for N not the power of 2, can you give code how to do it</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-560439 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-560439 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-560439">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="565867" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Cyber_Wizard" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/2f30d67ff0bc1035.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Cyber_Wizard" title="Candidate Master Cyber_Wizard" class="rated-user user-violet">Cyber_Wizard</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/20/2019 20:26 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-565867" href="https://codeforces.com/blog/entry/18051?#comment-565867" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="565867" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="565867" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="800437" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-565867">
                    <div class="moveup">
                    <div class="ttypography"><p><a href="https://cses.fi/problemset/task/1190/">https://cses.fi/problemset/task/1190/</a> Can someone solve this question?</p><p>I have tried to solved it. It is giving correct answer for small values but it is giving wrong answer for large values. Here is my solution. <a href="https://ide.geeksforgeeks.org/XMbjHTJeEQ">https://ide.geeksforgeeks.org/XMbjHTJeEQ</a></p><p>Thanks :)</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-565867 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-565867 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-565867">
            <li>
<div class="comment">
    <table class="comment-table" commentid="565929" commentparentid="565867">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/gupta_samarth" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/544ca45346be9d69.jpg"><img title="Badge of honor for supporting Codeforces on its 10th anniversary" src="./Efficient and easy segment trees - Codeforces_files/if_medal-bronze-blue_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/gupta_samarth" title="Expert gupta_samarth" class="rated-user user-blue">gupta_samarth</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/21/2019 00:50 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-565929" href="https://codeforces.com/blog/entry/18051?#comment-565929" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-565867" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="565929" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="565929" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="481814" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-565929">
                    <div class="moveup">
                    <div class="ttypography"><p>Problem Statement says, "Empty subarrays are allowed".</p><p>So, I guess, you're printing <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;17&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 2.311em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.926em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.901em, 1001.93em, 2.567em, -999.997em); top: -2.176em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mo" id="MathJax-Span-3"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">−</span></span><span class="msubsup" id="MathJax-Span-4"><span style="display: inline-block; position: relative; width: 1.478em; height: 0px;"><span style="position: absolute; clip: rect(1.221em, 1000.84em, 2.567em, -999.997em); top: -2.176em; left: 0em;"><span class="mn" id="MathJax-Span-5"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span><span style="position: absolute; top: -2.689em; left: 0.837em;"><span class="texatom" id="MathJax-Span-6"><span class="mrow" id="MathJax-Span-7"><span class="mn" id="MathJax-Span-8" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">7</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.696em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>−</mo><msup><mn>10</mn><mrow class="MJX-TeXAtom-ORD"><mn>17</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-1">-10^{17}</script> in case you should print <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-9" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.388em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.221em, 1000.39em, 2.567em, -999.997em); top: -2.176em; left: 0em;"><span class="mrow" id="MathJax-Span-10"><span class="mn" id="MathJax-Span-11"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-2">0</script>. Just initialize everything in query to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-12" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.388em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.221em, 1000.39em, 2.567em, -999.997em); top: -2.176em; left: 0em;"><span class="mrow" id="MathJax-Span-13"><span class="mn" id="MathJax-Span-14"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-3">0</script>, instead of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-15" style="width: 1.093em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.901em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.221em, 1000.9em, 2.567em, -999.997em); top: -2.176em; left: 0em;"><span class="mrow" id="MathJax-Span-16"><span class="mi" id="MathJax-Span-17"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span class="mi" id="MathJax-Span-18"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mi" id="MathJax-Span-19"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">f</span></span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mi>n</mi><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">inf</script>. </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-565929 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-565929 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-565929">
            <li>
<div class="comment">
    <table class="comment-table" commentid="565993" commentparentid="565929">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Cyber_Wizard" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/2f30d67ff0bc1035.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Cyber_Wizard" title="Candidate Master Cyber_Wizard" class="rated-user user-violet">Cyber_Wizard</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/21/2019 04:45 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-565993" href="https://codeforces.com/blog/entry/18051?#comment-565993" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-565929" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="565993" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="565993" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="800437" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-565993">
                    <div class="moveup">
                    <div class="ttypography"><p><a href="https://ideone.com/W2obub">https://ideone.com/W2obub</a> It is still giving WA. :(</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-565993 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-565993 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-565993">
            <li>
<div class="comment">
    <table class="comment-table" commentid="566005" commentparentid="565993">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/gupta_samarth" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/544ca45346be9d69.jpg"><img title="Badge of honor for supporting Codeforces on its 10th anniversary" src="./Efficient and easy segment trees - Codeforces_files/if_medal-bronze-blue_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/gupta_samarth" title="Expert gupta_samarth" class="rated-user user-blue">gupta_samarth</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/21/2019 06:04 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-566005" href="https://codeforces.com/blog/entry/18051?#comment-566005" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-565993" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="566005" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="566005" revisioncount="3" revision="3">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">3</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="566005" class="CommentVoteFrame" data-commentrating="3" data-commentuserid="481814" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-566005">
                    <div class="moveup">
                    <div class="ttypography"><p>Okay, so I implemented it on my own and now I know where the problem is.</p><p>During implementation, I was stuck at query function. I asked myself, from which side do I want to combine the left and the right values. This is the problem. ( AI has explained it under the section "Non-commutative combiner functions" ).</p><p>We need to keep two answers. One from the left (lans ), and for each l-type ( fancy term for if(l&amp;1) case ) node, merge lans with l ( order matters ). And for each r-type, merge r with rans.</p><p>Finally merge lans and rans. Code <a href="http://p.ip.fi/Ivsk">here</a></p><p>Also, thanks to your query, I have learned something new today ( which hopefully I won't ever forget ). So, thanks a lot. And ofcourse, <a class="rated-user user-red" href="https://codeforces.com/profile/Al.Cash" title="Grandmaster Al.Cash">Al.Cash</a> thanks to you too for so many helpful blogs.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-566005 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-566005 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-566005">
            <li>
<div class="comment">
    <table class="comment-table" commentid="566011" commentparentid="566005">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Cyber_Wizard" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/2f30d67ff0bc1035.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Cyber_Wizard" title="Candidate Master Cyber_Wizard" class="rated-user user-violet">Cyber_Wizard</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/21/2019 06:22 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-566011" href="https://codeforces.com/blog/entry/18051?#comment-566011" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-566005" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="566011" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="566011" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="800437" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-566011">
                    <div class="moveup">
                    <div class="ttypography"><p>Thanks a lot! :)))))</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-566011 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-566011 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-566011">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="566637" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/IrOn" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/597546d465983318.jpg">        </a>
        <div><a href="https://codeforces.com/profile/IrOn" title="Newbie IrOn" class="rated-user user-gray">IrOn</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/23/2019 06:06 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-566637" href="https://codeforces.com/blog/entry/18051?#comment-566637" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="566637" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="566637" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="566637" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1219772" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-566637">
                    <div class="moveup">
                    <div class="ttypography"><p>I am not sure but I think a short correction is needed when query is made with right border.</p><p>May be it should be like:</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">int</span><span class="pln"> query</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">)</span><span class="pln">
 </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&lt;=</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> res </span><span class="pun">+=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">l</span><span class="pun">++];</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!(</span><span class="pln">r</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">))</span><span class="pln"> res </span><span class="pun">+=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">r</span><span class="pun">--];</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>instead of</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">int</span><span class="pln"> query</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  </span><span class="com">// sum on interval [l, r)</span><span class="pln">
  </span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&lt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> res </span><span class="pun">+=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">l</span><span class="pun">++];</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> res </span><span class="pun">+=</span><span class="pln"> t</span><span class="pun">[--</span><span class="pln">r</span><span class="pun">];</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-566637 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-566637 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-566637">
            <li>
<div class="comment">
    <table class="comment-table" commentid="566648" commentparentid="566637">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/gupta_samarth" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/544ca45346be9d69.jpg"><img title="Badge of honor for supporting Codeforces on its 10th anniversary" src="./Efficient and easy segment trees - Codeforces_files/if_medal-bronze-blue_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/gupta_samarth" title="Expert gupta_samarth" class="rated-user user-blue">gupta_samarth</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/23/2019 06:34 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-566648" href="https://codeforces.com/blog/entry/18051?#comment-566648" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-566637" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="566648" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="566648" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="481814" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-566648">
                    <div class="moveup">
                    <div class="ttypography"><p>Read this <a href="https://codeforces.com/blog/entry/18051?#comment-258073">comment</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-566648 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-566648 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-566648">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="572719" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/kick_bottowski7" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/kick_bottowski7" title="Unrated, kick_bottowski7" class="rated-user user-black">kick_bottowski7</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/12/2020 17:41 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-572719" href="https://codeforces.com/blog/entry/18051?#comment-572719" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="572719" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="572719" class="CommentVoteFrame" data-commentrating="1" data-commentuserid="1365445" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+1</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-572719">
                    <div class="moveup">
                    <div class="ttypography"><p>Can someone plz. provide me with an implementation for binary search in this kind of seg tree, coz. now i am really hooked to this style. BTW what i want to do is like find the first element which is greater or equal than some k(queries) using seg tree coz. there can be updates in the array. I am not able to do it for n which are not powers of 2. Thanks in advance any help will be appreciated.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-572719 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-572719 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-572719">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="574297" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/BitToByte" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/4704094c26019402.jpg">        </a>
        <div><a href="https://codeforces.com/profile/BitToByte" title="Expert BitToByte" class="rated-user user-blue">BitToByte</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/19/2020 21:39 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-574297" href="https://codeforces.com/blog/entry/18051?#comment-574297" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="574297" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="574297" revisioncount="3" revision="3">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">3</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="574297" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1065289" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-574297">
                    <div class="moveup">
                    <div class="ttypography"><pre><code class="prettyprint prettyprinted" style=""><span class="pln">can someone </span><span class="typ">Please</span><span class="pln"> explain me</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Why</span><span class="pln"> am i getting wrong answer </span><span class="kwd">when</span><span class="pln"> i </span><span class="kwd">use</span><span class="pln"> modification 
</span><span class="kwd">for</span><span class="pln"> all the values </span><span class="kwd">in</span><span class="pln"> some interval</span></code></pre><p>with the case :</p> <pre><code class="prettyprint prettyprinted" style=""><span class="pln">n </span><span class="pun">=</span><span class="pln"> </span><span class="lit">5</span><span class="pun">;</span><span class="pln">
elements </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">,</span><span class="lit">1</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">};</span><span class="pln">
modify</span><span class="pun">(</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">4</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> val </span><span class="pun">);</span><span class="pln"> </span><span class="com">// add val to all the elements in the range [ 0 , 4 ]</span><span class="pln">
query</span><span class="pun">(</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">4</span><span class="pln"> </span><span class="pun">);</span><span class="pln">        </span><span class="com">// [ l , r ]</span></code></pre> <pre><code class="prettyprint prettyprinted" style=""><span class="pln">i am getting answer </span><span class="kwd">as</span><span class="pln"> </span><span class="lit">8</span><span class="pln"> 
but i expect it to be </span><span class="lit">10</span></code></pre><p>the modify and query functions are :</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">void</span><span class="pln"> modify</span><span class="pun">(</span><span class="pln"> ll l </span><span class="pun">,</span><span class="pln"> ll r </span><span class="pun">,</span><span class="pln"> ll val </span><span class="pun">){</span><span class="pln"> </span><span class="com">// modify all the values in l to r </span><span class="pln">
 	</span><span class="kwd">for</span><span class="pun">(</span><span class="pln"> l</span><span class="pun">+=</span><span class="pln">n </span><span class="pun">,</span><span class="pln"> r</span><span class="pun">+=</span><span class="pln">n </span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&lt;=</span><span class="pln"> r </span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1LL</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> r </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1LL</span><span class="pln"> </span><span class="pun">){</span><span class="pln">
 		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln"> l</span><span class="pun">&amp;</span><span class="lit">1LL</span><span class="pln">    </span><span class="pun">)</span><span class="pln"> t</span><span class="pun">[</span><span class="pln"> l</span><span class="pun">++</span><span class="pln"> </span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> val</span><span class="pun">;</span><span class="pln">
 		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln"> </span><span class="pun">!(</span><span class="pln">r</span><span class="pun">&amp;</span><span class="lit">1LL</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> t</span><span class="pun">[</span><span class="pln"> r</span><span class="pun">--</span><span class="pln"> </span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> val</span><span class="pun">;</span><span class="pln">
 	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

ll query</span><span class="pun">(</span><span class="pln"> ll l </span><span class="pun">,</span><span class="pln"> ll r </span><span class="pun">){</span><span class="pln">
	ll res </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="pln"> l </span><span class="pun">+=</span><span class="pln"> n </span><span class="pun">,</span><span class="pln"> r</span><span class="pun">+=</span><span class="pln">n </span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&lt;=</span><span class="pln"> r </span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> r </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln"> l</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pln">    </span><span class="pun">)</span><span class="pln"> res </span><span class="pun">+=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">l</span><span class="pun">++];</span><span class="pln">
 		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln"> </span><span class="pun">!(</span><span class="pln">r</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> res </span><span class="pun">+=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">r</span><span class="pun">--];</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-574297 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-574297 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-574297">
            <li>
<div class="comment">
    <table class="comment-table" commentid="574867" commentparentid="574297">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/BitToByte" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/4704094c26019402.jpg">        </a>
        <div><a href="https://codeforces.com/profile/BitToByte" title="Expert BitToByte" class="rated-user user-blue">BitToByte</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/21/2020 20:33 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-574867" href="https://codeforces.com/blog/entry/18051?#comment-574867" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-574297" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="574867" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="574867" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="574867" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1065289" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-574867">
                    <div class="moveup">
                    <div class="ttypography"><p>.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-574867 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-574867 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-574867">
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="578787" commentparentid="574297">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/dantrag" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg"><img title="Badge of honor for supporting Codeforces on its 10th anniversary" src="./Efficient and easy segment trees - Codeforces_files/if_medal-bronze-blue_46108.png" style="position:absolute;bottom:5px;right:10px">        </a>
        <div><a href="https://codeforces.com/profile/dantrag" title="Master dantrag" class="rated-user user-orange">dantrag</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/07/2020 01:21 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-578787" href="https://codeforces.com/blog/entry/18051?#comment-578787" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-574297" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="578787" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="578787" class="CommentVoteFrame" data-commentrating="6" data-commentuserid="414671" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+6</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-578787">
                    <div class="moveup">
                    <div class="ttypography"><p>Read the tutorial examples carefully. [r, l] and [r, l) -- see any difference?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-578787 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-578787 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-578787">
            <li>
<div class="comment">
    <table class="comment-table" commentid="579194" commentparentid="578787">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/BitToByte" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/4704094c26019402.jpg">        </a>
        <div><a href="https://codeforces.com/profile/BitToByte" title="Expert BitToByte" class="rated-user user-blue">BitToByte</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/09/2020 15:37 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-579194" href="https://codeforces.com/blog/entry/18051?#comment-579194" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-578787" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="579194" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="579194" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="579194" class="CommentVoteFrame" data-commentrating="-6" data-commentuserid="1065289" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-6</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-579194">
                    <div class="moveup">
                    <div class="ttypography"><p>.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-579194 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-579194 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-579194">
            <li>
<div class="comment">
    <table class="comment-table" commentid="579235" commentparentid="579194">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/dantrag" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg"><img title="Badge of honor for supporting Codeforces on its 10th anniversary" src="./Efficient and easy segment trees - Codeforces_files/if_medal-bronze-blue_46108.png" style="position:absolute;bottom:5px;right:10px">        </a>
        <div><a href="https://codeforces.com/profile/dantrag" title="Master dantrag" class="rated-user user-orange">dantrag</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/09/2020 20:53 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-579235" href="https://codeforces.com/blog/entry/18051?#comment-579235" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-579194" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="579235" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="579235" class="CommentVoteFrame" data-commentrating="7" data-commentuserid="414671" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+7</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-579235">
                    <div class="moveup">
                    <div class="ttypography"><p>Come on, just sit and iterate your algorithm manually and see what goes wrong. It will not do any good to you if you just use the code without understanding how it works.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-579235 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-579235 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-579235">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="579105" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/shadowfox38" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/shadowfox38" title="Pupil shadowfox38" class="rated-user user-green">shadowfox38</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/09/2020 03:15 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-579105" href="https://codeforces.com/blog/entry/18051?#comment-579105" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="579105" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="579105" revisioncount="7" revision="7">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">7</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="579105" class="CommentVoteFrame" data-commentrating="-6" data-commentuserid="1217064" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-6</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-579105">
                    <div class="moveup">
                    <div class="ttypography"><p>(deleted)</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-579105 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-579105 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-579105">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="580467" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Spheniscine" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/9311eb392a3d0c8c.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Spheniscine" title="Master Spheniscine" class="rated-user user-orange">Spheniscine</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/14/2020 10:50 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-580467" href="https://codeforces.com/blog/entry/18051?#comment-580467" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="580467" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="580467" revisioncount="3" revision="3">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">3</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="580467" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1170595" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-580467">
                    <div class="moveup">
                    <div class="ttypography"><p>Note that there are sometimes reasons to round up the tree size to the nearest power of 2. This uses more memory, but forces the shape into the "perfect binary tree" which makes some operations possible/easier, like unconditional <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-20" style="width: 1.862em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.542em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.221em, 1001.54em, 2.567em, -999.997em); top: -2.176em; left: 0em;"><span class="mrow" id="MathJax-Span-21"><span class="mi" id="MathJax-Span-22"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">O</span></span><span class="mo" id="MathJax-Span-23"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mn" id="MathJax-Span-24"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-25"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-5">O(1)</script> access to the root (especially useful if the combining op is expensive), or in-place binary search in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-26" style="width: 3.401em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.824em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.221em, 1002.82em, 2.567em, -999.997em); top: -2.176em; left: 0em;"><span class="mrow" id="MathJax-Span-27"><span class="mi" id="MathJax-Span-28"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">O</span></span><span class="mo" id="MathJax-Span-29"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">(</span></span><span class="mi" id="MathJax-Span-30"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">o</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">g</span></span><span class="mo" id="MathJax-Span-31"></span><span class="mi" id="MathJax-Span-32" style="padding-left: 0.196em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span class="mo" id="MathJax-Span-33"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-6">O(\log n)</script>. Not to mention also somewhat simplifying the tree structure for relative beginners who need to make sure their lazy propagation or other modification works right.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-580467 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-580467 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-580467">
            <li>
<div class="comment">
    <table class="comment-table" commentid="610714" commentparentid="580467">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Thallium54" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/22f922dfe2b8a121.jpg"><img title="Badge of honor for supporting Codeforces on its 10th anniversary" src="./Efficient and easy segment trees - Codeforces_files/if_medal-bronze-blue_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/Thallium54" title="Master Thallium54" class="rated-user user-orange">Thallium54</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/26/2020 10:32 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-610714" href="https://codeforces.com/blog/entry/18051?#comment-610714" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-580467" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="610714" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="610714" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="924718" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-610714">
                    <div class="moveup">
                    <div class="ttypography"><p>I totally agree. It's a good example for "a coin has two sides". We can't say that which one is better.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-610714 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-610714 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-610714">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="596752" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/codegirl22" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/87ef1af089967e56.jpg">        </a>
        <div><a href="https://codeforces.com/profile/codegirl22" title="Newbie codegirl22" class="rated-user user-gray">codegirl22</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/03/2020 16:37 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-596752" href="https://codeforces.com/blog/entry/18051?#comment-596752" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="596752" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="596752" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1373260" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-596752">
                    <div class="moveup">
                    <div class="ttypography"><p>hey thanks forthe easy and amazing approach. the recursive implementation was just so difficult, this is so easy. i am really thankful</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-596752 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-596752 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-596752">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="602769" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Himanshu_Kisley_Lodu_Hai" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/e08144d46ac1b82d.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Himanshu_Kisley_Lodu_Hai" title="Specialist Himanshu_Kisley_Lodu_Hai" class="rated-user user-cyan">Himanshu_Kisley_Lodu_Hai</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/14/2020 01:58 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-602769" href="https://codeforces.com/blog/entry/18051?#comment-602769" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="602769" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="602769" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1436609" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-602769">
                    <div class="moveup">
                    <div class="ttypography"><p>This implementation is no doubt good, but it fails on some places</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-602769 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-602769 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-602769">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="611724" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/ISuckAtLife" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/7ed1df770a1ca933.jpg">        </a>
        <div><a href="https://codeforces.com/profile/ISuckAtLife" title="Expert ISuckAtLife" class="rated-user user-blue">ISuckAtLife</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/27/2020 19:19 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-611724" href="https://codeforces.com/blog/entry/18051?#comment-611724" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="611724" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="611724" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="927310" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-611724">
                    <div class="moveup">
                    <div class="ttypography"><p>Sorry, but I think tradition/recursive implementation is much much simpler and easy to understand(at least for me) and also is less prone to mistakes. It's Just what I felt after reading traditional implementation after this one. Though I must say its really interesting and well-written blog.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-611724 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-611724 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-611724">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="621293" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Asif17r" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/7fdb492ee583cc03.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Asif17r" title="Expert Asif17r" class="rated-user user-blue">Asif17r</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/13/2020 17:23 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-621293" href="https://codeforces.com/blog/entry/18051?#comment-621293" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="621293" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="621293" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="621293" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1465481" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-621293">
                    <div class="moveup">
                    <div class="ttypography"><p>.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-621293 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-621293 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-621293">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="626639" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/bharatkulratan" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/eb54be61aeff4832.jpg">        </a>
        <div><a href="https://codeforces.com/profile/bharatkulratan" title="Newbie bharatkulratan" class="rated-user user-gray">bharatkulratan</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/20/2020 05:41 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-626639" href="https://codeforces.com/blog/entry/18051?#comment-626639" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="626639" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="626639" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="21040" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-626639">
                    <div class="moveup">
                    <div class="ttypography"><p>Pictorial representation for provided approach is easy for 0-based array indexes because parent child relationship could be calculated using 2*n(left) and 2*n+1(right). However, this also works for array index starting from 1. It's little hard to draw this parent child relationship figure between nodes but it works fine anyway.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-626639 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-626639 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-626639">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="627469" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/bckslsh03" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/54979b71bba8dfa1.jpg">        </a>
        <div><a href="https://codeforces.com/profile/bckslsh03" title="Pupil bckslsh03" class="rated-user user-green">bckslsh03</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/22/2020 06:40 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-627469" href="https://codeforces.com/blog/entry/18051?#comment-627469" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="627469" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="627469" revisioncount="3" revision="3">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">3</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="627469" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1353209" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-627469">
                    <div class="moveup">
                    <div class="ttypography"><p>Is it possible to find kth-order statistics in the problem <a href="https://codeforces.com/contest/1354/problem/D" title="Educational Codeforces Round 87 (Rated for Div. 2)">1354D - Multiset</a> using the non-recursive implementation of segment trees mentioned in this blog in which the array is arbitrarily sized(i.e the segment tree array size is not some power of 2).</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-627469 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-627469 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-627469">
            <li>
<div class="comment">
    <table class="comment-table" commentid="627482" commentparentid="627469">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/_pastor_" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/297d02cc468607c0.jpg">        </a>
        <div><a href="https://codeforces.com/profile/_pastor_" title="Expert _pastor_" class="rated-user user-blue">_pastor_</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/22/2020 07:54 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-627482" href="https://codeforces.com/blog/entry/18051?#comment-627482" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-627469" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="627482" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="627482" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="627482" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1338357" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-627482">
                    <div class="moveup">
                    <div class="ttypography"><p>use fenwik tree it is standard ques <a href="https://codeforces.com/contest/1354/submission/80799964">https://codeforces.com/contest/1354/submission/80799964</a> </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-627482 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-627482 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-627482">
            <li>
<div class="comment">
    <table class="comment-table" commentid="627591" commentparentid="627482">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/bckslsh03" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/54979b71bba8dfa1.jpg">        </a>
        <div><a href="https://codeforces.com/profile/bckslsh03" title="Pupil bckslsh03" class="rated-user user-green">bckslsh03</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/22/2020 20:41 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-627591" href="https://codeforces.com/blog/entry/18051?#comment-627591" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-627482" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="627591" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="627591" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1353209" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-627591">
                    <div class="moveup">
                    <div class="ttypography"><p>Yes I did actually previously solved it using Fenwick tree. But recently I was learning about the non-recursive segment tree and so to practice I thought of solving the same problem using it. But I was unable to code for finding the kth-order statistics using the non-recursive approach of segment trees.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-627591 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-627591 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-627591">
            <li>
<div class="comment">
    <table class="comment-table" commentid="627599" commentparentid="627591">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/_pastor_" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/297d02cc468607c0.jpg">        </a>
        <div><a href="https://codeforces.com/profile/_pastor_" title="Expert _pastor_" class="rated-user user-blue">_pastor_</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/22/2020 21:06 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-627599" href="https://codeforces.com/blog/entry/18051?#comment-627599" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-627591" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="627599" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="627599" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1338357" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-627599">
                    <div class="moveup">
                    <div class="ttypography"><p>search "seg tree question codeforces" on google you will find a great blog which have very good practice queue on seg tree</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-627599 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-627599 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-627599">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="627484" commentparentid="627469">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/_pastor_" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/297d02cc468607c0.jpg">        </a>
        <div><a href="https://codeforces.com/profile/_pastor_" title="Expert _pastor_" class="rated-user user-blue">_pastor_</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/22/2020 07:57 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-627484" href="https://codeforces.com/blog/entry/18051?#comment-627484" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-627469" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="627484" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="627484" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="627484" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1338357" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-627484">
                    <div class="moveup">
                    <div class="ttypography"><p>can you plz share your seg tree approach if you got solved!!</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-627484 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-627484 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-627484">
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="627602" commentparentid="627469">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Savior-of-Cross" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/4a9ba311986fb8a5.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Savior-of-Cross" title="Grandmaster Savior-of-Cross" class="rated-user user-red">Savior-of-Cross</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/22/2020 21:13 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-627602" href="https://codeforces.com/blog/entry/18051?#comment-627602" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-627469" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="627602" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="627602" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="627602" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1187106" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-627602">
                    <div class="moveup">
                    <div class="ttypography"><p><a href="https://codeforces.com/contest/1354/submission/80923473">Here</a>. Just find and store all the roots when initializing.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-627602 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-627602 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-627602">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="651171" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/satyam656" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/91e5b9909284de29.jpg">        </a>
        <div><a href="https://codeforces.com/profile/satyam656" title="Specialist satyam656" class="rated-user user-cyan">satyam656</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/27/2020 16:49 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-651171" href="https://codeforces.com/blog/entry/18051?#comment-651171" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="651171" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="651171" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1284377" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-651171">
                    <div class="moveup">
                    <div class="ttypography"><p>Can anyone explain this part "scanf("%d", t + n + i)"? where does scanned element get stored?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-651171 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-651171 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-651171">
            <li>
<div class="comment">
    <table class="comment-table" commentid="651180" commentparentid="651171">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/H4ckOm" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/916f8210eff81eff.jpg">        </a>
        <div><a href="https://codeforces.com/profile/H4ckOm" title="Specialist H4ckOm" class="rated-user user-cyan">H4ckOm</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/27/2020 17:19 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-651180" href="https://codeforces.com/blog/entry/18051?#comment-651180" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-651171" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="651180" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="651180" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1518664" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-651180">
                    <div class="moveup">
                    <div class="ttypography"><p>It will be stored in array with name t, at location n+i </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-651180 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-651180 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-651180">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="658359" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/aneee" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/ec4e48c9d0fcba0c.jpg">        </a>
        <div><a href="https://codeforces.com/profile/aneee" title="Expert aneee" class="rated-user user-blue">aneee</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/09/2020 15:36 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-658359" href="https://codeforces.com/blog/entry/18051?#comment-658359" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="658359" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="658359" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1512957" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-658359">
                    <div class="moveup">
                    <div class="ttypography"><p>Is it possible to do a range sum update and make a range product query?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-658359 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-658359 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-658359">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="662761" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/SPyofgame" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/c54545917ea6e3dc.jpg">        </a>
        <div><a href="https://codeforces.com/profile/SPyofgame" title="Expert SPyofgame" class="rated-user user-blue">SPyofgame</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/17/2020 01:18 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-662761" href="https://codeforces.com/blog/entry/18051?#comment-662761" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="662761" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="662761" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1197344" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-662761">
                    <div class="moveup">
                    <div class="ttypography"><p>Can someone help me, I try my best but cant solve this problem using Iterative Implemenetation</p><p><a href="https://codeforces.com/edu/course/2/lesson/4/2/practice/contest/273278/problem/B">The problem</a></p> <div class="spoiler"><b class="spoiler-title">My code</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="kwd">struct</span><span class="pln"> segtree </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> size </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> cnt</span><span class="pun">;</span><span class="pln">        </span><span class="com">/// count number of ones</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> left_node</span><span class="pun">;</span><span class="pln">  
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> right_node</span><span class="pun">;</span><span class="pln">

    </span><span class="kwd">void</span><span class="pln"> init</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> lim</span><span class="pun">)</span><span class="pln"> </span><span class="com">/// segment tree initalization</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        size </span><span class="pun">=</span><span class="pln"> lim</span><span class="pun">;</span><span class="pln">
        cnt</span><span class="pun">.</span><span class="pln">assign</span><span class="pun">(</span><span class="pln">size </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
        left_node</span><span class="pun">.</span><span class="pln">assign</span><span class="pun">(</span><span class="pln">size </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
        right_node</span><span class="pun">.</span><span class="pln">assign</span><span class="pun">(</span><span class="pln">size </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    </span><span class="kwd">void</span><span class="pln"> build</span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> vector</span><span class="str">&lt;bool&gt;</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">a</span><span class="pun">)</span><span class="pln"> </span><span class="com">/// build segment tree linear based on vector</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        init</span><span class="pun">(</span><span class="pln">a</span><span class="pun">.</span><span class="pln">size</span><span class="pun">());</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> size</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">{</span><span class="pln">
            cnt</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> size</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
            left_node</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> size</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">   
            right_node</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> size</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">   
        </span><span class="pun">}</span><span class="pln">

        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> size </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> </span><span class="pun">--</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">{</span><span class="pln">
            cnt</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span><span class="pln">
            left_node</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> left_node</span><span class="pun">[</span><span class="pln">i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span><span class="pln">
            right_node</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> right_node</span><span class="pun">[</span><span class="pln">i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    </span><span class="kwd">void</span><span class="pln"> modify</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">)</span><span class="pln"> </span><span class="com">/// reverse value of p_th element</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cnt</span><span class="pun">[</span><span class="pln">p </span><span class="pun">+=</span><span class="pln"> size</span><span class="pun">]</span><span class="pln"> </span><span class="pun">^=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> p </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> p </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">{</span><span class="pln">
            cnt</span><span class="pun">[</span><span class="pln">p </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">p </span><span class="pun">^</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

   </span><span class="kwd">int</span><span class="pln"> query</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="com">/// find p_th one in array</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> curNode </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> l </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">=</span><span class="pln"> size </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">&lt;</span><span class="pln"> r</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cnt</span><span class="pun">[</span><span class="pln">curNode </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> p</span><span class="pun">)</span><span class="pln">
            </span><span class="pun">{</span><span class="pln">
                p </span><span class="pun">-=</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">curNode </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span><span class="pln">
                l </span><span class="pun">=</span><span class="pln"> left_node</span><span class="pun">[</span><span class="pln">curNode </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span><span class="pln">
                curNode </span><span class="pun">=</span><span class="pln"> curNode </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            </span><span class="kwd">else</span><span class="pln">
            </span><span class="pun">{</span><span class="pln">
                r </span><span class="pun">=</span><span class="pln"> right_node</span><span class="pun">[</span><span class="pln">curNode </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span><span class="pln">
                curNode </span><span class="pun">=</span><span class="pln"> curNode </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> l</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">};</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
    getUnsign</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> q</span><span class="pun">);</span><span class="pln">

    </span><span class="com">/// inputing array</span><span class="pln">
    vector</span><span class="str">&lt;bool&gt;</span><span class="pln"> a</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
        a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> readInt</span><span class="pun">();</span><span class="pln">

    </span><span class="com">/// segment tree initalization</span><span class="pln">
    segtree st</span><span class="pun">;</span><span class="pln">
    st</span><span class="pun">.</span><span class="pln">build</span><span class="pun">(</span><span class="pln">a</span><span class="pun">);</span><span class="pln">

    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">q</span><span class="pun">--&gt;</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="com">/// for each query</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">readInt</span><span class="pun">()</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="com">/// modification case</span><span class="pln">
        </span><span class="pun">{</span><span class="pln">
            st</span><span class="pun">.</span><span class="pln">modify</span><span class="pun">(</span><span class="pln">readInt</span><span class="pun">());</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln"> </span><span class="com">/// answering query case</span><span class="pln">
        </span><span class="pun">{</span><span class="pln">
            cout </span><span class="pun">&lt;&lt;</span><span class="pln"> st</span><span class="pun">.</span><span class="pln">query</span><span class="pun">(</span><span class="pln">readInt</span><span class="pun">())</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-662761 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-662761 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-662761">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="672972" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/_pastor_" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/297d02cc468607c0.jpg">        </a>
        <div><a href="https://codeforces.com/profile/_pastor_" title="Expert _pastor_" class="rated-user user-blue">_pastor_</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/02/2020 06:37 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-672972" href="https://codeforces.com/blog/entry/18051?#comment-672972" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="672972" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="672972" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="672972" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1338357" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-672972">
                    <div class="moveup">
                    <div class="ttypography"><p><code class="tt">Modification on interval, single element access</code><br>I can't understand how these functions are working and I try to implement them on an array and it is giving wrong output can anyone plz check it<br>an example where it failed<br>array = 3 2 1 2 now after build, the tree should look like this 0 8 5 3 3 2 1 2<br>now we will modify range 0 — 1 inclusive and add value 1 so after this, the tree looked like this 0 8 6 3 3 2 1 2<br>now if we query the 0 indexed element output is 17 whereas it should be 3 </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-672972 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-672972 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-672972">
            <li>
<div class="comment">
    <table class="comment-table" commentid="673040" commentparentid="672972">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Everule" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/eba3182b16e6fc48.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Everule" title="Grandmaster Everule" class="rated-user user-red">Everule</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/02/2020 17:03 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-673040" href="https://codeforces.com/blog/entry/18051?#comment-673040" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-672972" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="673040" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="673040" revisioncount="3" revision="3">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">3</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="673040" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1390111" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-673040">
                    <div class="moveup">
                    <div class="ttypography"><p>Here's a quick implementation you can compare with.</p> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;iostream&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> mp make_pair
</span><span class="com">#define</span><span class="pln"> pb push_back
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> ll </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">struct</span><span class="pln"> segment_tree</span><span class="pun">{</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> segtree</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">join</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">){</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> x</span><span class="pun">+</span><span class="pln">y</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    segment_tree</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> n</span><span class="pun">(</span><span class="pln">n</span><span class="pun">){</span><span class="pln">
        segtree</span><span class="pun">.</span><span class="pln">resize</span><span class="pun">(</span><span class="pln">n</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">void</span><span class="pln"> build</span><span class="pun">(){</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&gt;</span><span class="lit">0</span><span class="pun">;--</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
            segtree</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">join</span><span class="pun">(</span><span class="pln">segtree</span><span class="pun">[</span><span class="pln">i</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> segtree</span><span class="pun">[(</span><span class="pln">i</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">)|</span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">void</span><span class="pln"> update</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> pos</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> val</span><span class="pun">){</span><span class="pln">
        pos</span><span class="pun">+=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
        segtree</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">]+=</span><span class="pln">val</span><span class="pun">;</span><span class="pln">
        pos</span><span class="pun">&gt;&gt;=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">pos</span><span class="pun">){</span><span class="pln">
            segtree</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">]=</span><span class="kwd">join</span><span class="pun">(</span><span class="pln">segtree</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">],</span><span class="pln">segtree</span><span class="pun">[(</span><span class="pln">pos</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">)|</span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
            pos</span><span class="pun">&gt;&gt;=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> query</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">){</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> ans</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        x</span><span class="pun">+=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
        y</span><span class="pun">+=</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">x</span><span class="pun">&lt;</span><span class="pln">y</span><span class="pun">){</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">x</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">){</span><span class="pln">
                ans</span><span class="pun">=</span><span class="kwd">join</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">,</span><span class="pln"> segtree</span><span class="pun">[</span><span class="pln">x</span><span class="pun">++]);</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">y</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">){</span><span class="pln">
                ans</span><span class="pun">=</span><span class="kwd">join</span><span class="pun">(</span><span class="pln">segtree</span><span class="pun">[--</span><span class="pln">y</span><span class="pun">],</span><span class="pln"> ans</span><span class="pun">);</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            x</span><span class="pun">&gt;&gt;=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
            y</span><span class="pun">&gt;&gt;=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">int</span><span class="pun">&amp;</span><span class="pln"> </span><span class="kwd">operator</span><span class="pun">[](</span><span class="kwd">int</span><span class="pln"> idx</span><span class="pun">){</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> segtree</span><span class="pun">[</span><span class="pln">idx </span><span class="pun">+</span><span class="pln"> n</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">};</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    cin</span><span class="pun">&gt;&gt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> seq</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++){</span><span class="pln">
        cin</span><span class="pun">&gt;&gt;</span><span class="pln">seq</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    segment_tree segtree</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++){</span><span class="pln">
        segtree</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> seq</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> seq</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    segtree</span><span class="pun">.</span><span class="pln">build</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> Q</span><span class="pun">;</span><span class="pln">
    cin</span><span class="pun">&gt;&gt;</span><span class="pln">Q</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">Q</span><span class="pun">--){</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln">r</span><span class="pun">,</span><span class="pln">val</span><span class="pun">;</span><span class="pln">
        cin</span><span class="pun">&gt;&gt;</span><span class="pln">l</span><span class="pun">&gt;&gt;</span><span class="pln">r</span><span class="pun">&gt;&gt;</span><span class="pln">val</span><span class="pun">;</span><span class="pln">
        segtree</span><span class="pun">.</span><span class="pln">update</span><span class="pun">(</span><span class="pln">l</span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> val</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">r</span><span class="pun">!=</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> segtree</span><span class="pun">.</span><span class="pln">update</span><span class="pun">(</span><span class="pln">r</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="pln">val</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++){</span><span class="pln">
            cout</span><span class="pun">&lt;&lt;</span><span class="pln">segtree</span><span class="pun">.</span><span class="pln">query</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> i</span><span class="pun">)&lt;&lt;</span><span class="str">" "</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        cout</span><span class="pun">&lt;&lt;</span><span class="str">"\n"</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="pln">NULL</span><span class="pun">);</span><span class="pln">
    solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-673040 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-673040 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-673040">
            <li>
<div class="comment">
    <table class="comment-table" commentid="673048" commentparentid="673040">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/_pastor_" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/297d02cc468607c0.jpg">        </a>
        <div><a href="https://codeforces.com/profile/_pastor_" title="Expert _pastor_" class="rated-user user-blue">_pastor_</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/02/2020 17:48 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-673048" href="https://codeforces.com/blog/entry/18051?#comment-673048" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-673040" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="673048" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="673048" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1338357" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-673048">
                    <div class="moveup">
                    <div class="ttypography"><p>thanx for showing that cool struct. The update function in that struct works for a particular index type query whereas I have doubt in the modification in interval type query. Sorry if I was misunderstood something. </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-673048 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-673048 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-673048">
            <li>
<div class="comment">
    <table class="comment-table" commentid="673049" commentparentid="673048">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Everule" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/eba3182b16e6fc48.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Everule" title="Grandmaster Everule" class="rated-user user-red">Everule</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/02/2020 17:56 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-673049" href="https://codeforces.com/blog/entry/18051?#comment-673049" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-673048" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="673049" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="673049" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1390111" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-673049">
                    <div class="moveup">
                    <div class="ttypography"><p>It does range addition and point queries. I can wrap that up in the struct as well. But the segment tree is actually the difference array. Just input <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-34" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.388em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.221em, 1000.39em, 2.567em, -999.997em); top: -2.176em; left: 0em;"><span class="mrow" id="MathJax-Span-35"><span class="mi" id="MathJax-Span-36"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">n</script>, then <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-37" style="width: 5.388em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.49em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.221em, 1004.49em, 2.76em, -999.997em); top: -2.176em; left: 0em;"><span class="mrow" id="MathJax-Span-38"><span class="msubsup" id="MathJax-Span-39"><span style="display: inline-block; position: relative; width: 0.965em; height: 0px;"><span style="position: absolute; clip: rect(1.221em, 1000.58em, 2.567em, -999.997em); top: -2.176em; left: 0em;"><span class="mi" id="MathJax-Span-40"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span><span style="position: absolute; top: -1.984em; left: 0.58em;"><span class="mn" id="MathJax-Span-41" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span></span><span class="mo" id="MathJax-Span-42"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="msubsup" id="MathJax-Span-43" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.965em; height: 0px;"><span style="position: absolute; clip: rect(1.221em, 1000.58em, 2.567em, -999.997em); top: -2.176em; left: 0em;"><span class="mi" id="MathJax-Span-44"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span><span style="position: absolute; top: -1.984em; left: 0.58em;"><span class="mn" id="MathJax-Span-45" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">2</span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span></span><span class="mo" id="MathJax-Span-46" style="padding-left: 0.196em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">…</span></span><span class="msubsup" id="MathJax-Span-47" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.965em; height: 0px;"><span style="position: absolute; clip: rect(1.221em, 1000.58em, 2.567em, -999.997em); top: -2.176em; left: 0em;"><span class="mi" id="MathJax-Span-48"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">A</span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span><span style="position: absolute; top: -1.984em; left: 0.58em;"><span class="mi" id="MathJax-Span-49" style="font-size: 70.7%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">n</span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.535em; border-left: 0px solid; width: 0px; height: 1.542em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>A</mi><mn>1</mn></msub><mo>,</mo><msub><mi>A</mi><mn>2</mn></msub><mo>…</mo><msub><mi>A</mi><mi>n</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-8">A_1, A_2 \dots A_n</script>, then <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-50" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.388em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.221em, 1000.39em, 2.567em, -999.997em); top: -2.176em; left: 0em;"><span class="mrow" id="MathJax-Span-51"><span class="mi" id="MathJax-Span-52"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">q</span></span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-9">q</script>, then <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-53" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.388em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.221em, 1000.39em, 2.567em, -999.997em); top: -2.176em; left: 0em;"><span class="mrow" id="MathJax-Span-54"><span class="mi" id="MathJax-Span-55"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">q</span></span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-10">q</script> lines of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-56" style="width: 1.093em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.901em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.221em, 1000.9em, 2.567em, -999.997em); top: -2.176em; left: 0em;"><span class="mrow" id="MathJax-Span-57"><span class="mi" id="MathJax-Span-58"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span></span><span class="mi" id="MathJax-Span-59"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mi" id="MathJax-Span-60"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">v</span></span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>r</mi><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-11">l r v</script>, where it adds <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-61" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.388em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.221em, 1000.39em, 2.567em, -999.997em); top: -2.176em; left: 0em;"><span class="mrow" id="MathJax-Span-62"><span class="mi" id="MathJax-Span-63"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">v</span></span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">v</script> to the indexes <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-64" style="width: 0.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.26em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.221em, 1000.26em, 2.567em, -999.997em); top: -2.176em; left: 0em;"><span class="mrow" id="MathJax-Span-65"><span class="mi" id="MathJax-Span-66"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">i</script> such that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-67" style="width: 3.272em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.696em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.221em, 1002.7em, 2.567em, -999.997em); top: -2.176em; left: 0em;"><span class="mrow" id="MathJax-Span-68"><span class="mi" id="MathJax-Span-69"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span></span><span class="mo" id="MathJax-Span-70" style="padding-left: 0.26em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">≤</span></span><span class="mi" id="MathJax-Span-71" style="padding-left: 0.26em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">i</span></span><span class="mo" id="MathJax-Span-72" style="padding-left: 0.26em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">≤</span></span><span class="mi" id="MathJax-Span-73" style="padding-left: 0.26em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mo>≤</mo><mi>i</mi><mo>≤</mo><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">l\le i \le r</script>.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-673049 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-673049 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-673049">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="673419" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/du00d" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/du00d" title="Newbie du00d" class="rated-user user-gray">du00d</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/03/2020 15:29 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-673419" href="https://codeforces.com/blog/entry/18051?#comment-673419" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="673419" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="673419" revisioncount="4" revision="4">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">4</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="673419" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1493189" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-673419">
                    <div class="moveup">
                    <div class="ttypography"><p>Hello, I was wondering how would you convert the following into querying for minimum? I've tried substituting the logic in the loop but was getting some weird answer. Thanks</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">int</span><span class="pln"> query</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  </span><span class="com">// sum on interval [l, r)</span><span class="pln">
  </span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&lt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> res </span><span class="pun">+=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">l</span><span class="pun">++];</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> res </span><span class="pun">+=</span><span class="pln"> t</span><span class="pun">[--</span><span class="pln">r</span><span class="pun">];</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>EDIT: I figured it out forgot to change build() as well. </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-673419 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-673419 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-673419">
            <li>
<div class="comment">
    <table class="comment-table" commentid="673695" commentparentid="673419">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/julianferres" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/2d21f10dafa61bc8.jpg">        </a>
        <div><a href="https://codeforces.com/profile/julianferres" title="Candidate Master julianferres" class="rated-user user-violet">julianferres</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/04/2020 10:08 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-673695" href="https://codeforces.com/blog/entry/18051?#comment-673695" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-673419" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="673695" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="673695" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="602623" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-673695">
                    <div class="moveup">
                    <div class="ttypography"><pre><code class="prettyprint prettyprinted" style=""><span class="kwd">void</span><span class="pln"> build</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  </span><span class="com">// build the tree</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> </span><span class="pun">--</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">],</span><span class="pln">t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">|</span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> query</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  </span><span class="com">// min on interval [l, r)</span><span class="pln">
  </span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> INF</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&lt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">res</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">l</span><span class="pun">++]);</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">res</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">[--</span><span class="pln">r</span><span class="pun">]);</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-673695 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-673695 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-673695">
            <li>
<div class="comment">
    <table class="comment-table" commentid="715815" commentparentid="673695">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Imran_Farid" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/7f6bc71602243ec2.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Imran_Farid" title="Pupil Imran_Farid" class="rated-user user-green">Imran_Farid</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Oct/28/2020 01:59 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-715815" href="https://codeforces.com/blog/entry/18051?#comment-715815" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-673695" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="715815" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="715815" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1368912" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-715815">
                    <div class="moveup">
                    <div class="ttypography"><p>Is there any way to convert this iterative segment tree into querying the number of minimums within the range? </p><p>Thanks in advance!</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-715815 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-715815 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-715815">
            <li>
<div class="comment">
    <table class="comment-table" commentid="715819" commentparentid="715815">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/julianferres" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/2d21f10dafa61bc8.jpg">        </a>
        <div><a href="https://codeforces.com/profile/julianferres" title="Candidate Master julianferres" class="rated-user user-violet">julianferres</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Oct/28/2020 02:09 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-715819" href="https://codeforces.com/blog/entry/18051?#comment-715819" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-715815" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="715819" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="715819" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="602623" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-715819">
                    <div class="moveup">
                    <div class="ttypography"><p>You can store pairs instead of numbers, so the first element will store the value, and the second the count. When merging nodes, compare for the first of the pair: If they are equal, sum the second elements. If not, just keep the node with smaller first.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-715819 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-715819 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-715819">
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="715824" commentparentid="715815">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/julianferres" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/2d21f10dafa61bc8.jpg">        </a>
        <div><a href="https://codeforces.com/profile/julianferres" title="Candidate Master julianferres" class="rated-user user-violet">julianferres</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Oct/28/2020 02:21 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-715824" href="https://codeforces.com/blog/entry/18051?#comment-715824" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-715815" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="715824" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="715824" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="602623" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-715824">
                    <div class="moveup">
                    <div class="ttypography"><pre><code class="prettyprint prettyprinted" style=""><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> pair</span><span class="pun">&lt;</span><span class="pln">ll</span><span class="pun">,</span><span class="pln">ll</span><span class="pun">&gt;</span><span class="pln"> ii</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">const</span><span class="pln"> ll N </span><span class="pun">=</span><span class="pln"> </span><span class="lit">200005</span><span class="pun">;</span><span class="pln">  </span><span class="com">// limit for array size</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> ll INF </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1LL</span><span class="pun">&lt;&lt;</span><span class="lit">60</span><span class="pun">);</span><span class="pln">
ll n</span><span class="pun">;</span><span class="pln">  </span><span class="com">// array size</span><span class="pln">
ii t</span><span class="pun">[</span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> N</span><span class="pun">];</span><span class="pln">

ii combine</span><span class="pun">(</span><span class="pln">ii a</span><span class="pun">,</span><span class="pln"> ii b</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">a</span><span class="pun">.</span><span class="pln">first</span><span class="pun">&lt;</span><span class="pln">b</span><span class="pun">.</span><span class="pln">first</span><span class="pun">)</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> a</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">a</span><span class="pun">.</span><span class="pln">first</span><span class="pun">&gt;</span><span class="pln">b</span><span class="pun">.</span><span class="pln">first</span><span class="pun">)</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> b</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">else</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><span class="pln">a</span><span class="pun">.</span><span class="pln">first</span><span class="pun">,</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">second </span><span class="pun">+</span><span class="pln"> b</span><span class="pun">.</span><span class="pln">second</span><span class="pun">};</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> build</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  </span><span class="com">// build the tree</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> </span><span class="pun">--</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> combine</span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">|</span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> modify</span><span class="pun">(</span><span class="pln">ll p</span><span class="pun">,</span><span class="pln"> ll </span><span class="kwd">value</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  </span><span class="com">// set value at position p</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="pln">p </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="kwd">value</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">};</span><span class="pln"> p </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> p </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">&gt;&gt;</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> combine</span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">],</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">^</span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

ii query</span><span class="pun">(</span><span class="pln">ll l</span><span class="pun">,</span><span class="pln"> ll r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  </span><span class="com">// min on llerval [l, r)</span><span class="pln">
  ii res </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">INF</span><span class="pun">,</span><span class="lit">1</span><span class="pun">};</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&lt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> combine</span><span class="pun">(</span><span class="pln">res</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">l</span><span class="pun">++]);</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> combine</span><span class="pun">(</span><span class="pln">res</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">[--</span><span class="pln">r</span><span class="pun">]);</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>Init is t[i+n] = {a[i], 1}, for i=0,...n-1</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-715824 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-715824 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-715824">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="693901" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Pirate_King_Luffy" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/ecf05fbc4d603f8a.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Pirate_King_Luffy" title="Pupil Pirate_King_Luffy" class="rated-user user-green">Pirate_King_Luffy</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Sep/10/2020 18:34 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-693901" href="https://codeforces.com/blog/entry/18051?#comment-693901" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="693901" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="693901" class="CommentVoteFrame" data-commentrating="5" data-commentuserid="722230" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-693901">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi. For the range modification and range quesry shouldn't it be <code class="tt">if (!(r&amp;1)) res += st[r--]</code> I am confused as to how your approach works, since I used it for a submission in a problem and it didn't pass, while the one I mentioned above did. Can u pls explain?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-693901 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-693901 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-693901">
            <li>
<div class="comment">
    <table class="comment-table" commentid="693920" commentparentid="693901">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/gupta_samarth" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/544ca45346be9d69.jpg"><img title="Badge of honor for supporting Codeforces on its 10th anniversary" src="./Efficient and easy segment trees - Codeforces_files/if_medal-bronze-blue_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/gupta_samarth" title="Expert gupta_samarth" class="rated-user user-blue">gupta_samarth</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Sep/10/2020 19:16 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-693920" href="https://codeforces.com/blog/entry/18051?#comment-693920" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-693901" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="693920" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="693920" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="481814" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-693920">
                    <div class="moveup">
                    <div class="ttypography"><p>Everything he has written, was for half open interval <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-74" style="width: 1.798em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.478em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.221em, 1001.48em, 2.567em, -999.997em); top: -2.176em; left: 0em;"><span class="mrow" id="MathJax-Span-75"><span class="mo" id="MathJax-Span-76"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">[</span></span><span class="mi" id="MathJax-Span-77"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span></span><span class="mo" id="MathJax-Span-78"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-79" style="padding-left: 0.196em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-80"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mi>l</mi><mo>,</mo><mi>r</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-15">[l,r)</script>, and in particular, changing <code class="tt">--r</code> to <code class="tt">r--</code> will not always work. When you query for a range <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-81" style="width: 1.798em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.478em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.221em, 1001.48em, 2.567em, -999.997em); top: -2.176em; left: 0em;"><span class="mrow" id="MathJax-Span-82"><span class="mo" id="MathJax-Span-83"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">[</span></span><span class="mi" id="MathJax-Span-84"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">l</span></span><span class="mo" id="MathJax-Span-85"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-86" style="padding-left: 0.196em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">r</span></span><span class="mo" id="MathJax-Span-87"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mi>l</mi><mo>,</mo><mi>r</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-16">[l,r]</script> just put the parameters in the function as <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-88" style="display: inline-block; width: 3.849em;"><span style="display: inline-block; position: relative; width: 3.208em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.029em, 1003.14em, 2.631em, -999.997em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-89" style="display: inline-block;"><span class="mo" id="MathJax-Span-90" style="display: inline-block;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal; vertical-align: 0.26em;"><span><img src="./Efficient and easy segment trees - Codeforces_files/0028.png" style="width: 5px; height: 16px; vertical-align: -4px; margin-right: 0.067em;"></span></span></span><span class="mi" id="MathJax-Span-91" style="display: inline-block;"><img src="./Efficient and easy segment trees - Codeforces_files/006C.png" style="width: 4px; height: 12px; vertical-align: 0px; margin-right: 0.067em;"></span><span class="mo" id="MathJax-Span-92" style="display: inline-block;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">,</span></span><span class="mi" id="MathJax-Span-93" style="display: inline-block; padding-left: 0.196em;"><img src="./Efficient and easy segment trees - Codeforces_files/0072.png" style="width: 7px; height: 7px; vertical-align: 0px; margin-right: 0.003em;"></span><span class="mo" id="MathJax-Span-94" style="display: inline-block; padding-left: 0.196em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">+</span></span><span class="mn" id="MathJax-Span-95" style="display: inline-block; padding-left: 0.196em;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">1</span></span><span class="mo" id="MathJax-Span-96" style="display: inline-block;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal; vertical-align: 0.26em;"><span><img src="./Efficient and easy segment trees - Codeforces_files/0029.png" style="width: 5px; height: 16px; vertical-align: -4px; margin-right: 0.067em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.247em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>l</mi><mo>,</mo><mi>r</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-17">(l,r+1)</script>.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-693920 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-693920 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-693920">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="696569" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/videl1975" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/videl1975" title="Unrated, videl1975" class="rated-user user-black">videl1975</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Sep/16/2020 02:13 UTC+7">4 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-696569" href="https://codeforces.com/blog/entry/18051?#comment-696569" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="696569" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="696569" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1535558" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-696569">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi. Could you please tell how would the code you have provided be modified for the problem of "Count elements which divide all numbers in range L-R"?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-696569 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-696569 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-696569">
            <li>
<div class="comment">
    <table class="comment-table" commentid="715820" commentparentid="696569">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/julianferres" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/2d21f10dafa61bc8.jpg">        </a>
        <div><a href="https://codeforces.com/profile/julianferres" title="Candidate Master julianferres" class="rated-user user-violet">julianferres</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Oct/28/2020 02:12 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-715820" href="https://codeforces.com/blog/entry/18051?#comment-715820" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-696569" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="715820" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="715820" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="715820" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="602623" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-715820">
                    <div class="moveup">
                    <div class="ttypography"><p>You can make a tree for gcd and a tree for min (with count). If the min of the interval is equal to the gcd, nice, the count of the mins is your answer. Otherwise is 0.</p><p>This is because the required numbers should divide the gcd of all the elements in the interval, but at the same time are elements, so just the minimum could be a value to count</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-715820 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-715820 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-715820">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="736349" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Night_Lord" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/80657acc1252f929.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Night_Lord" title="Newbie Night_Lord" class="rated-user user-gray">Night_Lord</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/23/2020 18:42 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-736349" href="https://codeforces.com/blog/entry/18051?#comment-736349" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="736349" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="736349" class="CommentVoteFrame" data-commentrating="-8" data-commentuserid="1504546" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-8</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-736349">
                    <div class="moveup">
                    <div class="ttypography"><p>Hey I am trying to do segment tree for calculating xor of the query.<a href="https://atcoder.jp/contests/abc185/tasks/abc185_f">Question</a></p><p>My 3 functions are below-</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">void</span><span class="pln"> build</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&gt;</span><span class="lit">0</span><span class="pun">;--</span><span class="pln">i</span><span class="pun">)</span><span class="pln">seg</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=(</span><span class="pln">seg</span><span class="pun">[</span><span class="pln">i</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">]^</span><span class="pln">seg</span><span class="pun">[</span><span class="pln">i</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">|</span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
</span><span class="pun">}</span></code></pre> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">void</span><span class="pln"> update</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="pln">seg</span><span class="pun">[</span><span class="pln">p</span><span class="pun">+=</span><span class="pln">n</span><span class="pun">]=</span><span class="kwd">value</span><span class="pun">;</span><span class="pln">p</span><span class="pun">&gt;</span><span class="lit">1</span><span class="pun">;</span><span class="pln">p</span><span class="pun">&gt;&gt;=</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> seg</span><span class="pun">[</span><span class="pln">p</span><span class="pun">&gt;&gt;</span><span class="lit">1</span><span class="pun">]=(</span><span class="pln">seg</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]^</span><span class="pln">seg</span><span class="pun">[</span><span class="pln">p</span><span class="pun">^</span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
</span><span class="pun">}</span></code></pre> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">int</span><span class="pln"> query</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> res</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="pln">l</span><span class="pun">+=</span><span class="pln">n</span><span class="pun">,</span><span class="pln">r</span><span class="pun">+=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">l</span><span class="pun">&lt;</span><span class="pln">r</span><span class="pun">;</span><span class="pln">l</span><span class="pun">&gt;&gt;=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">r</span><span class="pun">&gt;&gt;=</span><span class="lit">1</span><span class="pun">){</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">l</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln">res</span><span class="pun">^=</span><span class="pln">seg</span><span class="pun">[</span><span class="pln">l</span><span class="pun">++];</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">r</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln">res</span><span class="pun">^=</span><span class="pln">seg</span><span class="pun">[--</span><span class="pln">r</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>Why am I getting weird answers?plz help.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-736349 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-736349 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-736349">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="743140" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/____Neo____" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/46d9b77434661983.jpg">        </a>
        <div><a href="https://codeforces.com/profile/____Neo____" title="Newbie ____Neo____" class="rated-user user-gray">____Neo____</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/04/2021 16:56 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-743140" href="https://codeforces.com/blog/entry/18051?#comment-743140" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="743140" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="743140" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1267014" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-743140">
                    <div class="moveup">
                    <div class="ttypography"><p>it's great blog for segment tree.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-743140 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-743140 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-743140">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="756281" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/eztso" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/eztso" title="Unrated, eztso" class="rated-user user-black">eztso</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/01/2021 08:22 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-756281" href="https://codeforces.com/blog/entry/18051?#comment-756281" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="756281" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="756281" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1176135" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-756281">
                    <div class="moveup">
                    <div class="ttypography"><p>for assignment modification and sum query, would it ever be the case that dp[i] is not 0 by the time you call build? doesnt push zero out all the dp[i] for parents that need to be built?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-756281 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-756281 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-756281">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="795603" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/cozaaaaak" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/72f36f0cd13e094e.jpg">        </a>
        <div><a href="https://codeforces.com/profile/cozaaaaak" title="Newbie cozaaaaak" class="rated-user user-gray">cozaaaaak</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/26/2021 15:08 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-795603" href="https://codeforces.com/blog/entry/18051?#comment-795603" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="795603" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="795603" class="CommentVoteFrame" data-commentrating="-7" data-commentuserid="2033170" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-7</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-795603">
                    <div class="moveup">
                    <div class="ttypography"><p>I love you</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-795603 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-795603 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-795603">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="810368" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Mir_Rak" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/43443f72b68f8fd2.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Mir_Rak" title="Pupil Mir_Rak" class="rated-user user-green">Mir_Rak</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/01/2021 06:03 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-810368" href="https://codeforces.com/blog/entry/18051?#comment-810368" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="810368" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="810368" class="CommentVoteFrame" data-commentrating="-26" data-commentuserid="1198986" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-26</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-810368">
                    <div class="moveup">
                    <div class="ttypography"><p>This blog is gold...</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-810368 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-810368 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-810368">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="823911" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/3oo.SNOW_BLACK" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/e2ea60a903f703d7.jpg">        </a>
        <div><a href="https://codeforces.com/profile/3oo.SNOW_BLACK" title="Specialist 3oo.SNOW_BLACK" class="rated-user user-cyan">3oo.SNOW_BLACK</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/01/2021 06:45 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-823911" href="https://codeforces.com/blog/entry/18051?#comment-823911" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="823911" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="823911" revisioncount="3" revision="3">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">3</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="823911" class="CommentVoteFrame" data-commentrating="-25" data-commentuserid="1657848" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-25</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-823911">
                    <div class="moveup">
                    <div class="ttypography"><p>I have a problem with segment code because it was written with templet can any one write it with out templet for me ?</p><p>THNX ^_^</p><p>code ::</p><p><a href="https://codeforces.com/contest/383/submission/124454690" title="Submission 124454690 by 3oo.SNOW_BLACK">124454690</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-823911 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-823911 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-823911">
            <li>
<div class="comment">
    <table class="comment-table" commentid="846978" commentparentid="823911">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Karma-kun" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/9e907cf39ab66020.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Karma-kun" title="Pupil Karma-kun" class="rated-user user-green">Karma-kun</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Oct/04/2021 09:14 UTC+7">3 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-846978" href="https://codeforces.com/blog/entry/18051?#comment-846978" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-823911" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="846978" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="846978" revisioncount="3" revision="3">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">3</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="846978" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1306742" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-846978">
                    <div class="moveup">
                    <div class="ttypography"><p><a class="rated-user user-cyan" href="https://codeforces.com/profile/3oo.SNOW_BLACK" title="Specialist 3oo.SNOW_BLACK">3oo.SNOW_BLACK</a>, Here are my Segment Tree Codes Without Templates + I know How to do Lazy Propagation but hasn't added it yet</p><p><a href="https://github.com/SHABRAWii/Problem_Solving/tree/master/Topics/Algorithms/Segment%20Tree">Github_Repo</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-846978 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-846978 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-846978">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="858006" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/abhilash_8642" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/ff66ff1c50e920ab.jpg">        </a>
        <div><a href="https://codeforces.com/profile/abhilash_8642" title="Expert abhilash_8642" class="rated-user user-blue">abhilash_8642</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Nov/13/2021 04:25 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-858006" href="https://codeforces.com/blog/entry/18051?#comment-858006" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="858006" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="858006" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="858006" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1883376" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-858006">
                    <div class="moveup">
                    <div class="ttypography"><p>given an array of n elements, and q queries with two types 1 l r s e indicates flip bits of positions [s,s+1,....e] of subarray [al,..ar], 2 l r s e indicates print the number of set bits [s,s+1,...e] of subarray [al,...ar] n&lt;=q&lt;= 10^5, a[i] &lt; 10^9 0&lt;s&lt;e&lt;30</p><p>Can anyone help me in doing this?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-858006 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-858006 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-858006">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="879875" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/preet_25" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/a9e65582930b9458.jpg">        </a>
        <div><a href="https://codeforces.com/profile/preet_25" title="Master preet_25" class="rated-user user-orange">preet_25</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/21/2022 07:30 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-879875" href="https://codeforces.com/blog/entry/18051?#comment-879875" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="879875" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="879875" class="CommentVoteFrame" data-commentrating="-28" data-commentuserid="2154160" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-28</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-879875">
                    <div class="moveup">
                    <div class="ttypography"><p>Great Tutorial !!!</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-879875 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-879875 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-879875">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="882951" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Cristiano07" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/fb9b92c8fa44e8ef.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Cristiano07" title="Unrated, Cristiano07" class="rated-user user-black">Cristiano07</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/01/2022 09:31 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-882951" href="https://codeforces.com/blog/entry/18051?#comment-882951" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="882951" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="882951" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="882951" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="2343492" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-882951">
                    <div class="moveup">
                    <div class="ttypography"><p>I know this is an old post, but I have a few questions that I think are worth asking:</p><p>1) in "Assignment modifications, sum queries", the utility functions "push" and "build" are only used (throughout the functions "query" and "modify") with parameters (l,l+1) and (r-1,r); in the push/build function's implementation, 'l+=n' and 'r+=n-1' are applied to the original parameters l and r; doesn't this make the new 'l' and 'r' point to the same-indexed nodes in the tree? So throughout the traversal of the tree from bottom to top (build) or top to bottom (push), we are still only applying/calculating the updates on a single node's parents (since for example, when passing in (l,l+1), "left side" (l+n) and "right side" (l+1+n-1) are already made the same node at the beggining) ? If so, why let build/push function take in two adjacent indices as parameter, rather than just passing a single index (the index of a "border" node of the update)?</p><p>2) again in "Assignment modifications, sum queries", what should the "initial" build function of this tree be like? (i.e. construct the tree from elements in the array) Is it still the same as this?</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">void</span><span class="pln"> init_build</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="pln">n</span><span class="pun">]=</span><span class="pln">arr</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">     </span><span class="com">//arr is the array we perform updates/range queries on</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> </span><span class="pun">--</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">|</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>I tried to use this for initial build for the tree, but the range updates/queries made based on it are incorrect: in particular, when I tried to update an interval and get the sum of a subinterval inside it (for example, update interval [2,8] and get sum of interval [2,5] or [3,7]), the answer is wrong. However, when the interval of "get" query covers the interval of "upd" query, the answer is correct. All other utility functions (push,build,modify,get) are directly copied from this post.Why is this producing wrong answers? What should the initial build of the tree in be in this case?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-882951 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-882951 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-882951">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="893087" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/zjsqwq" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/363414a0b58168b4.jpg">        </a>
        <div><a href="https://codeforces.com/profile/zjsqwq" title="Unrated, zjsqwq" class="rated-user user-black">zjsqwq</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/06/2022 01:33 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-893087" href="https://codeforces.com/blog/entry/18051?#comment-893087" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="893087" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="893087" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="2413423" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-893087">
                    <div class="moveup">
                    <div class="ttypography"><p>Perfect idea!</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-893087 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-893087 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-893087">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="895378" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/abhi.agr" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/abhi.agr" title="Pupil abhi.agr" class="rated-user user-green">abhi.agr</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/13/2022 06:32 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-895378" href="https://codeforces.com/blog/entry/18051?#comment-895378" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="895378" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="895378" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="2361" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-895378">
                    <div class="moveup">
                    <div class="ttypography"><p>What is the difference between these two <code class="tt">modify</code> methods</p><p>Code 1- </p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">void</span><span class="pln"> modify</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  </span><span class="com">// set value at position p</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="pln">p </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">;</span><span class="pln"> p </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> p </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">&gt;&gt;</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">^</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>Code 2-</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">void</span><span class="pln"> modify</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> S</span><span class="pun">&amp;</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="pln">p </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">;</span><span class="pln"> p </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> combine</span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">|</span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>Why <code class="tt">code 1</code> cannot keep the order of the children and we need <code class="tt">code 2</code> to keep the order to use <code class="tt">combine(...)</code> method ?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-895378 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-895378 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-895378">
            <li>
<div class="comment">
    <table class="comment-table" commentid="895422" commentparentid="895378">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Misuki" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/e4ea7bc4debf5d23.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Misuki" title="Master Misuki" class="rated-user user-orange">Misuki</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/13/2022 15:06 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-895422" href="https://codeforces.com/blog/entry/18051?#comment-895422" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-895378" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="895422" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="895422" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1197572" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-895422">
                    <div class="moveup">
                    <div class="ttypography"><p>There is no big different when you compare their modify function, the most important different is when you do non-commutative query, you should keep two empty node(let's call it left/right node), and during the query, if t[l] need to be combine, you should combine it to left node, when t[r] need to be combine, you should combine it to right node, and combine left node and right node in the end.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-895422 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-895422 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-895422">
            <li>
<div class="comment">
    <table class="comment-table" commentid="895889" commentparentid="895422">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/abhi.agr" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/abhi.agr" title="Pupil abhi.agr" class="rated-user user-green">abhi.agr</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/15/2022 05:59 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-895889" href="https://codeforces.com/blog/entry/18051?#comment-895889" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-895422" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="895889" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="895889" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="2361" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-895889">
                    <div class="moveup">
                    <div class="ttypography"><p>Thanks for explaining it. Can <code class="tt">code 1</code> changed as below to keep order — </p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">void</span><span class="pln"> modify</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="pln">p </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">;</span><span class="pln"> p </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> p </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">p</span><span class="pun">^</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> 
          t</span><span class="pun">[</span><span class="pln">p </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> combine</span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">],</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">^</span><span class="lit">1</span><span class="pun">])</span><span class="pln">
       </span><span class="kwd">else</span><span class="pln">
           t</span><span class="pun">[</span><span class="pln">p </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> combine</span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">^</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">])</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-895889 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-895889 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-895889">
            <li>
<div class="comment">
    <table class="comment-table" commentid="896019" commentparentid="895889">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Misuki" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/e4ea7bc4debf5d23.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Misuki" title="Master Misuki" class="rated-user user-orange">Misuki</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/15/2022 20:36 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-896019" href="https://codeforces.com/blog/entry/18051?#comment-896019" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-895889" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="896019" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="896019" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="896019" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1197572" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-896019">
                    <div class="moveup">
                    <div class="ttypography"><p>Actually both code1 and code2 keep their order.The reason why author use combine() instead of + in code2 is to convey that the data we want to maintain is no longer commutative(unlike"+" operation). </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-896019 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-896019 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-896019">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="898001" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Kofta" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/f17f10357bb5c699.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Kofta" title="Candidate Master Kofta" class="rated-user user-violet">Kofta</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/24/2022 03:17 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-898001" href="https://codeforces.com/blog/entry/18051?#comment-898001" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="898001" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="898001" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="898001" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="357268" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-898001">
                    <div class="moveup">
                    <div class="ttypography"><pre><code class="prettyprint prettyprinted" style=""><span class="typ">Non</span><span class="pun">-</span><span class="pln">commutative combiner functions</span><span class="pun">:</span><span class="pln"> </span><span class="typ">In</span><span class="pln"> method build we just change </span><span class="pun">+</span><span class="pln"> to combine </span><span class="kwd">function</span></code></pre><p>If I have only 3 elements, t[1] should be combine(t[3], t[2]), but I think this algorithms does combine(t[2], t[3]), If I'm not mistaken I think it doesn't work on non-perfect binary tree</p><p>Same goes for modifying function</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-898001 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-898001 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-898001">
            <li>
<div class="comment">
    <table class="comment-table" commentid="903140" commentparentid="898001">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Misuki" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/e4ea7bc4debf5d23.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Misuki" title="Master Misuki" class="rated-user user-orange">Misuki</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/10/2022 18:21 UTC+7">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-903140" href="https://codeforces.com/blog/entry/18051?#comment-903140" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-898001" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="903140" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="903140" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="1197572" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-903140">
                    <div class="moveup">
                    <div class="ttypography"><p>If you only have 3 element in your segment tree, t[1] will be useless because element 1 will be stored in t[3], element 2 in t[4], element 3 in t[5].</p><p>when you do query/modify on this segment tree, you will only use t[2], t[3], t[4], t[5].</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-903140 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-903140 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-903140">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="927416" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/amanmalik30006" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/65e533bfe5ccc9fb.jpg">        </a>
        <div><a href="https://codeforces.com/profile/amanmalik30006" title="Pupil amanmalik30006" class="rated-user user-green">amanmalik30006</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/01/2022 05:21 UTC+7">22 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-927416" href="https://codeforces.com/blog/entry/18051?#comment-927416" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="927416" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="927416" class="CommentVoteFrame" data-commentrating="-10" data-commentuserid="1819640" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-10</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-927416">
                    <div class="moveup">
                    <div class="ttypography"><p>why is it not working for long long int can someone explain </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-927416 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-927416 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-927416">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="928656" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Psychotic_D" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/c659feafc7ff4469.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Psychotic_D" title="Master Psychotic_D" class="rated-user user-orange">Psychotic_D</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/05/2022 23:34 UTC+7">22 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-928656" href="https://codeforces.com/blog/entry/18051?#comment-928656" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="928656" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="928656" class="CommentVoteFrame" data-commentrating="-15" data-commentuserid="2271976" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-15</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-928656">
                    <div class="moveup">
                    <div class="ttypography"><p>If I want to make tree node can take 4 values {suffix,prefix,sum,segment maximum sum}.</p><p>How can I build or modify tree by this non recursive method??<a class="rated-user user-red" href="https://codeforces.com/profile/Al.Cash" title="Grandmaster Al.Cash">Al.Cash</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-928656 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-928656 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-928656">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="929072" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/antsparrow5" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/antsparrow5" title="Specialist antsparrow5" class="rated-user user-cyan">antsparrow5</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/07/2022 14:33 UTC+7">21 month(s) ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-929072" href="https://codeforces.com/blog/entry/18051?#comment-929072" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="929072" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="929072" class="CommentVoteFrame" data-commentrating="-25" data-commentuserid="2663610" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-25</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-929072">
                    <div class="moveup">
                    <div class="ttypography"><p>Great I will try to code this</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-929072 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-929072 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-929072">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="948010" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/stakudog" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/3e4a34a5b7f88047.jpg">        </a>
        <div><a href="https://codeforces.com/profile/stakudog" title="Specialist stakudog" class="rated-user user-cyan">stakudog</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/30/2022 12:39 UTC+7">20 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-948010" href="https://codeforces.com/blog/entry/18051?#comment-948010" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="948010" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="948010" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="2521102" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-948010">
                    <div class="moveup">
                    <div class="ttypography"><p>Hey, I just wanna say you are one of the first red coders whose explanation I could understand so easily. Great job! </p><p>(edit: apparently I got some necropost warning. Bracing myself)</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-948010 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-948010 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-948010">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="1004983" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/UtTaRaN" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/59901f5b2a6371bd.jpg">        </a>
        <div><a href="https://codeforces.com/profile/UtTaRaN" title="Newbie UtTaRaN" class="rated-user user-gray">UtTaRaN</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/15/2023 06:30 UTC+7">14 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-1004983" href="https://codeforces.com/blog/entry/18051?#comment-1004983" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="1004983" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="1004983" class="CommentVoteFrame" data-commentrating="-8" data-commentuserid="1925213" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-8</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-1004983">
                    <div class="moveup">
                    <div class="ttypography"><p>Can this question <a href="https://cses.fi/problemset/task/1143">CSES-Hotel Queries</a> be solved using this? I can't write a search function that will search first index greater than or equal to given value.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-1004983 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-1004983 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-1004983">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="1069803" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Naveen_Kumar101" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/1fc978e51545d622.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Naveen_Kumar101" title="Newbie Naveen_Kumar101" class="rated-user user-gray">Naveen_Kumar101</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Sep/21/2023 07:15 UTC+7">7 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-1069803" href="https://codeforces.com/blog/entry/18051?#comment-1069803" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="1069803" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="1069803" revisioncount="3" revision="3">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">3</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="1069803" class="CommentVoteFrame" data-commentrating="-10" data-commentuserid="2348214" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-10</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-1069803">
                    <div class="moveup">
                    <div class="ttypography"><p>Thanks Al.Cash for the awesome version of segment tree. Once you understand it, it really is super simple! Far better than recursive.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-1069803 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-1069803 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-1069803">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="1069949" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/minhvu08kt" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/3c2039b0682a4b4.jpg">        </a>
        <div><a href="https://codeforces.com/profile/minhvu08kt" title="Newbie minhvu08kt" class="rated-user user-gray">minhvu08kt</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Sep/22/2023 00:51 UTC+7">7 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-1069949" href="https://codeforces.com/blog/entry/18051?#comment-1069949" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="1069949" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="1069949" revisioncount="5" revision="5">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">5</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="1069949" class="CommentVoteFrame" data-commentrating="-8" data-commentuserid="3320583" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-8</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-1069949">
                    <div class="moveup">
                    <div class="ttypography"><p>Easier version for beginner to read( i don't think so...)</p> <pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;iostream&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;vector&gt;</span><span class="pln">

</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e5</span><span class="pun">;</span><span class="pln">  </span><span class="com">// Limit for array size</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">              </span><span class="com">// Array size</span><span class="pln">
vector</span><span class="str">&lt;int&gt;</span><span class="pln"> t</span><span class="pun">(</span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> N</span><span class="pun">);</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> build</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">&amp;</span><span class="pln">mdash</span><span class="pun">;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> </span><span class="pun">--</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">i </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">i </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> modify</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  t</span><span class="pun">[</span><span class="pln">p </span><span class="pun">+</span><span class="pln"> n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">value</span><span class="pun">;</span><span class="pln">

  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> p </span><span class="pun">+</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">/=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    t</span><span class="pun">[</span><span class="pln">i </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> t</span><span class="pun">[(</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)];</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> query</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
  l</span><span class="pun">--;</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">&lt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> l </span><span class="pun">/=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">/=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      res </span><span class="pun">+=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">l</span><span class="pun">++];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      res </span><span class="pun">+=</span><span class="pln"> t</span><span class="pun">[--</span><span class="pln">r</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">

  </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">

  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> i</span><span class="pun">];</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">

  build</span><span class="pun">();</span><span class="pln">
  
  modify</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">

  </span><span class="kwd">int</span><span class="pln"> result </span><span class="pun">=</span><span class="pln"> query</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">);</span><span class="pln">
  cout </span><span class="pun">&lt;&lt;</span><span class="pln"> result </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">

  </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-1069949 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-1069949 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-1069949">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="1070329" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/ash88" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/ash88" title="Specialist ash88" class="rated-user user-cyan">ash88</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Sep/22/2023 22:41 UTC+7">7 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-1070329" href="https://codeforces.com/blog/entry/18051?#comment-1070329" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="1070329" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="1070329" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="2213963" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-1070329">
                    <div class="moveup">
                    <div class="ttypography"><p>thanks man</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-1070329 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-1070329 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-1070329">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="1084363" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/MermaidMolester" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/MermaidMolester" title="Master MermaidMolester" class="rated-user user-orange">MermaidMolester</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Nov/11/2023 01:50 UTC+7">5 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-1084363" href="https://codeforces.com/blog/entry/18051?#comment-1084363" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="1084363" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="1084363" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="733942" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-1084363">
                    <div class="moveup">
                    <div class="ttypography"><p>Is it possible to implement functions such as Finding subsegments with the maximal sum with this implementation?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-1084363 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-1084363 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-1084363">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="1128372" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/xuan-nguyen" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/xuan-nguyen" title="Unrated, xuan-nguyen" class="rated-user user-black">xuan-nguyen</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/16/2024 03:57 UTC+7">5 weeks ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-1128372" href="https://codeforces.com/blog/entry/18051?#comment-1128372" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="1128372" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="1128372" revisioncount="3" revision="3">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">3</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="1128372" class="CommentVoteFrame" data-commentrating="-8" data-commentuserid="3271607" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-8</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-1128372">
                    <div class="moveup">
                    <div class="ttypography"><p>Hello,</p><p>Thanks for the wonderful post!</p><p>Beside saving memory, did anyone compare real speed (not BigO) of "range query" and "range update" with "lazy propagation" between this bottom-up and the classical top-down?</p><p>From the code with extra calls push() (aka. pushDown) and build() (aka. popUp), I guess that the bottom-up is 3x slower than the top-down solution, right?</p><p>What are the limitations of the bottom-up solution you experienced so far?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-1128372 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-1128372 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-1128372">
            <li>
<div class="comment">
    <table class="comment-table" commentid="1128656" commentparentid="1128372">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/xuan-nguyen" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/xuan-nguyen" title="Unrated, xuan-nguyen" class="rated-user user-black">xuan-nguyen</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/16/2024 19:00 UTC+7">5 weeks ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-1128656" href="https://codeforces.com/blog/entry/18051?#comment-1128656" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/18051#comment-1128372" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="1128656" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="1128656" revisioncount="4" revision="4">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">4</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="1128656" class="CommentVoteFrame" data-commentrating="0" data-commentuserid="3271607" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-1128656">
                    <div class="moveup">
                    <div class="ttypography"><p>Not sure why people down vote my questions? I am sorry if my questions are stupid. I would like to understand the down vote reasons so I could improve my communication with this community. I saw that a previous comment, just saying "Great Tutorial !!!" got -28 down votes. What's going on here?</p><p>To be emphasized, I am asking only about the "lazy propagation" version. The simple version without it, is for sure faster than top-down solution.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-1128656 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-1128656 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-1128656">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="1138724" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/a_gt3_rs" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/d717ea812cc0e530.jpg">        </a>
        <div><a href="https://codeforces.com/profile/a_gt3_rs" title="Pupil a_gt3_rs" class="rated-user user-green">a_gt3_rs</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/10/2024 16:56 UTC+7">10 days ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-1138724" href="https://codeforces.com/blog/entry/18051?#comment-1138724" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img style="cursor: pointer" class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="1138724" data-size="12" src="./Efficient and easy segment trees - Codeforces_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="1138724" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/18051#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="1138724" class="CommentVoteFrame" data-commentrating="-12" data-commentuserid="3313305" style="position:relative;">
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-12</span></span>
<a href="https://codeforces.com/blog/entry/18051#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./Efficient and easy segment trees - Codeforces_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                    </div>
                </div>
                <div class="comment-content comment-content-1138724">
                    <div class="moveup">
                    <div class="ttypography"><p>The push function if called with a range of 1 doesn't need the r variable, so one can create a push1 function (which only pushes 1 element). It actually provided me with a 2x speedup in <a href="https://codeforces.com/contest/1440/problem/E" title="Codeforces Round 684 (Div. 2)">1440E - Greedy Shopping</a>.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-1138724 en false" href="https://codeforces.com/blog/entry/18051#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-1138724 en false" href="https://codeforces.com/blog/entry/18051#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-1138724">
    </ul>
</div>
        <br>

<div id="editBox-18130" style="width:50em;display:none;">
    <div class="previewBody" style="border: 1px solid #d4d4d4; margin-bottom: 0.5em; padding: 0.25em; display:none;">&nbsp;</div>
    <div style="width: 1px">&nbsp;</div>
    <div class="commentLocale" style="position: relative; top: 0.5em;left:4px;display: none;">
        <input type="radio" name="locale" value="en"><span style="font-size: 1.2rem;position: relative; bottom: 3px;">In English</span>
        <input style="margin-left:1em" type="radio" name="locale" value="ru"><span style="font-size: 1.2rem;position: relative; bottom: 3px;">In Russian</span>
    </div>
    <textarea data-drafts-id="CommentReplyFrame" class="wysiwyg" name="editContent" rows="20" style="width:99%;"></textarea>
    <div class="error error__content"></div>
    <div style="text-align:center;">
        <input type="button" name="preview" style="padding: 0.25em 1em; margin-top: 1em; min-width: 6.5em;" value="Preview">
        <input type="button" name="save" style="padding: 0.25em 1em; margin-top: 1em; min-width: 6.5em;" value="Save">
    </div>
</div>

    <script type="text/javascript">
        $(document).ready(function () {

var firstPreview18130 = true;
var lastPreviewContent18130 = '';

if (!window.moveCommentRevision) {
    moveCommentRevision = function(e, dir) {
        var p = e.parent();
        var revisionCount = parseInt(p.attr("revisionCount"));
        var revision = parseInt(p.attr("revision"));
        var next = revision + dir;
        var commentId = p.attr("commentId");
        if (next >= 1 && next <= revisionCount) {
            $.post(
                "/data/comment-data",
                {action: "revision", commentId: commentId, revision: next},
                function(json) {
                    if (json.success == "true") {
                        var parentDiv = e;

                        while (parentDiv !== null && (parentDiv[0].nodeName.toLowerCase() !== "td" || !parentDiv.hasClass("right"))) {
                            parentDiv = parentDiv.parent();
                        }

                        if (parentDiv === null) {
                            return;
                        }

                        parentDiv.find("div.comment-content-" + commentId + " .moveup").html(json.content);
                        Codeforces.setupSpoilers(parentDiv.find("div.comment-content-" + commentId + " .moveup"));
                        p.attr("revision", next);
                        p.find("span.revision").text(next);
                        if (next == 1) {
                            p.find("a.leftRevision").css("visibility", "hidden");
                        } else {
                            p.find("a.leftRevision").css("visibility", "visible");
                        }
                        if (next == revisionCount) {
                            p.find("a.rightRevision").css("visibility", "hidden");
                        } else {
                            p.find("a.rightRevision").css("visibility", "visible");
                        }

                        window.updateTypography();
                        MathJax.Hub.Typeset();
                    } else {
                        alert(e.error);
                    }
                },
                "json"
            );
        }
    };
}

$("div[commentableId=18130] a.leftRevision").click(function () {
    window.moveCommentRevision($(this), -1);
    return false;
});

$("div[commentableId=18130] a.rightRevision").click(function () {
    window.moveCommentRevision($(this), +1);
    return false;
});

    $("div[commentableId=18130] a.editCommentLink").click(function () {
        if (confirm("You may edit your comment only for fixing grammar mistakes or small changes. Do not change the main idea of your comment. All previous revisions are available for others. Are you sure you want to edit comment?")) {
            Codeforces.facebox("#editBox-18130", "//codeforces.org/s/68729");
            firstPreview18130 = true;
            lastPreviewContent18130 = '';
            $("#facebox #editBox-18130 textarea.wysiwyg").drafts({textDrafts: "Drafts", textUseIt: "Use it", url: "/data/draft", saveErrorMessage: "Can't save draft. Possibly connection is lost or session is expired. Stay on the page (cancel to reload)?"});
            var commentId = $(this).attr("commentId");
            $.post("/data/comment-data", {action: "content", commentId: commentId}, function(json) {
                if (json["success"] != "true") {
                    alert(json["error"]);
                    return;
                }
                var content = json["content"];
                $("#facebox #editBox-18130 textarea.wysiwyg").val(content);

                if (json["allowChangeLocale"] == "true") {
                    $("#facebox #editBox-18130 .commentLocale").css("display", "");
                }

                var commentLocale = json["commentLocale"];
                if (commentLocale == "en") {
                    $("#facebox #editBox-18130 .commentLocale input[value=en]").prop("checked", true);
                } else {
                    $("#facebox #editBox-18130 .commentLocale input[value=ru]").prop("checked", true);
                }

                $("#facebox #editBox-18130 textarea.wysiwyg").css("width", "97%").markItUp(commentSettings).css("height", "200px").focus();

                $("#facebox #editBox-18130 input[name='save']").click(function () {
                    var content = $("#facebox #editBox-18130 textarea.wysiwyg").val();
                    var locale = $("#facebox #editBox-18130 input[name=locale]:checked").val();
                    $.post(
                        "/data/comment-data",
                        {action: "update", commentId: commentId, content: content, locale: locale, subscribedCommentLinkInfix: "wxKhGbdge_BJ8WoFGCOspPos8X4*/blog/entry/18051"},
                        function(json) {
                            if (json.success == "true") {
                                Codeforces.reload();
                            } else {
                                $("#facebox #editBox-18130 div.error__content").text(json.error__content);
                                window.updateTypography();
                            }
                        },
                        "json"
                    );

                    return false;
                });

                $("#facebox #editBox-18130 input[name='preview']").click(function () {
                    var content = $("#facebox #editBox-18130 textarea[name='editContent']").val();
                    if (firstPreview18130 || lastPreviewContent18130 != content) {
                        firstPreview18130 = false;
                        lastPreviewContent18130 = content;
                        commentPreviewShow18130(commentId);
                    }
                    return false;
                });
            }, "json");
        }
        return false;
    });

    var commentPreviewShow18130 = function(commentId) {
        var content = $("#facebox #editBox-18130 textarea[name='editContent']").val();
        var replyLocale = $("#facebox #editBox-18130 input[name=locale]:checked").val();
        $.post(
        "/data/comment-data", {action: "preview", replyLocale: replyLocale, content: content, commentId: commentId},
            function(json) {
                if (json.success == "true") {
                    $("#facebox #editBox-18130 .previewBody").html("<div style='font-size: 1.2rem;'>Comment preview:<hr/></div><div class='comment-content' style='position: relative; bottom: 12px;'>" + json.response + "</div>").fadeIn();
                    Codeforces.setupSpoilers($("#facebox #editBox-18130 .previewBody"));
                    MathJax.Hub.Typeset();
                } else {
                    $("#facebox #editBox-18130 .previewBody").html("<div><b style='color:red;'>Comment preview error:</b><hr/><div>" + json.error__content).fadeIn();
                }
                window.updateTypography();
            },
            "json"
        );
        return false;
    };

    $("div[commentableId=18130] a.deleteCommentLink").click(function () {
        if (confirm("Are you sure you want to delete this comment?")) {
            var commentId = $(this).attr("commentId");
            $.post("/data/comment-data", {action: "delete", commentId: commentId}, function(json) {
                if (json.success == "true") {
                    Codeforces.reload();
                } else {
                    alert(json.error);
                }
            }, "json");
        }
        return false;
    });

        });
    </script>

<div class="comment comment-reply-prototype" style="display:none;">
        <table class="comment-table" style="width: 100%;">
            <tbody><tr>
                <td class="left">
    <div class="avatar">
        <a href="https://codeforces.com/profile/epiccodingmomento" style="position: relative;">
<img src="./Efficient and easy segment trees - Codeforces_files/c8a417d4a6134f2d.jpg">        </a>
        <div><a href="https://codeforces.com/profile/epiccodingmomento" title="Newbie epiccodingmomento" class="rated-user user-gray">epiccodingmomento</a></div>
    </div>
                </td>
                <td class="right" style="padding:1em 0 1em 1em;">
                    <form action="https://codeforces.com/blog/entry/18051" method="post" class="commentReplyForm"><input type="hidden" name="csrf_token" value="d8fb8d4ba7a52d3204c987c69587f6fc">
                        <input type="hidden" name="commentReplyFormSubmitted" value="true">
                        <input type="hidden" name="commentId">
                        <input type="hidden" name="hasMaximalDepth">
                        <input type="hidden" name="commentableId">
                        <table class="table-form" style="width:100%;">
                            <tbody><tr>
                                <td style="width: 1px">&nbsp;</td><td>
                                <div style="position: relative; top: 0.5em;left:4px;">
                                    <input type="radio" name="locale" value="en"><span style="font-size: 1.2rem;position: relative; bottom: 3px;">In English</span>
                                    <input style="margin-left:1em" type="radio" name="locale" value="ru"><span style="font-size: 1.2rem;position: relative; bottom: 3px;">In Russian</span>
                                </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 1px;">&nbsp;</td><td>
                                    <div class="previewBody" style="border: 1px solid #d4d4d4; margin-bottom: 0.5em; padding: 0.25em; display:none;">&nbsp;</div>
                                    <textarea data-drafts-id="CommentReplyFrame" class="no-wysiwyg" name="replyContent" rows="10" style="width: 100%;"></textarea>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" valign="top">
                                        <div style="float:left; margin-left:6px;" class="smaller notice">This post was published a long time ago. Please refrain from commenting unless you have a really reasonable cause to leave a comment. Necroposting is discouraged by the community.</div>

                                    <div style="float: left;" class="small">
         <div class="shiftUp error__commentWithId">
             <span class="error for__commentWithId " style="display: none;">&nbsp;</span>
             <span class="notice for__commentWithId ">&nbsp;</span>
         </div>
         <div class="shiftUp error__content">
             <span class="error for__content " style="display: none;">&nbsp;</span>
             <span class="notice for__content ">&nbsp;</span>
         </div>
                                    </div>
                                    <div style="position: relative; right: 4px;text-align:right;">
                                        <div style="position: relative; display: inline-block;">
                                            <img style="left:-24px;" class="ajax-loading-gif" src="./Efficient and easy segment trees - Codeforces_files/ajax-loading-16x16.gif">
                                            <input style="font-size: 0.7em;height:1.8em;padding:0 0.75em;" type="submit" name="submit" value="Post">
                                            <input style="font-size: 0.7em;height:1.8em;padding:0 0.75em;" type="button" class="preview" value="Preview">
                                            <input style="font-size: 0.7em;height:1.8em;padding:0 0.75em;" type="button" class="cancel" value="Cancel">
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tbody></table>
                    <input type="hidden" name="_tta" value="12"></form>
                </td>
            </tr>
        </tbody></table>
</div>

        <script type="text/javascript">
            $(function() {
                window._ftaa = "auzb0x5ppktavo7qzl";
            })
        </script>

        <script type="text/javascript">
            $(function() {
                window._bfaa = "cc66c92025c4fce98bed273dbaaf3ae0";
            });
        </script>

    <script type="text/javascript">
        $(document).ready(function () {
    var commentPreviewListener = function(div) {
        var content = div.find("textarea").val();
        var replyLocale = div.find('input[name=locale]:checked').val();

        $.post(
            "/data/comment-data",
            {action: "preview", replyLocale: replyLocale, content: content},
            function(json) {
                if (json.success == "true") {
                    div.find(".previewBody").html("<div style='font-size: 1.2rem;'>Comment preview:<hr/></div><div class='comment-content' style='position: relative; bottom: 12px;'>" + json.response + "</div>").fadeIn();
                    Codeforces.setupSpoilers(div.find(".previewBody"));
                    MathJax.Hub.Typeset();
                } else {
                    div.find(".previewBody").html("<div><b style='color:red;'>Comment preview error:</b><hr/><div>" + json.error__content).fadeIn();
                }
                window.updateTypography();
            },
            "json"
        );

        return false;
    }

    var commentReplyFormSubmitListener = function () {
            if (!confirm("The post on which you are writing a comment was written a long time ago. Please refrain from commenting unless you have a really reasonable cause to leave a comment. Necroposting is discouraged by the community. Are you sure you want to publish the comment?")) {
                return false;
            }

        var id = $(this).attr("id");
        var hasMaximalDepth = $(this).find("input[name=hasMaximalDepth]").val() || "false";
        var commentWithId = $(this).find("input[name=commentId]").val() || "";
        var content = $(this).find("textarea").val();
        var commentableId = $(this).find("input[name=commentableId]").val() || 0;
        var commentReplyFormSubmitted = $(this).find("input[name=commentReplyFormSubmitted]").val();
        var replyLocale = $(this).find('input[name=locale]:checked').val();

        var postNewCommentReply = function () {
            $.post(
                "/data/new-comment-reply",
                {ftaa: window._ftaa, bfaa: window._bfaa, commentWithId:     commentWithId, content: content, commentReplyFormSubmitted: commentReplyFormSubmitted, _tta: Codeforces.tta(), replyLocale: replyLocale, commentableId: commentableId, subscribedCommentLinkInfix: "wxKhGbdge_BJ8WoFGCOspPos8X4*/blog/entry/18051"},
                function(data) {
                    var invalid = Codeforces.setAjaxFormErrors("#" + id , data);
                    var newCommentWithId = data.newCommentWithId;
                    if (!invalid) {
                        var s = window.location.toString();
                        var found = false;
                        for (var i = 0; i < s.length; i++)
                            if (s.charAt(i) == '#') {
                                found = true;
                                index = i;
                            }
                        if (!found) {
                            s += "#" + newCommentWithId;
                        } else {
                            s = s.substr(0, index + 1) + newCommentWithId;
                        }
                        window.location = s;
                        window.location.reload();
                    }
                },
                "json"
            );
        };

        $.post("/data/checkTextForRussianLanguage", { text: content }, function(response) {
            var isRussianComment = response["isRussianComment"];
            if (replyLocale == "en" && isRussianComment == "true") {
                Codeforces.confirm(
                    "Are you sure that your comment in English?",
                    postNewCommentReply, function () { },
                    "Yes", "No"
                );
            } else if (replyLocale == "ru" && isRussianComment == "false") {
                Codeforces.confirm(
                    "Are you sure that your comment in Russian?",
                    postNewCommentReply, function () { },
                    "Yes", "No"
                );
            } else {
                postNewCommentReply();
            }
        }, "json");

        return false;
    }
    $("a.new-root-comment").click(function () {
            var a = $(this);
            a.hide();

            var commentableId = $(".comments").attr("commentableId");
            var e = $(".comment-reply-prototype").clone().removeClass("comment-reply-prototype");

            var div = $("<div></div>").append(e);
            var p = $(this).parent().parent();
            p.append(div);
            e.show();

            e.find("input[value=en]").attr("checked", true);
            e.find("input[name=commentableId]").attr("value", commentableId);
            e.find("form").submitOnce(commentReplyFormSubmitListener, true);
            e.find("form").attr("id", "form-" + (new Date().getTime()));

            div.find('textarea.no-wysiwyg').css("width", "97%").markItUp(commentSettings).css("height", "200px");
            div.find('textarea.no-wysiwyg').removeClass("no-wysiwyg");
            div.find('textarea').drafts({textDrafts: "Drafts", textUseIt: "Use it", url: "/data/draft", saveErrorMessage: "Can't save draft. Possibly connection is lost or session is expired. Stay on the page (cancel to reload)?"});
            div.find('textarea').focus();

            var first = true;
            div.find(".cancel").each(function () {
                if (first) {
                    $(this).click(function () {
                        div.remove();
                        a.show();
                        return false;
                    });
                    first = false;
                }
            });

            first = true;
            div.find(".preview").each(function () {
                if (first) {
                    $(this).click(function () {
                        commentPreviewListener(div);
                        return false;
                    });
                    first = false;
                }
            });
        return false;
    });

    $(".comment-table .reply a").click(function () {
            var classes = this.className.split(" ");
            var commentId = classes[0];
            var locale = classes[1];
            var hasMaximalDepth = classes[2];
            var commentableId = $(".comments").attr("commentableId");

            showReplyWindow = function () {
                $(".current-comment-reply").remove();
                var e = $(".comment-reply-prototype").clone().removeClass("comment-reply-prototype").addClass("current-comment-reply");

                var li = $("<li></li>").append(e);
                var ul = $(".comment ul." + commentId);
                ul.prepend(li);
                e.show();
                e.find("input[name=commentId]").attr("value", commentId);
                e.find("input[name=hasMaximalDepth]").attr("value", hasMaximalDepth);
                e.find("input[value=" + locale + "]").attr("checked", true);
                e.find("input[name=locale]").attr("readonly", true);
                e.find("input[name=locale]").attr("disabled", true);
                e.find("input[name=commentableId]").attr("value", commentableId);
                e.find("form").submitOnce(commentReplyFormSubmitListener, true);
                e.find("form").attr("id", "form-" + (new Date().getTime()));

                li.find('textarea').css("width", "97%").markItUp(commentSettings).css("height", "200px").focus();

                setTimeout(function () {
                    li.find('textarea').drafts({textDrafts: "Drafts", textUseIt: "Use it", url: "/data/draft", saveErrorMessage: "Can't save draft. Possibly connection is lost or session is expired. Stay on the page (cancel to reload)?"});
                }, 1000);

                var first = true;
                ul.find(".cancel").each(function () {
                    if (first) {
                        $(this).click(function () {
                            li.remove();
                            return false;
                        });
                        first = false;
                    }
                });

                first = true;
                ul.find(".preview").each(function () {
                    if (first) {
                        $(this).click(function () {
                            commentPreviewListener(ul);
                        });
                        first = false;
                    }
                });
            }

            if (hasMaximalDepth == "true") {
                Codeforces.confirm("The debates reached maximal permitted depth, so your message and the message you are replying will be displayed on the same level. Are you sure you want to reply to the message?", showReplyWindow, function () { }, "Yes", "No");
            } else {
                showReplyWindow();
            }
        return false;
    });
        });
    </script>
    <script type="text/javascript">
        $(document).ready(function () {
    $(".vote-for-comment").mouseover(function () {
        var vote = $(this);
        var direction = vote.attr("voteDirection");
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = commentUserId==2614386;
        if (direction == 1 && !ownComment) {
            vote.find("img").attr("src", "//codeforces.org/s/68729/images/actions/comment-voteup.png");
            vote.find("img").attr("popacity", vote.find("img").css("opacity"));
            vote.find("img").css("opacity", "1.0");
        }
        if (direction == -1 && !ownComment) {
            vote.find("img").attr("src", "//codeforces.org/s/68729/images/actions/comment-votedown.png");
            vote.find("img").attr("popacity", vote.find("img").css("opacity"));
            vote.find("img").css("opacity", "1.0");
        }
    });

    $(".vote-for-comment").mouseout(function () {
        var vote = $(this);
        var direction = vote.attr("voteDirection");
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = commentUserId==2614386;
        if (direction == 1 && !ownComment) {
            vote.find("img").attr("src", "//codeforces.org/s/68729/images/actions/comment-voteup-blue.png");
            vote.find("img").css("opacity", vote.find("img").attr("popacity"));
        }
        if (direction == -1 && !ownComment) {
            vote.find("img").attr("src", "//codeforces.org/s/68729/images/actions/comment-votedown-blue.png");
            vote.find("img").css("opacity", vote.find("img").attr("popacity"));
        }
    });

    $(".vote-for-comment").click(function () {
        var vote = $(this);
        var commentId = $(this).parent().attr("commentid");
        var commentRating = $(this).parent().attr("data-commentRating");
        var direction = $(this).attr("voteDirection");
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = commentUserId==2614386;
        $.post("/data/comment/vote", {commentId: commentId, _tta: Codeforces.tta(), vote: direction, commentRating: commentRating}, function(data) {
            if (direction != 0 && !ownComment && data["success"] == "true") {
                vote.parent().find(".vote-for-comment").attr("voteDirection", 0);
                if (direction == 1)
                    vote.find("img").attr("src", "//codeforces.org/s/68729/images/actions/comment-voteup.png");
                else {
                    vote.find("img").attr("src", "//codeforces.org/s/68729/images/actions/comment-votedown.png");
                    vote.closest(".CommentVoteFrame").find(".ComplaintFrame").css("display", "inline-block");
                }
                vote.find("img").attr("popacity", "1.0");
                vote.find("img").css("opacity", "1.0");
                vote.parent().find(".commentRating").html(data["commentRating"]);
            }
            Codeforces.showMessage(data["message"]);
        }, "json");
        return false;
    });

    $(".negative-comment-vote").closest(".comment-table").addClass("comment-bad");

    $(".troll-comment-vote").closest(".comment").css("display", "none");

    $(".too-negative-comment-vote").closest(".comment-table").each(function () {
        var e = $(this);
        e.addClass("comment-too-bad");
        var commentId = e.attr("commentId");
        $("<div class='bad-comment-replacement ttypography'>The comment is hidden because of too negative feedback, click <a href=# class=show-bad-comment-link>here</a> to view it</div>").appendTo(
            e.find(".right")
        );
        e.find(".comment-content").hide();
        e.find(".show-bad-comment-link").click(function () {
            e.find(".comment-content").show();
            e.find(".bad-comment-replacement").hide();
            return false;
        });
    });
        });
    </script>
    </div>

    <style type="text/css">
        .new-comments-box {
            padding: 0.5em;
            width: 22px;
            font-size: 1.3rem;
            font-weight: bold !important;

            position: fixed;
            top: 40%;
            right: 0;
            opacity: 0.2;
            color: white;
            text-align: center;

            border: 1px solid #222;
            background-color: #888 !important;
            border-radius: 3px;
            -moz-border-radius: 3px;
            -webkit-border-radius: 3px;
        }

        .new-comments-box:hover {
            opacity: 1;
        }

        .new-comments-box .dir:hover {
            background: #3B5998 !important;
            cursor: pointer;
        }
    </style>

    <div class="new-comments-box" data-position="outside" data-index="-1" style="display: none;">
        <div class="up dir" title="Ctrl+Up">↑<hr>
        </div>
        <div class="info" title="New comments"></div>
        <div class="down dir" title="Ctrl+Down">
            <hr>↓
        </div>
    </div>

    <script>
        $(".show-archived-checkbox").change(function () {
            const checked = $(this).is(":checked");
            $.post("/data/comment-data", {action: "setShowArchived", checked}, function (json) {
                if (json["success"] !== "true") {
                    alert(json["error"]);
                } else {
                    if (checked) {
                        Codeforces.reloadAndShowMessage("Archived comments are now displayed")
                    } else {
                        Codeforces.reloadAndShowMessage("Archived comments are no longer displayed")
                    }
                }
            });
            return false;
        });

        function gotoComment(direction) {
            var box = $(".new-comments-box");
            var index = parseInt(box.attr("data-index"));
            if (index == -1)
                index = 0;
            else
                index = Math.max(0, Math.min(parseInt(box.find(".info").text()) - 1, index + direction));
            box.attr("data-index", index);
            var comment = $($(".comment .highlight-blue[commentId]").get(index));
            $('html, body').animate({
                'scrollTop': Math.max(0, comment.offset().top - ($(window).height() - comment.height()) / 2)
            });
            return false;
        }

        $(".new-comments-box .down").click(function () {
            return gotoComment(1);
        });

        $(".new-comments-box .up").click(function () {
            return gotoComment(-1);
        });

        $(document).keydown(function (e) {
            var code = (e.keyCode ? e.keyCode : e.which);
            if (e.ctrlKey) {
                if (code == 38 || code == 40) {
                    gotoComment(code - 39);
                }
            }
        });

        var newCommentCount = $(".comment .highlight-blue[commentId]").length;
        if (newCommentCount > 0) {
            $(".new-comments-box .info").text(newCommentCount);
            $(".new-comments-box").show();
        }

        $('table.comment-table').mouseenter(function () {
            var comment = $(this);
            var cnt = 0;
            while (true) {
                var id = comment.attr("commentId");
                var parentId = comment.attr("commentParentId");
                comment.find(".comment-indent-holder:first .comment-no-indent").addClass("comment-indent");
                if (parentId == -1) {
                    break;
                }
                comment = $("table.comment-table[commentId=" + parentId + "]");
            }
            return false;
        });

        $('table.comment-table').mouseleave(function () {
            var comment = $(this);
            var cnt = 0;
            while (true) {
                var id = comment.attr("commentId");
                var parentId = comment.attr("commentParentId");
                comment.find(".comment-indent-holder:first .comment-no-indent").removeClass("comment-indent");
                if (parentId == -1) {
                    break;
                }
                comment = $("table.comment-table[commentId=" + parentId + "]");
            }
            return false;
        });
    </script>



    <script>
        function adjustTopicComplainFrames() {
            let topicIds = [];

            $(".has-topic-id").each(function () {
                const $this = $(this);
                const topicId = $this.attr("topicId");
                if (topicId) {
                    topicIds.push(topicId);
                }
            });

            $.post("/data/topics", {
                action: "findComplainableTopicIds",
                topicIds: topicIds.join(",")
            }, function (json) {
                if (json["success"] === "true") {
                    for (const topicId of json["complainableTopicIds"].split(",")) {
                        $(".has-topic-id[topicId=" + topicId + "]").each(function () {
                            $(this).find(".meta .ComplaintFrame").css("display", "inline-block");
                        });
                    }
                }
            }, "json");
        }

        $(function () {
            adjustTopicComplainFrames();
        })
    </script>

    <script type="text/javascript">
        $(document).ready(function () {
        $(".topic-vote-up-18113").click(function () {
        $.post("/data/topic/vote", {topicId: 18113, _tta: Codeforces.tta(), topicRevisionId: 68924, vote: +1}, function(data) {
        Codeforces.showMessage(data);
        }, "json");
        return false;
        });
        $(".topic-vote-down-18113").click(function () {
        $.post("/data/topic/vote", {topicId: 18113, _tta: Codeforces.tta(), topicRevisionId: 68924, vote: -1}, function(data) {
        Codeforces.showMessage(data);
        adjustTopicComplainFrames();
        }, "json");
        return false;
        });
        });
    </script>
</div>
        </div>
    </div>
                </div>
        </div>
            <br style="clear: both;">
            <div id="footer">
                <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2024 Mike Mirzayanov</div>
                <div>The only programming contests Web 2.0 platform</div>
                    <div>Server time: Apr/20/2024 16:14:50<sup title="timezone offset" style="font-size:8px;">UTC+7</sup> (h2).</div>
                    <div>Desktop version, switch to <a rel="nofollow" class="switchToMobile" href="https://codeforces.com/blog/entry/18051?mobile=true">mobile version</a>.</div>
                <div class="smaller"><a href="https://codeforces.com/privacy">Privacy Policy</a></div>

                    <div style="margin-top: 25px;">
                        Supported by
                    </div>
                    <div style="margin-top: 8px; padding-bottom: 20px; position: relative; left: 10px;">
                        <a href="https://ton.org/"><img style="margin-right: 2em; width: 60px;" src="./Efficient and easy segment trees - Codeforces_files/ton-100x100.png" alt="TON" title="TON"></a>
                        <a href="http://ifmo.ru/en/"><img style="width: 120px;" src="./Efficient and easy segment trees - Codeforces_files/itmo_small_en-logo.png" alt="ИТМО" title="ИТМО"></a>
                    </div>
            </div>
        <script type="text/javascript">
            $(function() {
                $(".switchToMobile").click(function() {
                    Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", "true"));
                    return false;
                });
                $(".switchToDesktop").click(function() {
                    Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", "false"));
                    return false;
                });
            });
        </script>
    <script type="text/javascript">
        $(document).ready(function () {
            if ($(window).width() < 1600) {
                $('.button-up').css('width', '30px').css('line-height', '30px').css('font-size', '20px');
            }

            if ($(window).width() >= 1200) {
                $ (window).scroll (function () {
                    if ($ (this).scrollTop () > 100) {
                        $ ('.button-up').fadeIn();
                    } else {
                        $ ('.button-up').fadeOut();
                    }
                });

                $('.button-up').click(function () {
                    $('body,html').animate({
                        scrollTop: 0
                    }, 500);
                    return false;
                });

                $('.button-up').hover(function () {
                    $(this).animate({
                        'opacity':'1'
                    }).css({'background-color':'#e7ebf0','color':'#6a86a4'});
                }, function () {
                    $(this).animate({
                        'opacity':'0.7'
                    }).css({'background':'none','color':'#d3dbe4'});;
                });
            }
            Codeforces.focusOnError();
        });
    </script>
    <div class="userListsFacebox" style="display:none;">
        <div style="padding: 0.5em; width: 600px; max-height: 200px; overflow-y: auto">
<div class="datatable" style="background-color: #E1E1E1; padding-bottom: 3px;">
            <div class="lt">&nbsp;</div>
            <div class="rt">&nbsp;</div>
            <div class="lb">&nbsp;</div>
            <div class="rb">&nbsp;</div>

            <div style="padding: 4px 0 0 6px;font-size:1.4rem;position:relative;">
                User lists

                <div style="position:absolute;right:0.25em;top:0.35em;">
                    <span style="padding:0;position:relative;bottom:2px;" class="rowCount"></span>

                    <img class="closed" src="./Efficient and easy segment trees - Codeforces_files/control.png">

                    <span class="filter" style="display:none;">
                        <img class="opened" src="./Efficient and easy segment trees - Codeforces_files/control-270.png">
                        <input style="padding:0 0 0 20px;position:relative;bottom:2px;border:1px solid #aaa;height:17px;font-size:1.3rem;">
                    </span>
                </div>
            </div>
            <div style="background-color: white;margin:0.3em 3px 0 3px;position:relative;">
            <div class="ilt">&nbsp;</div>
            <div class="irt">&nbsp;</div>
            <table class="">
                <thead>
                <tr>
                    <th class="top left right">Name</th>
                </tr>
                </thead>
                <tbody>
                <tr class="no-items visible"><td style="text-align:left;" colspan="32" class="bottom dark left right">No items</td></tr></tbody>
            </table>
            </div>
        </div>
    <script type="text/javascript">
        $(document).ready(function () {
                // Create new ':containsIgnoreCase' selector for search
                jQuery.expr[':'].containsIgnoreCase = function(a, i, m) {
                    return jQuery(a).text().toUpperCase()
                            .indexOf(m[3].toUpperCase()) >= 0;
                };

                if (window.updateDatatableFilter == undefined) {
                    window.updateDatatableFilter = function(i) {
                        var parent = $(i).parent().parent().parent().parent();
                        $("tr.no-items", parent).remove();
                        $("tr", parent).hide().removeClass('visible');
                        var text = $(i).val();
                        if (text) {
                            $("tr" + ":containsIgnoreCase('" + text + "')", parent).show().addClass('visible');
                        } else {
                            parent.find(".rowCount").text("");
                            $("tr", parent).show().addClass('visible');
                        }

                        var found = false;
                        var visibleRowCount = 0;
                        $("tr", parent).each(function () {
                            if (!found) {
                                if ($(this).find("th").size() > 0) {
                                    $(this).show().addClass('visible');
                                    found = true;
                                }
                            }
                            if ($(this).hasClass('visible')) {
                                visibleRowCount++;
                            }
                        });
                        if (text) {
                            parent.find(".rowCount").text("Matches: " + (visibleRowCount - (found ? 1 : 0)));
                        }
                        if (visibleRowCount == (found ? 1 : 0)) {
                            $("<tr class='no-items visible'><td style=\"text-align:left;\"colspan=\"32\">No items<\/td><\/tr>").appendTo($(parent).find('table'));
                        }
                        $(parent).find("tr td").removeClass("dark");
                        $(parent).find("tr.visible:odd td").addClass("dark");
                    }

                    $(".datatable .closed").click(function () {
                        var parent = $(this).parent();
                        $(this).hide();
                        $(".filter", parent).fadeIn(function () {
                            $("input", parent).val("").focus().css("border", "1px solid #aaa");
                        });
                    });

                    $(".datatable .opened").click(function () {
                        var parent = $(this).parent().parent();
                        $(".filter", parent).fadeOut(function () {
                            $(".closed", parent).show();
                            $("input", parent).val("").each(function () {
                                window.updateDatatableFilter(this);
                            });
                        });
                    });

                    $(".datatable .filter input").keyup(function(e) {
                        window.updateDatatableFilter(this);
                        e.preventDefault();
                        e.stopPropagation();
                    });

                    $(".datatable table").each(function () {
                        var found = false;
                        $("tr", this).each(function () {
                            if (!found && $(this).find("th").size() == 0) {
                                found = true;
                            }
                        });
                        if (!found) {
                            $("<tr class='no-items visible'><td style=\"text-align:left;\"colspan=\"32\">No items<\/td><\/tr>").appendTo(this);
                        }
                    });

                    // Applies styles to datatables.
                    $(".datatable").each(function () {
                        $(this).find("tr:first th").addClass("top");
                        $(this).find("tr:last td").addClass("bottom");
                        $(this).find("tr:odd td").addClass("dark");
                        $(this).find("tr td:first-child, tr th:first-child").addClass("left");
                        $(this).find("tr td:last-child, tr th:last-child").addClass("right");
                    });

                    $(".datatable table.tablesorter").each(function () {
                        $(this).bind("sortEnd", function () {
                            $(".datatable").each(function () {
                                $(this).find("th, td")
                                    .removeClass("top").removeClass("bottom")
                                    .removeClass("left").removeClass("right")
                                    .removeClass("dark");
                                $(this).find("tr:first th").addClass("top");
                                $(this).find("tr:last td").addClass("bottom");
                                $(this).find("tr:odd td").addClass("dark");
                                $(this).find("tr td:first-child, tr th:first-child").addClass("left");
                                $(this).find("tr td:last-child, tr th:last-child").addClass("right");
                            });
                        });
                    });
                }
        });
    </script>
        </div>
    </div>
    <script type="application/javascript">
        $(function() {
            $(".userListMarker").click(function() {
                $.post("/data/lists", {action: "findTouched"}, function(json) {
                    Codeforces.facebox(".userListsFacebox");
                    var tbody = $("#facebox tbody");
                    tbody.empty();
                    for (var i in json) {
                        tbody.append(
                            $("<tr></tr>").append(
                                $("<td></td>").attr("data-readKey", json[i].readKey).text(json[i].name)
                            )
                        );
                    }
                    Codeforces.updateDatatables();
                    tbody.find("td").css("cursor", "pointer").click(function() {
                        document.location = Codeforces.updateUrlParameter(document.location.href, "list", $(this).attr("data-readKey"));
                    });
                }, "json");
            });
        });
    </script>
</div>
    <script type="application/javascript">
        if ('serviceWorker' in navigator && 'fetch' in window && 'caches' in window) {
            navigator.serviceWorker.register('/service-worker-68729.js')
                .then(function (registration) {
                    console.log('Service worker registered: ', registration);
                })
                .catch(function (error) {
                    console.log('Registration failed: ', error);
                });
        }
    </script>
<script defer="" src="./Efficient and easy segment trees - Codeforces_files/v55bfa2fee65d44688e90c00735ed189a1713218998793" integrity="sha512-FIKRFRxgD20moAo96hkZQy/5QojZDAbyx0mQ17jEGHCJc/vi0G2HXLtofwD7Q3NmivvP9at5EVgbRqOaOQb+Rg==" data-cf-beacon="{&quot;rayId&quot;:&quot;877406bffae584c3&quot;,&quot;version&quot;:&quot;2024.3.0&quot;,&quot;token&quot;:&quot;316c29dfa3804effb5a91c52a59b5bd0&quot;}" crossorigin="anonymous"></script>


<div id="datepick-div" style="display: none;"></div><div id="cboxOverlay" style="display: none;"></div><div id="colorbox" class="" style="display: none; padding-bottom: 42px; padding-right: 42px;"><div id="cboxWrapper"><div><div id="cboxTopLeft" style="float: left;"></div><div id="cboxTopCenter" style="float: left;"></div><div id="cboxTopRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxMiddleLeft" style="float: left;"></div><div id="cboxContent" style="float: left;"><div id="cboxLoadedContent" style="width: 0px; height: 0px; overflow: hidden; float: left;"></div><div id="cboxLoadingOverlay" style="float: left;"></div><div id="cboxLoadingGraphic" style="float: left;"></div><div id="cboxTitle" style="float: left;"></div><div id="cboxCurrent" style="float: left;"></div><div id="cboxNext" style="float: left;"></div><div id="cboxPrevious" style="float: left;"></div><div id="cboxSlideshow" style="float: left;"></div><div id="cboxClose" style="float: left;"></div></div><div id="cboxMiddleRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxBottomLeft" style="float: left;"></div><div id="cboxBottomCenter" style="float: left;"></div><div id="cboxBottomRight" style="float: left;"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none;"></div></div><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; min-width: 0px; max-width: none; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Main, monospace;"></div></div><div id="highlighter--hover-tools" style="display: none;">
    <div id="highlighter--hover-tools--container">
        <div class="highlighter--icon highlighter--icon-copy" title="Copy"></div>
        <div class="highlighter--icon highlighter--icon-change-color" title="Change Color"></div>
        <div class="highlighter--icon highlighter--icon-delete" title="Delete"></div>
    </div>
</div></body></html>